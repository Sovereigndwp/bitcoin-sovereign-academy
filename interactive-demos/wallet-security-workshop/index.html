<!DOCTYPE html><html lang="en"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bitcoin Wallet Security Workshop - Bitcoin Sovereign Academy</title>
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
    <link rel="stylesheet" href="/css/brand.css">
    <link rel="stylesheet" href="/css/status-indicators.css">
    <style>
        :root {
            --primary-orange: #f7931a;
            --primary-dark: #1a1a1a;
            --secondary-dark: #2d2d2d;
            --text-light: #e0e0e0;
            --text-dim: #999;
            --accent-green: #4caf50;
            --accent-red: #F44336;
            --accent-purple: #9C27B0;
            --border-color: rgba(247, 147, 26, 0.3);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: var(--text-light);
            line-height: 1.6;
            padding: 1.5rem;
            min-height: 100vh;
        }

        /* Multi-Level Support */
        body.level-beginner .intermediate-only,
        body.level-beginner .advanced-only { display: none; }
        body.level-intermediate .beginner-only,
        body.level-intermediate .advanced-only { display: none; }
        body.level-advanced .beginner-only,
        body.level-advanced .intermediate-only { display: none; }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 2rem;
            background: rgba(0, 0, 0, 0.3);
            padding: 2rem;
            border-radius: 15px;
            border: 2px solid var(--primary-orange);
        }

        .header h1 {
            color: var(--primary-orange);
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        .header p {
            color: var(--text-dim);
            font-size: 1.1rem;
        }

        .security-score {
            display: inline-block;
            background: rgba(247, 147, 26, 0.2);
            padding: 0.75rem 1.5rem;
            border-radius: 25px;
            margin-top: 1rem;
            font-weight: bold;
            border: 2px solid var(--primary-orange);
        }

        /* Level Switcher */
        .level-switcher {
            display: flex;
            gap: 0.75rem;
            justify-content: center;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .level-btn {
            padding: 0.75rem 1.5rem;
            background: rgba(247, 147, 26, 0.1);
            border: 2px solid var(--border-color);
            border-radius: 0.5rem;
            cursor: pointer;
            font-weight: 600;
            color: var(--text-light);
            transition: all 0.3s ease;
        }

        .level-btn.active {
            background: var(--primary-orange);
            color: #000;
            border-color: var(--primary-orange);
        }

        /* Tabs */
        .tabs {
            display: flex;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 0.5rem;
            margin-bottom: 2rem;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .tab {
            flex: 1;
            min-width: 150px;
            padding: 0.75rem;
            text-align: center;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
            background: rgba(255, 255, 255, 0.05);
        }

        .tab.active {
            background: var(--primary-orange);
            color: #000;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Two-column layout for better UX */
        .demo-grid {
            display: grid;
            grid-template-columns: 1.5fr 1fr;
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .card {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid var(--border-color);
            border-radius: 15px;
            padding: 1.5rem;
            transition: all 0.3s ease;
        }

        .card h2 {
            color: var(--primary-orange);
            font-size: 1.5rem;
            margin-bottom: 1rem;
            border-bottom: 2px solid var(--primary-orange);
            padding-bottom: 0.5rem;
        }

        .card h3 {
            color: var(--primary-orange);
            font-size: 1.2rem;
            margin: 1.5rem 0 0.75rem 0;
        }

        /* Sticky controls */
        .controls-panel {
            position: sticky;
            top: 1rem;
            background: rgba(0, 0, 0, 0.5);
            padding: 1.5rem;
            border-radius: 0.75rem;
            border: 2px solid var(--border-color);
        }

        .seed-display {
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid var(--primary-orange);
            border-radius: 10px;
            padding: 1.5rem;
            margin: 1rem 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            word-break: break-all;
            min-height: 100px;
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            transition: filter 0.3s ease;
        }

        .seed-display.blurred {
            filter: blur(10px);
            user-select: none;
            pointer-events: none;
        }

        .seed-word {
            display: inline-block;
            padding: 0.5rem 0.75rem;
            background: rgba(247, 147, 26, 0.2);
            border-radius: 5px;
            border: 1px solid var(--border-color);
        }

        .address-display {
            background: rgba(76, 175, 80, 0.1);
            border: 2px solid var(--accent-green);
            border-radius: 10px;
            padding: 1rem;
            margin: 1rem 0;
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
            word-break: break-all;
        }

        .qr-container {
            text-align: center;
            margin: 1.5rem 0;
            padding: 1.5rem;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            border: 2px solid var(--accent-green);
        }

        .qr-container h3 {
            margin-bottom: 1rem;
            color: var(--text-light);
        }

        .qr-code {
            margin: 0 auto;
            display: block;
            background: white;
            padding: 10px;
            border-radius: 8px;
        }

        .entropy-meter {
            width: 100%;
            height: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            overflow: hidden;
            margin: 1rem 0;
        }

        .entropy-fill {
            height: 100%;
            transition: all 0.5s ease;
            border-radius: 10px;
        }

        .input-group {
            margin: 1rem 0;
        }

        .input-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: bold;
            color: var(--text-light);
        }

        .input-group input,
        .input-group select {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            background: rgba(0, 0, 0, 0.3);
            color: var(--text-light);
            font-size: 1rem;
        }

        .input-group input:focus,
        .input-group select:focus {
            outline: none;
            border-color: var(--primary-orange);
        }

        .btn {
            background: var(--primary-orange);
            color: #000;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            font-size: 1rem;
            margin: 0.5rem 0.5rem 0.5rem 0;
            transition: all 0.3s ease;
            width: 100%;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(247, 147, 26, 0.4);
        }

        .btn-secondary {
            background: linear-gradient(45deg, #6c757d, #868e96);
            color: white;
        }

        .btn-danger {
            background: linear-gradient(45deg, #F44336, #ff6b6b);
            color: white;
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .security-level {
            display: inline-block;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9rem;
            margin: 0.5rem 0;
        }

        .level-green { background: rgba(76, 175, 80, 0.2); color: #ffffff; border: 2px solid #4CAF50; }
        .level-yellow { background: rgba(255, 193, 7, 0.2); color: #FFC107; border: 2px solid #FFC107; }
        .level-red { background: rgba(244, 67, 54, 0.2); color: #F44336; border: 2px solid #F44336; }

        .tip-box {
            background: rgba(33, 150, 243, 0.1);
            border-left: 4px solid #2196F3;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 0.5rem;
        }

        .backup-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 0.75rem;
            margin: 1rem 0;
        }

        .backup-word {
            padding: 0.75rem;
            text-align: center;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid transparent;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .backup-word:hover {
            border-color: var(--primary-orange);
        }

        .backup-word.selected {
            border-color: var(--accent-green);
            background: rgba(76, 175, 80, 0.2);
        }

        .derivation-path {
            font-family: 'Courier New', monospace;
            background: rgba(0, 0, 0, 0.3);
            padding: 0.75rem;
            border-radius: 8px;
            margin: 0.5rem 0;
            font-size: 0.9rem;
        }

        /* Security Dropdown Styles */
        .security-dropdown {
            border: 2px solid var(--border-color);
            border-radius: 10px;
            overflow: hidden;
            background: rgba(255, 255, 255, 0.03);
            transition: all 0.3s ease;
        }

        .security-dropdown:hover {
            border-color: var(--primary-orange);
        }

        .security-dropdown-header {
            width: 100%;
            padding: 1.25rem 1.5rem;
            background: rgba(0, 0, 0, 0.2);
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 1rem;
            text-align: left;
            transition: all 0.3s ease;
            color: var(--text-light);
            font-size: 1rem;
        }

        .security-dropdown-header:hover {
            background: rgba(247, 147, 26, 0.1);
        }

        .dropdown-icon {
            font-size: 0.9rem;
            transition: transform 0.3s ease;
            display: inline-block;
            min-width: 1rem;
        }

        .dropdown-icon.rotated {
            transform: rotate(90deg);
        }

        .security-dropdown-content {
            padding: 1.5rem;
            border-top: 1px solid var(--border-color);
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                max-height: 0;
            }
            to {
                opacity: 1;
                max-height: 1000px;
            }
        }

        /* ===== ACCESSIBILITY ENHANCEMENTS (WCAG 2.1 AA) ===== */

        /* Color Contrast - Change dim text from #999 to #b3b3b3 for 4.6:1 ratio */
        :root {
            --text-dim: #b3b3b3;
        }

        .header p, small, .node-value, .node-path {
            color: #b3b3b3;
        }

        /* Touch Targets - Minimum 44x44px */
        button, a, [role="button"], input[type="button"], input[type="submit"],
        .btn, .level-btn, .tab, .backup-word {
            min-height: 44px;
            min-width: 44px;
        }

        /* Focus Indicators */
        *:focus-visible {
            outline: 3px solid var(--primary-orange, #f7931a);
            outline-offset: 2px;
        }

        button:focus-visible, a:focus-visible, input:focus-visible, select:focus-visible,
        .tab:focus-visible, .backup-word:focus-visible {
            outline: 3px solid var(--primary-orange, #f7931a);
            outline-offset: 4px;
            box-shadow: 0 0 0 4px rgba(247, 147, 26, 0.2);
        }

        /* Reduced Motion */
        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }

        /* Mobile Reflow */
        @media (max-width: 360px) {
            body {
                overflow-x: hidden;
            }
        }

        @media (max-width: 968px) {
            .demo-grid {
                grid-template-columns: 1fr;
            }

            .controls-panel {
                position: static;
            }

            .backup-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 768px) {
            body {
                padding: 1rem;
            }

            .header h1 {
                font-size: 2rem;
            }

            .tabs {
                flex-direction: column;
            }

            .tab {
                min-width: 100%;
            }
        }

    /* ===== RECOVERY PLAN COMPONENTS ===== */
    .rp-section { margin-bottom: 0.75rem; }

    .rp-field { margin-bottom: 0.85rem; }
    .rp-field label {
        display: block; font-size: 0.78rem; font-weight: 700;
        color: var(--text-dim); text-transform: uppercase;
        letter-spacing: 0.06em; margin-bottom: 0.3rem;
    }
    .rp-field select,
    .rp-field input[type="text"],
    .rp-field input[type="date"] {
        width: 100%; padding: 0.6rem 0.85rem;
        border: 1.5px solid var(--border-color); border-radius: 8px;
        background: rgba(0,0,0,0.35); color: var(--text-light);
        font-size: 0.92rem; transition: border-color 0.2s;
    }
    .rp-field select:focus,
    .rp-field input:focus { outline: none; border-color: var(--primary-orange); }

    .rp-grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 0.85rem; }
    @media (max-width: 768px) { .rp-grid-2 { grid-template-columns: 1fr; } }

    .rp-check {
        display: flex; align-items: center; gap: 0.6rem;
        padding: 0.45rem 0; cursor: pointer; font-size: 0.92rem;
    }
    .rp-check input[type="checkbox"] {
        width: 17px; height: 17px;
        accent-color: var(--primary-orange); cursor: pointer; flex-shrink: 0;
    }

    .rp-entry {
        background: rgba(255,255,255,0.04);
        border: 1px solid var(--border-color);
        border-radius: 10px; padding: 1.25rem; margin-bottom: 0.85rem;
    }
    .rp-entry-head {
        display: flex; justify-content: space-between; align-items: center;
        margin-bottom: 1rem; padding-bottom: 0.6rem;
        border-bottom: 1px solid var(--border-color);
    }
    .rp-entry-title { font-weight: 700; color: var(--primary-orange); font-size: 0.9rem; }

    .btn-remove-entry {
        background: transparent; border: 1px solid rgba(244,67,54,0.5);
        color: #F44336; padding: 0.25rem 0.6rem; border-radius: 6px;
        cursor: pointer; font-size: 0.78rem;
        min-height: 30px; min-width: 30px; width: auto; transition: all 0.2s;
    }
    .btn-remove-entry:hover { background: rgba(244,67,54,0.15); }

    .btn-add-entry {
        width: 100%; padding: 0.7rem;
        background: rgba(247,147,26,0.08);
        border: 2px dashed rgba(247,147,26,0.4);
        border-radius: 8px; color: var(--primary-orange);
        font-weight: 600; font-size: 0.9rem; cursor: pointer;
        transition: all 0.2s; min-height: 44px;
    }
    .btn-add-entry:hover { border-color: var(--primary-orange); background: rgba(247,147,26,0.15); }

    .rp-conditional {
        display: none; margin-top: 0.7rem; padding: 0.85rem 1rem;
        background: rgba(247,147,26,0.06);
        border-left: 3px solid var(--primary-orange);
        border-radius: 0 8px 8px 0;
    }

    .rp-progress-wrap {
        display: flex; align-items: center; gap: 1rem;
        background: rgba(0,0,0,0.3); border: 1px solid var(--border-color);
        border-radius: 10px; padding: 0.9rem 1.5rem; margin-bottom: 1.5rem;
    }
    .rp-progress-bar-bg {
        flex: 1; height: 8px;
        background: rgba(255,255,255,0.1); border-radius: 4px; overflow: hidden;
    }
    .rp-progress-bar-fill {
        height: 100%;
        background: linear-gradient(90deg, var(--primary-orange), #ffb347);
        border-radius: 4px; transition: width 0.4s ease; width: 0%;
    }

    .heir-step { display: flex; gap: 1rem; margin-bottom: 1.25rem; align-items: flex-start; }
    .heir-num {
        width: 30px; height: 30px; background: var(--primary-orange);
        color: #000; font-weight: 900; font-size: 0.85rem; border-radius: 50%;
        display: flex; align-items: center; justify-content: center;
        flex-shrink: 0; margin-top: 4px;
    }
    .heir-body { flex: 1; }
    .heir-body > strong { display: block; margin-bottom: 0.5rem; }

    /* ===== CONFIG FILE BLOCKS ===== */
    .config-block {
        background: rgba(0,0,0,0.45);
        border: 1px solid rgba(247,147,26,0.2); border-radius: 8px;
        padding: 1rem 1.25rem; font-family: 'Courier New', monospace;
        font-size: 0.82rem; line-height: 1.8; margin: 0.75rem 0;
        overflow-x: auto; white-space: pre;
    }
    .cfg-c { color: #7ec8a0; }
    .cfg-k { color: #f7931a; }
    .cfg-v { color: #87ceeb; }
    .cfg-t { color: #c792ea; }
    </style>
    <link rel="stylesheet" href="/css/icons.css">
    <link rel="stylesheet" href="/css/interactive-demos.css">
<meta name="description" content="Master Bitcoin through interactive experiences, AI-powered learning, and real-world simulations. Your journey from monetary curiosity to financial sovereignty starts here."><link rel="canonical" href="https://bitcoinsovereign.academy/"><meta property="og:title" content="Bitcoin Sovereign Academy"><meta property="og:description" content="Master Bitcoin through interactive experiences, AI-powered learning, and real-world simulations. Your journey from monetary curiosity to financial sovereignty starts here."><meta property="og:image" content="https://bitcoinsovereign.academy/assets/og-image.jpg"><meta property="og:url" content="https://bitcoinsovereign.academy/"><meta property="og:type" content="website"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "EducationalOrganization",
  "name": "Bitcoin Sovereign Academy",
  "description": "Master Bitcoin through interactive experiences, AI-powered learning, and real-world simulations. Your journey from monetary curiosity to financial sovereignty starts here.",
  "url": "https://bitcoinsovereign.academy",
  "logo": "https://bitcoinsovereign.academy/assets/og-image.jpg",
  "sameAs": [
    "https://github.com/Sovereigndwp/bitcoin-sovereign-academy"
  ],
  "educationalLevel": "Beginner to Advanced",
  "teaches": [
    "Bitcoin Fundamentals",
    "Cryptocurrency Technology",
    "Financial Sovereignty",
    "Digital Asset Security"
  ],
  "audience": {
    "@type": "Audience",
    "audienceType": "Students interested in Bitcoin and cryptocurrency"
  }
}</script></head>
<body class="level-beginner">
    <a href="#main-content" class="skip-link">Skip to main content</a>
    <script src="/js/config.js"></script>
    <script src="/js/demo-lock-subdomain.js"></script>
    <script src="/js/subdomain-access-control.js"></script>

    <main id="main-content" class="container">
        <header class="header">
            <h1><span data-icon="lock"></span> Bitcoin Wallet Security Workshop</h1>
            <div class="tip-box" style="margin: 1rem auto 1.5rem; max-width: 800px; background: rgba(247, 147, 26, 0.1); border-left-color: var(--primary-orange);">
                <strong>üéØ Mission:</strong> This workshop teaches you how one Bitcoin wallet works and how to back it up correctly. Learn seed generation, backup verification, and address derivation‚Äîthe foundation of self-custody.
            </div>
            <p class="beginner-only">Learn how Bitcoin wallets work and practice security in a safe environment</p>
            <p class="intermediate-only">Master seed phrases, derivation paths, and wallet security best practices</p>
            <p class="advanced-only">Deep dive into BIP39, BIP32/44, cryptographic security, and advanced wallet features</p>
            <div class="security-score">
                Security Score: <span id="securityScore">0</span>/100
            </div>
        </header>

        <div class="level-switcher">
            <button class="level-btn active" onclick="switchLevel('beginner')">üå± Beginner</button>
            <button class="level-btn" onclick="switchLevel('intermediate')"><span data-icon="lightning"></span> Intermediate</button>
            <button class="level-btn" onclick="switchLevel('advanced')"><span data-icon="tool"></span> Advanced</button>
        </div>

        <div class="tabs">
            <div class="tab active" onclick="switchTab('generator')">Seed Generator</div>
            <div class="tab" onclick="switchTab('backup')">Backup Practice</div>
            <div class="tab" onclick="switchTab('addresses')">Address Explorer</div>
            <div class="tab beginner-only" onclick="switchTab('tips')">Security Tips</div>
            <div class="tab intermediate-only advanced-only" onclick="switchTab('advanced')">Advanced</div>
            <div class="tab" onclick="switchTab('recovery-plan')">üõ°Ô∏è Recovery Plan</div>
        </div>

        <!-- Generator Tab -->
        <div id="generator" class="tab-content active">
            <div class="demo-grid">
                <section class="card">
                    <h2>üé≤ Seed Phrase Generator</h2>
                    <div class="security-level level-green">üü¢ Educational Tool - Safe Environment</div>

                    <p class="beginner-only">A seed phrase is like a master password for your Bitcoin. It's a list of 12 or 24 random words that can recreate your entire wallet.</p>
                    <p class="intermediate-only">Your seed phrase uses BIP39 standard - a list of words from a 2048-word dictionary. Each word adds ~11 bits of entropy.</p>
                    <p class="advanced-only">BIP39 mnemonic sentences use SHA-512 PBKDF2 with 2048 iterations to derive the seed. Entropy: 128 bits (12 words) or 256 bits (24 words).</p>

                    <div class="entropy-meter">
                        <div id="entropyFill" class="entropy-fill" style="width: 0%; background: #F44336;"></div>
                    </div>
                    <small>Entropy Level: <span id="entropyText">No seed generated</span></small>

                    <div id="seedDisplay" class="seed-display">
                        Click "Generate New Seed Phrase" to create a truly random seed phrase
                    </div>

                    <div id="seedSecurity"></div>

                    <div class="beginner-only tip-box">
                        <strong><span data-icon="lightbulb"></span> Why Random Words?</strong><br>
                        Using random words makes it impossible for hackers to guess. Never use words you can think of yourself!
                    </div>

                    <div class="intermediate-only tip-box">
                        <strong>‚ö†Ô∏è Passphrase (25th Word):</strong><br>
                        Optional extra security layer. Even if someone finds your 24 words, they can't access funds without the passphrase.
                    </div>

                    <div class="advanced-only tip-box">
                        <strong>üî¨ Cryptographic Entropy:</strong><br>
                        Uses Web Crypto API (crypto.getRandomValues) for cryptographically secure randomness. Never use Math.random() for real wallets!
                    </div>
                </section>

                <section class="controls-panel">
                    <h3 style="color: var(--primary-orange); margin-top: 0;">‚öôÔ∏è Controls</h3>

                    <div class="input-group">
                        <label for="seedLength">Seed Phrase Length:</label>
                        <select id="seedLength">
                            <option value="12">12 words (Standard)</option>
                            <option value="24">24 words (Maximum Security)</option>
                        </select>
                    </div>

                    <div class="input-group intermediate-only advanced-only">
                        <label for="passphrase">Passphrase (Optional 25th Word):</label>
                        <input type="password" id="passphrase" placeholder="Leave empty for standard wallet">
                    </div>

                    <button class="btn" onclick="generateSecureSeed()">üé≤ Generate Secure Seed</button>
                    <button class="btn btn-danger beginner-only" onclick="generateWeakSeed()">‚ö†Ô∏è Generate Weak Seed (Demo)</button>

                    <div class="advanced-only">
                        <button class="btn btn-secondary" onclick="showEntropySource()"><span data-icon="chart"></span> Show Entropy Source</button>
                    </div>
                </section>
            </div>

            <div class="card beginner-only">
                <h2><span data-icon="shield"></span> Security Best Practices</h2>
                <ul style="line-height: 2;">
                    <li>‚úÖ <strong>Always write</strong> your seed phrase on paper</li>
                    <li>‚úÖ <strong>Never type</strong> it into a computer or phone</li>
                    <li>‚úÖ <strong>Never share</strong> it with anyone - not even "support"</li>
                    <li>‚úÖ <strong>Store it safely</strong> like cash or jewelry</li>
                    <li>‚ùå <strong>Never store</strong> it in cloud, email, or photos</li>
                </ul>
            </div>
        </div>

        <!-- Backup Practice Tab -->
        <div id="backup" class="tab-content">
            <div class="card">
                <h2>üìù Seed Phrase Backup Practice</h2>
                <div class="security-level level-yellow">üü° Practice proper backup procedures</div>

                <p class="beginner-only">The most important part of Bitcoin security is backing up your seed phrase correctly. Let's practice!</p>
                <p class="intermediate-only">Practice the backup verification process used by hardware wallets like Ledger and Trezor.</p>
                <p class="advanced-only">Simulate BIP39 backup verification with scrambled word selection. Tests memory and accuracy.</p>

                <div id="backupInstructions">
                    <p>First, generate a seed phrase in the Generator tab, then return here to practice backing it up.</p>
                    <button class="btn" onclick="startBackupPractice()" id="startBackupBtn" disabled="">Start Backup Practice</button>
                </div>

                <div id="backupPractice" style="display: none;">
                    <h3>Step 1: Review Your Seed Phrase</h3>
                    <p class="beginner-only">In real life, you would write these words on paper. Write them in order!</p>
                    <p class="intermediate-only">Write these on paper, metal backup, or hardware wallet recovery card.</p>
                    <div style="position: relative;">
                        <div id="seedForBackup" class="seed-display"></div>
                        <button class="btn btn-secondary" onclick="toggleBlur()" id="blurToggleBtn" style="margin-top: 0.5rem; font-size: 0.85rem;">
                            <span id="blurToggleIcon">üôà</span> <span id="blurToggleText">Hide Seed (Practice Mode)</span>
                        </button>
                    </div>

                    <h3>Step 2: Verify Your Backup</h3>
                    <p>Click the words in the correct order to verify your backup:</p>
                    <p class="beginner-only" style="font-size: 0.9rem; color: var(--text-dim); margin-top: -0.5rem;">üí° Tip: In real practice, hide the seed phrase above to truly test your backup!</p>
                    <div id="shuffledWords" class="backup-grid"></div>

                    <h3>Your Selection:</h3>
                    <div id="selectedWords" class="backup-grid"></div>

                    <button class="btn" onclick="checkBackup()" id="checkBackupBtn" disabled="">‚úÖ Check My Backup</button>
                    <button class="btn btn-secondary" onclick="resetBackup()"><span data-icon="refresh"></span> Reset</button>

                    <div id="backupResult" style="margin-top: 1.5rem;"></div>
                </div>
            </div>
        </div>

        <!-- Address Explorer Tab -->
        <div id="addresses" class="tab-content">
            <div class="demo-grid">
                <section class="card">
                    <h2>üîë Address Generator</h2>
                    <div class="security-level level-green">üü¢ Addresses are safe to share publicly</div>

                    <p class="beginner-only">Your seed phrase creates many different Bitcoin addresses. Each address can receive Bitcoin separately!</p>
                    <p class="intermediate-only">HD wallets use derivation paths to generate billions of addresses from one seed. Understanding paths is key to wallet recovery.</p>
                    <p class="advanced-only">BIP32 hierarchical deterministic key derivation. Path notation: m / purpose' / coin_type' / account' / change / address_index</p>

                    <div class="input-group">
                        <label for="addressType">Address Type:</label>
                        <select id="addressType">
                            <option value="legacy">Legacy (P2PKH) - 1...</option>
                            <option value="segwit">SegWit (P2SH-P2WPKH) - 3...</option>
                            <option value="native">Native SegWit (Bech32) - bc1...</option>
                        </select>
                    </div>

                    <div class="input-group intermediate-only advanced-only">
                        <label for="addressIndex">Address Index:</label>
                        <input type="number" id="addressIndex" min="0" max="20" value="0" placeholder="0">
                        <small>Generate different addresses from the same seed</small>
                    </div>

                    <button class="btn" onclick="generateAddress()" id="generateBtn" disabled="">Generate Address</button>
                    <button class="btn btn-secondary" onclick="generateMultipleAddresses()" id="multipleBtn" disabled="">Generate 5 Addresses</button>

                    <div id="addressDisplay" class="address-display" style="display: none;">
                        <strong>Bitcoin Address:</strong><br>
                        <span id="addressText"></span>
                        <div class="derivation-path">
                            Path: <span id="derivationPath"></span>
                        </div>
                    </div>

                    <div id="qrContainer" class="qr-container" style="display: none;">
                        <h3>QR Code</h3>
                        <canvas id="qrCode" class="qr-code"></canvas>
                        <p><small>Scan to share address</small></p>
                    </div>

                    <div id="multipleAddresses" style="display: none;">
                        <h3>Generated Addresses:</h3>
                        <div id="addressList"></div>
                    </div>
                </section>

                <section class="controls-panel">
                    <h3 style="color: var(--primary-orange); margin-top: 0;"><span data-icon="books"></span> Learn</h3>

                    <div class="beginner-only tip-box">
                        <strong>Address Types Explained:</strong><br><br>
                        <strong>Legacy (1...):</strong> Original format. Works everywhere but has higher fees.<br><br>
                        <strong>SegWit (3...):</strong> Lower fees, widely supported.<br><br>
                        <strong>Native SegWit (bc1...):</strong> Lowest fees, most efficient. Use this!
                    </div>

                    <div class="intermediate-only tip-box">
                        <strong>Why Multiple Addresses?</strong><br><br>
                        Privacy! Use a new address for each transaction. Reusing addresses links all your payments together.<br><br>
                        Your wallet automatically generates new addresses from the same seed.
                    </div>

                    <div class="advanced-only">
                        <div class="tip-box">
                            <strong>Derivation Path Standards:</strong><br><br>
                            <code>m/44'/0'/0'/0/0</code> - BIP44 Legacy<br>
                            <code>m/49'/0'/0'/0/0</code> - BIP49 SegWit<br>
                            <code>m/84'/0'/0'/0/0</code> - BIP84 Native SegWit<br><br>
                            The 0'/0'/0' means Bitcoin (0'), Account 0 (0'), External chain (0')
                        </div>

                        <div class="input-group">
                            <label for="customPath">Custom Derivation Path:</label>
                            <input type="text" id="customPath" value="m/84'/0'/0'/0/0" placeholder="m/44'/0'/0'/0/0">
                        </div>
                        <button class="btn btn-secondary" onclick="useCustomPath()">Use Custom Path</button>
                    </div>
                </section>
            </div>
        </div>

        <!-- Security Tips Tab -->
        <div id="tips" class="tab-content">
            <div class="card">
                <h2><span data-icon="shield"></span> Wallet Security Essentials</h2>
                <p style="margin-bottom: 1.5rem; color: var(--text-dim);">Core security practices specific to seed phrases, backups, and wallet recovery. For broader security topics like device hardening and attack defense, visit the <a href="/interactive-demos/security-dojo-enhanced/" style="color: var(--primary-orange); font-weight: 600;">Security Dojo</a>.</p>

                <!-- Essentials Section -->
                <div class="security-dropdown">
                    <button class="security-dropdown-header" onclick="toggleSecurityDropdown('essentials')">
                        <span class="dropdown-icon" id="essentials-icon">‚ñ∂</span>
                        <span class="security-level level-green" style="margin: 0;">üü¢ Essential Security Practices</span>
                    </button>
                    <div class="security-dropdown-content" id="essentials-content" style="display: none;">
                        <ul style="line-height: 2; margin: 1rem 0 1rem 1.5rem;">
                            <li>‚úÖ <strong>Store seed phrases offline</strong> on paper or metal backups</li>
                            <li>‚úÖ <strong>Never share your seed phrase</strong> with anyone‚Äînot even "support"</li>
                            <li>‚úÖ <strong>Use hardware wallets</strong> for amounts you can't afford to lose</li>
                            <li>‚úÖ <strong>Verify addresses</strong> character-by-character before sending funds</li>
                            <li>‚úÖ <strong>Test backups with small amounts</strong> first before large transfers</li>
                            <li>‚úÖ <strong>Use strong, unique passwords</strong> for exchange accounts</li>
                            <li>‚úÖ <strong>Enable 2FA everywhere</strong> (preferably hardware key or authenticator app)</li>
                        </ul>
                        <div class="tip-box">
                            <strong><span data-icon="lightbulb"></span> Golden Rule:</strong><br><br>
                            "Get your Bitcoin off exchanges" - If someone else holds your seed phrase, they control your Bitcoin. Always maintain personal custody.
                        </div>
                    </div>
                </div>

                <!-- Never Do Section -->
                <div class="security-dropdown" style="margin-top: 1rem;">
                    <button class="security-dropdown-header" onclick="toggleSecurityDropdown('never')">
                        <span class="dropdown-icon" id="never-icon">‚ñ∂</span>
                        <span class="security-level level-red" style="margin: 0;">üî¥ Never Do These Things</span>
                    </button>
                    <div class="security-dropdown-content" id="never-content" style="display: none;">
                        <ul style="line-height: 2; margin: 1rem 0 1rem 1.5rem;">
                            <li>‚ùå <strong>Never store seeds digitally</strong> - no cloud, email, photos, or text files</li>
                            <li>‚ùå <strong>Never use predictable words</strong> - seeds must be truly random</li>
                            <li>‚ùå <strong>Never share private keys or seeds</strong> - even with family (use multisig instead)</li>
                            <li>‚ùå <strong>Never use untrusted wallet software</strong> - stick to well-known, audited wallets</li>
                            <li>‚ùå <strong>Never enter seeds on websites</strong> - legitimate services never ask for your seed</li>
                            <li>‚ùå <strong>Never screenshot seed phrases</strong> - images sync to cloud storage</li>
                            <li>‚ùå <strong>Never use public WiFi</strong> for Bitcoin transactions without VPN</li>
                        </ul>
                        <div class="tip-box" style="background: rgba(244, 67, 54, 0.1); border-left-color: var(--accent-red);">
                            <strong>‚ö†Ô∏è Warning:</strong> Breaking any of these rules can lead to complete loss of funds. There's no "undo" button with Bitcoin.
                        </div>
                    </div>
                </div>

                <!-- Next Steps Section -->
                <div class="tip-box" style="margin-top: 2rem; background: rgba(33, 150, 243, 0.1); border-left-color: #2196F3;">
                    <strong>üéØ Ready for More?</strong><br><br>
                    Now that you understand wallet basics, head to the <a href="/interactive-demos/security-dojo-enhanced/" style="color: #2196F3; font-weight: 600;">Security Training Lab</a> to:
                    <ul style="margin: 0.5rem 0 0 1.5rem; line-height: 1.8;">
                        <li>Practice defending against real phishing attacks</li>
                        <li>Run backup & recovery drills</li>
                        <li>Explore hardware wallets and inheritance planning</li>
                        <li>Earn belts as you complete training stations</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Advanced Tab -->
        <div id="advanced" class="tab-content">
            <div class="card">
                <h2>üî¨ Advanced Features</h2>

                <h3 class="intermediate-only">Understanding Entropy</h3>
                <div class="intermediate-only">
                    <p>Entropy measures randomness. Higher entropy = better security.</p>
                    <ul style="margin: 1rem 0; line-height: 1.8;">
                        <li><strong>12 words:</strong> 128 bits of entropy (2<sup>128</sup> combinations)</li>
                        <li><strong>24 words:</strong> 256 bits of entropy (2<sup>256</sup> combinations)</li>
                    </ul>
                    <p>To crack a 12-word seed by brute force would take billions of years with current technology.</p>

                    <div class="tip-box" style="margin-top:1.25rem;">
                        <strong>üîë The Passphrase (25th Word) ‚Äî What it actually does</strong><br><br>
                        A BIP39 passphrase is not just extra security ‚Äî it creates an <em>entirely different wallet</em>. The same seed phrase with two different passphrases produces two completely different sets of addresses with separate balances.<br><br>
                        <strong>Practical uses:</strong>
                        <ul style="margin:0.5rem 0 0 1.5rem; line-height:1.8;">
                            <li><strong>Plausible deniability:</strong> Keep a small "decoy" balance on the seed alone. Hide the real funds behind the passphrase wallet.</li>
                            <li><strong>Extra theft protection:</strong> Even if someone finds your seed backup, they can't access funds without also knowing the passphrase.</li>
                            <li><strong>Recovery risk:</strong> Lose the passphrase = lose those funds permanently. Store it separately from the seed, never together.</li>
                        </ul>
                    </div>

                    <div class="tip-box" style="margin-top:1rem; background:rgba(255,152,0,0.1); border-left-color:#ff9800;">
                        <strong>‚ö†Ô∏è UTXO Hygiene ‚Äî Why it matters for privacy</strong><br><br>
                        A UTXO (Unspent Transaction Output) is like a bill in your wallet. When you spend, your wallet combines UTXOs to meet the amount ‚Äî and this can link addresses together on the public blockchain.<br><br>
                        <strong>Coin control</strong> lets you choose which UTXOs to spend, preventing unintended address linking. Available in Sparrow, Electrum, and advanced mobile wallets.<br><br>
                        <em>Example:</em> If you received Bitcoin from an exchange and from a private sale, spending both together reveals to chain analysis that the same person controls both addresses.
                    </div>
                </div>

                <h3 class="advanced-only">BIP39 Technical Details</h3>
                <div class="advanced-only">
                    <p><strong>Specification:</strong> Bitcoin Improvement Proposal 39</p>
                    <ul style="margin: 1rem 0; line-height: 1.8;">
                        <li>Wordlist: 2048 words (2<sup>11</sup>)</li>
                        <li>12 words = 128 bits entropy + 4 bits checksum = 132 bits</li>
                        <li>24 words = 256 bits entropy + 8 bits checksum = 264 bits</li>
                        <li>Derivation: PBKDF2-HMAC-SHA512, 2048 iterations</li>
                        <li>Passphrase: Optional salt for seed derivation</li>
                    </ul>

                    <div class="tip-box" style="margin: 1rem 0;">
                        <strong>Security Analysis:</strong><br><br>
                        A 256-bit seed has 2<sup>256</sup> possible combinations. This number is approximately 10<sup>77</sup> - more than the estimated number of atoms in the observable universe (10<sup>80</sup>).<br><br>
                        Even with quantum computers, brute-forcing a properly generated BIP39 seed is computationally infeasible.
                    </div>
                </div>

                <!-- Derivation Paths Deep Dive -->
                <h3>üóÇÔ∏è Understanding Derivation Paths</h3>
                <p style="margin-bottom: 1rem;">Derivation paths are not advanced Bitcoin trivia‚Äîthey are the <strong>index system of your money</strong>. Understanding them prevents recovery panic.</p>

                <div class="security-dropdown" style="margin-bottom: 1rem;">
                    <button class="security-dropdown-header" onclick="toggleSecurityDropdown('path-evolution')">
                        <span class="dropdown-icon" id="path-evolution-icon">‚ñ∂</span>
                        <strong>Why Different Wallets Use Different Paths</strong>
                    </button>
                    <div class="security-dropdown-content" id="path-evolution-content" style="display: none;">
                        <p>Early Bitcoin wallets had no standard. Then standards appeared over time, each solving a problem. Think of it as <strong>versions</strong>, not competition.</p>
                        
                        <div style="margin: 1.5rem 0;">
                            <div style="padding: 1rem; background: rgba(255,255,255,0.05); border-radius: 0.5rem; margin-bottom: 0.75rem; border-left: 3px solid #9e9e9e;">
                                <strong>Legacy (m/44')</strong> ‚Äî Addresses start with <code>1</code><br>
                                <span style="color: var(--text-dim);">Oldest style. Works everywhere but higher fees, less efficient.</span>
                            </div>
                            <div style="padding: 1rem; background: rgba(255,255,255,0.05); border-radius: 0.5rem; margin-bottom: 0.75rem; border-left: 3px solid #2196F3;">
                                <strong>SegWit Wrapped (m/49')</strong> ‚Äî Addresses start with <code>3</code><br>
                                <span style="color: var(--text-dim);">Transition step. Better fees, backward compatible.</span>
                            </div>
                            <div style="padding: 1rem; background: rgba(255,255,255,0.05); border-radius: 0.5rem; margin-bottom: 0.75rem; border-left: 3px solid var(--accent-green);">
                                <strong>Native SegWit (m/84')</strong> ‚Äî Addresses start with <code>bc1q</code><br>
                                <span style="color: var(--text-dim);">Lower fees, cleaner design. Today's most common default.</span>
                            </div>
                            <div style="padding: 1rem; background: rgba(255,255,255,0.05); border-radius: 0.5rem; border-left: 3px solid var(--primary-orange);">
                                <strong>Taproot (m/86')</strong> ‚Äî Addresses start with <code>bc1p</code><br>
                                <span style="color: var(--text-dim);">More privacy and flexibility. Still newer, not all tools support it fully.</span>
                            </div>
                        </div>
                        
                        <p style="font-style: italic; color: var(--text-dim);">Wallets did not "change their minds"‚Äîthey adopted new standards as Bitcoin evolved. That's why an older wallet, a newer wallet, and a multisig coordinator may all use different paths by default.</p>
                    </div>
                </div>

                <div class="security-dropdown" style="margin-bottom: 1rem;">
                    <button class="security-dropdown-header" onclick="toggleSecurityDropdown('path-recovery')">
                        <span class="dropdown-icon" id="path-recovery-icon">‚ñ∂</span>
                        <strong>What Actually Happens During Recovery</strong>
                    </button>
                    <div class="security-dropdown-content" id="path-recovery-content" style="display: none;">
                        <p>This is where most recovery panic comes from.</p>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin: 1.5rem 0;">
                            <div style="padding: 1rem; background: rgba(244, 67, 54, 0.1); border-radius: 0.5rem; border: 1px solid var(--accent-red);">
                                <strong style="color: var(--accent-red);">‚ùå What Users Expect</strong>
                                <p style="margin-top: 0.5rem;">"I entered my seed phrase. My balance should appear."</p>
                            </div>
                            <div style="padding: 1rem; background: rgba(76, 175, 80, 0.1); border-radius: 0.5rem; border: 1px solid var(--accent-green);">
                                <strong style="color: var(--accent-green);">‚úÖ What Actually Happens</strong>
                                <p style="margin-top: 0.5rem;">The wallet assumes a default path, scans addresses along it, stops when it sees no history.</p>
                            </div>
                        </div>
                        
                        <div class="tip-box" style="background: rgba(255, 152, 0, 0.1); border-left-color: #ff9800;">
                            <strong>‚ö†Ô∏è If your Bitcoin was created on a different path, the wallet sees nothing.</strong><br><br>
                            This does NOT mean:
                            <ul style="margin: 0.5rem 0 0 1.5rem;">
                                <li>Seed is wrong</li>
                                <li>Bitcoin is lost</li>
                                <li>Wallet failed</li>
                            </ul>
                            <p style="margin-top: 1rem;">It only means: <strong>The wallet is searching the wrong filing cabinet.</strong></p>
                        </div>
                        
                        <p style="margin-top: 1rem;">Tools like Sparrow or Electrum allow you to try different paths, manually specify one, or scan multiple address types. They assume you may not know which wallet originally created the addresses.</p>
                    </div>
                </div>

                <div class="security-dropdown" style="margin-bottom: 1rem;">
                    <button class="security-dropdown-header" onclick="toggleSecurityDropdown('path-multisig')">
                        <span class="dropdown-icon" id="path-multisig-icon">‚ñ∂</span>
                        <strong>Why Multisig Is Stricter About Paths</strong>
                    </button>
                    <div class="security-dropdown-content" id="path-multisig-content" style="display: none;">
                        <p>Multisig wallets are shared agreements. Everyone must agree on: keys, script type, address format, <strong>and derivation paths</strong>.</p>
                        
                        <p style="margin: 1rem 0;">If even one signer uses a different path or address type, the wallets no longer recognize the same coins.</p>
                        
                        <div class="tip-box">
                            <strong>üîê Simple Analogy</strong><br><br>
                            Imagine three people sharing a safe. They agree on:
                            <ul style="margin: 0.5rem 0 0.5rem 1.5rem;">
                                <li>Which building</li>
                                <li>Which floor</li>
                                <li>Which room</li>
                                <li>Which safe number</li>
                            </ul>
                            <p style="margin-top: 0.75rem;">If one person uses a different floor, they are opening a <strong>different safe</strong>.<br>
                            Same key material. Different location.</p>
                        </div>
                        
                        <p style="margin-top: 1rem;">That's why multisig setups always document: script type, derivation paths, and policy rules. This is not paranoia‚Äîit's coordination.</p>
                    </div>
                </div>

                <div class="security-dropdown" style="margin-bottom: 1rem;">
                    <button class="security-dropdown-header" onclick="toggleSecurityDropdown('path-addresses')">
                        <span class="dropdown-icon" id="path-addresses-icon">‚ñ∂</span>
                        <strong>Why Wallets Keep Generating New Addresses</strong>
                    </button>
                    <div class="security-dropdown-content" id="path-addresses-content" style="display: none;">
                        <p>You may notice paths end with a number like <code>/5</code> or <code>/27</code>. Wallets do this automatically.</p>
                        
                        <p style="margin: 1rem 0;">Every time you receive Bitcoin:</p>
                        <ul style="margin-left: 1.5rem; line-height: 1.8;">
                            <li>Wallet uses the next unused address</li>
                            <li>Privacy improves (payments aren't linked)</li>
                            <li>Address reuse is avoided</li>
                        </ul>
                        
                        <p style="margin: 1rem 0;">During recovery, wallets scan: Address 0, Address 1, Address 2... until they see no history.</p>
                        
                        <div class="tip-box" style="background: rgba(255, 152, 0, 0.1); border-left-color: #ff9800;">
                            <strong>‚ö†Ô∏è If the wallet stops scanning too early, funds may appear missing.</strong><br>
                            Good wallets scan far enough. Advanced wallets let you adjust the "gap limit."
                        </div>
                    </div>
                </div>

                <div class="security-dropdown" style="margin-bottom: 1rem;">
                    <button class="security-dropdown-header" onclick="toggleSecurityDropdown('path-document')">
                        <span class="dropdown-icon" id="path-document-icon">‚ñ∂</span>
                        <strong>How to Document Derivation Paths Safely</strong>
                    </button>
                    <div class="security-dropdown-content" id="path-document-content" style="display: none;">
                        <p>This matters more than people think.</p>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin: 1.5rem 0;">
                            <div style="padding: 1rem; background: rgba(76, 175, 80, 0.1); border-radius: 0.5rem; border: 1px solid var(--accent-green);">
                                <strong style="color: var(--accent-green);">‚úÖ Safe to Store</strong>
                                <ul style="margin: 0.5rem 0 0 1rem; line-height: 1.8;">
                                    <li>Derivation path</li>
                                    <li>Address type</li>
                                    <li>Wallet software used</li>
                                    <li>Multisig policy details</li>
                                </ul>
                                <p style="margin-top: 0.5rem; font-size: 0.9rem; color: var(--text-dim);">These do NOT give access to your Bitcoin.</p>
                            </div>
                            <div style="padding: 1rem; background: rgba(244, 67, 54, 0.1); border-radius: 0.5rem; border: 1px solid var(--accent-red);">
                                <strong style="color: var(--accent-red);">‚ùå Must Stay Secret</strong>
                                <ul style="margin: 0.5rem 0 0 1rem; line-height: 1.8;">
                                    <li>Seed phrase</li>
                                    <li>Private keys</li>
                                    <li>Recovery shares</li>
                                </ul>
                            </div>
                        </div>
                        
                        <div class="tip-box">
                            <strong>üìù Example Documentation</strong>
                            <pre style="margin-top: 0.75rem; padding: 1rem; background: rgba(0,0,0,0.3); border-radius: 0.5rem; font-size: 0.9rem; line-height: 1.6;">Wallet created with Native SegWit
Path: m/84'/0'/0'
Used with Sparrow
Multisig: 2-of-3</pre>
                            <p style="margin-top: 0.75rem; font-style: italic; color: var(--text-dim);">This note helps future-you recover calmly instead of guessing under stress.</p>
                        </div>
                    </div>
                </div>

                <div class="tip-box" style="margin: 1.5rem 0; background: rgba(156, 39, 176, 0.1); border-left-color: #9C27B0;">
                    <strong>üí° The Biggest Misconception</strong><br><br>
                    People think: <em>"My seed phrase is my wallet."</em><br><br>
                    Reality: <strong>Your wallet is seed phrase + derivation path + script rules.</strong>
                    <ul style="margin: 1rem 0 0 1.5rem; line-height: 1.8;">
                        <li>Lose the seed ‚Üí funds are <strong>gone forever</strong></li>
                        <li>Lose the path ‚Üí funds are <strong>hidden but recoverable</strong></li>
                    </ul>
                    <p style="margin-top: 1rem;">Only one is irreversible. Bitcoin does not forget‚Äîwallets just need to know where to look.</p>
                </div>

                <!-- Configuration Files Deep Dive -->
                <h3>üìÑ Configuration Files &amp; Wallet Backups</h3>
                <p style="margin-bottom:1rem;">Beyond the seed phrase, wallets produce several configuration files that are critical for recovery ‚Äî especially for multisig. Knowing what they are and where to store them is as important as knowing your derivation path.</p>

                <div class="security-dropdown" style="margin-bottom:1rem;">
                    <button class="security-dropdown-header" onclick="toggleSecurityDropdown('cfg-descriptor')">
                        <span class="dropdown-icon" id="cfg-descriptor-icon">‚ñ∂</span>
                        <strong>Output Descriptors ‚Äî The Most Important Config</strong>
                    </button>
                    <div class="security-dropdown-content" id="cfg-descriptor-content" style="display:none;">
                        <p>An <strong>output descriptor</strong> is a compact string that completely describes your wallet: script type, derivation path, and public key fingerprint. For multisig, it includes all co-signers' keys. Without it, recovering a multisig wallet from seeds alone is extremely difficult.</p>

                        <p style="margin:1rem 0 0.5rem;"><strong>Single-signature native SegWit:</strong></p>
                        <div class="config-block"><span class="cfg-c"># Wallet descriptor ‚Äî safe to store, does NOT expose funds</span>
<span class="cfg-k">wpkh</span>([<span class="cfg-v">a1b2c3d4</span>/84h/0h/0h]<span class="cfg-v">xpub6C...abc</span>/0/*)</div>
                        <p style="font-size:0.88rem; color:var(--text-dim);">Components: <code>wpkh</code> = script type ¬∑ <code>a1b2c3d4</code> = master key fingerprint ¬∑ <code>/84h/0h/0h</code> = derivation path ¬∑ <code>xpub...</code> = extended public key</p>

                        <p style="margin:1.25rem 0 0.5rem;"><strong>2-of-3 multisig (native SegWit):</strong></p>
                        <div class="config-block"><span class="cfg-k">wsh</span>(<span class="cfg-k">multi</span>(2,
  [<span class="cfg-v">a1b2c3d4</span>/48h/0h/0h/2h]<span class="cfg-v">xpub6A...111</span>/0/*,
  [<span class="cfg-v">b5c6d7e8</span>/48h/0h/0h/2h]<span class="cfg-v">xpub6B...222</span>/0/*,
  [<span class="cfg-v">f9a0b1c2</span>/48h/0h/0h/2h]<span class="cfg-v">xpub6C...333</span>/0/*
))</div>
                        <p style="font-size:0.88rem; color:var(--text-dim);">All three co-signer public keys must be present. Losing this descriptor means you cannot reconstruct the wallet addresses even if you have all three seeds.</p>

                        <div class="tip-box" style="margin-top:1rem;">
                            <strong>üîë Rule of thumb:</strong> Store the descriptor in at least two separate locations. It is safe to store digitally (it reveals no private keys) but must be kept alongside your recovery instructions.
                        </div>
                    </div>
                </div>

                <div class="security-dropdown" style="margin-bottom:1rem;">
                    <button class="security-dropdown-header" onclick="toggleSecurityDropdown('cfg-sparrow')">
                        <span class="dropdown-icon" id="cfg-sparrow-icon">‚ñ∂</span>
                        <strong>Sparrow Wallet Files ‚Äî What to Back Up</strong>
                    </button>
                    <div class="security-dropdown-content" id="cfg-sparrow-content" style="display:none;">
                        <p>Sparrow saves a <code>.json</code> wallet file that contains the descriptor, address labels, and transaction history ‚Äî but <strong>never your seed phrase or private keys</strong>.</p>
                        <div class="config-block"><span class="cfg-c"># Sparrow wallet file structure (simplified)</span>
{
  <span class="cfg-k">"name"</span>: <span class="cfg-v">"My Cold Storage"</span>,
  <span class="cfg-k">"network"</span>: <span class="cfg-v">"MAINNET"</span>,
  <span class="cfg-k">"policy"</span>: <span class="cfg-v">"2 of 3"</span>,
  <span class="cfg-k">"scriptType"</span>: <span class="cfg-v">"P2WSH"</span>,
  <span class="cfg-k">"accounts"</span>: [{
    <span class="cfg-k">"derivationPath"</span>: <span class="cfg-v">"m/48'/0'/0'/2'"</span>,
    <span class="cfg-k">"extendedPublicKey"</span>: <span class="cfg-v">"xpub6C..."</span>
  }],
  <span class="cfg-k">"labels"</span>: { <span class="cfg-v">"bc1q..."</span>: <span class="cfg-v">"Hardware wallet deposit"</span> }
}</div>
                        <p style="font-size:0.88rem; color:var(--text-dim);">Back up this file to an encrypted USB drive and a printed copy. Without it you can still recover funds from seeds + descriptor, but you lose address labels and history.</p>
                    </div>
                </div>

                <div class="security-dropdown" style="margin-bottom:1rem;">
                    <button class="security-dropdown-header" onclick="toggleSecurityDropdown('cfg-xpub')">
                        <span class="dropdown-icon" id="cfg-xpub-icon">‚ñ∂</span>
                        <strong>xpub / ypub / zpub ‚Äî What the Prefix Means</strong>
                    </button>
                    <div class="security-dropdown-content" id="cfg-xpub-content" style="display:none;">
                        <p>Extended public keys (xpubs) contain the same underlying key data. The prefix only signals the <em>intended script type</em> to wallet software. This causes frequent confusion during recovery.</p>
                        <div style="display:grid; grid-template-columns:repeat(auto-fit,minmax(200px,1fr)); gap:0.75rem; margin:1.25rem 0;">
                            <div style="padding:0.85rem 1rem; background:rgba(255,255,255,0.05); border-radius:8px; border-left:3px solid #9e9e9e;">
                                <code style="font-size:0.9rem;">xpub...</code><br>
                                <span style="font-size:0.82rem; color:var(--text-dim);">BIP44 Legacy ¬∑ m/44' ¬∑ addresses start with <strong>1</strong></span>
                            </div>
                            <div style="padding:0.85rem 1rem; background:rgba(255,255,255,0.05); border-radius:8px; border-left:3px solid #2196F3;">
                                <code style="font-size:0.9rem;">ypub...</code><br>
                                <span style="font-size:0.82rem; color:var(--text-dim);">BIP49 SegWit wrapped ¬∑ m/49' ¬∑ addresses start with <strong>3</strong></span>
                            </div>
                            <div style="padding:0.85rem 1rem; background:rgba(255,255,255,0.05); border-radius:8px; border-left:3px solid var(--accent-green);">
                                <code style="font-size:0.9rem;">zpub...</code><br>
                                <span style="font-size:0.82rem; color:var(--text-dim);">BIP84 Native SegWit ¬∑ m/84' ¬∑ addresses start with <strong>bc1q</strong></span>
                            </div>
                            <div style="padding:0.85rem 1rem; background:rgba(255,255,255,0.05); border-radius:8px; border-left:3px solid var(--primary-orange);">
                                <code style="font-size:0.9rem;">Zpub...</code><br>
                                <span style="font-size:0.82rem; color:var(--text-dim);">Multisig native SegWit ¬∑ m/48'/‚Ä¶/2' ¬∑ addresses start with <strong>bc1q</strong></span>
                            </div>
                        </div>
                        <div class="tip-box" style="background:rgba(255,152,0,0.1); border-left-color:#ff9800;">
                            <strong>‚ö†Ô∏è Wallet software may reject an xpub expecting a zpub.</strong> Tools like Sparrow let you convert between formats. If recovery fails with "unrecognized key format," this is usually the cause ‚Äî the key is fine, the prefix needs changing.
                        </div>
                    </div>
                </div>

                <div class="security-dropdown" style="margin-bottom:1.5rem;">
                    <button class="security-dropdown-header" onclick="toggleSecurityDropdown('cfg-node')">
                        <span class="dropdown-icon" id="cfg-node-icon">‚ñ∂</span>
                        <strong>bitcoin.conf ‚Äî Running Your Own Node</strong>
                        <span class="advanced-only" style="margin-left:auto; font-size:0.75rem; background:rgba(156,39,176,0.2); color:#9C27B0; padding:0.2rem 0.5rem; border-radius:10px; border:1px solid #9C27B0; font-weight:600;">Advanced</span>
                    </button>
                    <div class="security-dropdown-content" id="cfg-node-content" style="display:none;">
                        <p>Running Bitcoin Core gives you full sovereignty: you verify every transaction yourself instead of trusting someone else's server. The <code>bitcoin.conf</code> file controls how your node behaves.</p>
                        <div class="config-block"><span class="cfg-c"># bitcoin.conf ‚Äî stored in your Bitcoin data directory</span>
<span class="cfg-c"># Location: ~/.bitcoin/bitcoin.conf  (Linux/Mac)</span>
<span class="cfg-c">#           %APPDATA%\Bitcoin\bitcoin.conf  (Windows)</span>

<span class="cfg-k">txindex</span>=<span class="cfg-v">1</span>          <span class="cfg-c"># Index all transactions (needed by Electrum, Sparrow)</span>
<span class="cfg-k">server</span>=<span class="cfg-v">1</span>           <span class="cfg-c"># Enable RPC server so wallets can connect</span>
<span class="cfg-k">rpcbind</span>=<span class="cfg-v">127.0.0.1</span> <span class="cfg-c"># Only listen on localhost (never expose to internet)</span>
<span class="cfg-k">rpcuser</span>=<span class="cfg-v">youruser</span>  <span class="cfg-c"># Set a unique RPC username</span>
<span class="cfg-k">rpcpassword</span>=<span class="cfg-v">...</span>   <span class="cfg-c"># Strong random password ‚Äî keep this secret</span>

<span class="cfg-c"># Optional: prune to save disk space (cannot use txindex with prune)</span>
<span class="cfg-c"># prune=550</span>

<span class="cfg-k">maxconnections</span>=<span class="cfg-v">16</span> <span class="cfg-c"># Limit peer connections to reduce bandwidth</span></div>
                        <p style="font-size:0.88rem; color:var(--text-dim);">After changing <code>bitcoin.conf</code>, restart Bitcoin Core. Connect Sparrow or Electrum Personal Server to your node via the RPC address and credentials above.</p>
                    </div>
                </div>

                <h3><span data-icon="lock"></span> Test Your Understanding</h3>
                <div class="tip-box">
                    <p><strong>Question:</strong> Why must seed phrases be truly random?</p>
                    <button class="btn btn-secondary" onclick="alert('Answer: If seed phrases aren\'t truly random, attackers can predict them. Using predictable words (like \'password\', \'bitcoin\', etc.) or words from books dramatically reduces the search space from billions of years to minutes or hours. True randomness ensures the full 2^128 or 2^256 security guarantee.')">Show Answer</button>
                </div>
            </div>
        </div>

        <!-- ============================
             RECOVERY PLAN TAB
        ============================= -->
        <div id="recovery-plan" class="tab-content">
            <div class="card">
                <h2>üõ°Ô∏è Recovery &amp; Inheritance Plan</h2>
                <p style="color: var(--text-dim); margin-bottom: 1.5rem; line-height: 1.7;">Map every wallet, exchange, and key location so you ‚Äî or a trusted person ‚Äî can recover your Bitcoin under any circumstances. Fill in locations only. Never record seed words or private keys in this tool.</p>

                <!-- Progress Bar -->
                <div class="rp-progress-wrap">
                    <span style="font-size: 0.82rem; font-weight: 600; white-space: nowrap;">Plan completion</span>
                    <div class="rp-progress-bar-bg">
                        <div class="rp-progress-bar-fill" id="rpProgressBar"></div>
                    </div>
                    <span id="rpProgressLabel" style="font-size: 0.82rem; font-weight: 700; white-space: nowrap; min-width: 38px; text-align: right;">0%</span>
                </div>

                <!-- ‚îÄ‚îÄ Section 1: Exchanges ‚îÄ‚îÄ -->
                <div class="security-dropdown rp-section">
                    <button class="security-dropdown-header" onclick="toggleSecurityDropdown('rp-exchanges')">
                        <span class="dropdown-icon" id="rp-exchanges-icon">‚ñ∂</span>
                        <span>üè¶ Exchanges &amp; Financial Apps</span>
                        <span style="margin-left:auto; font-size:0.75rem; color:var(--text-dim); font-weight:400;">Coinbase ¬∑ Cash App ¬∑ Kraken ¬∑ etc.</span>
                    </button>
                    <div class="security-dropdown-content" id="rp-exchanges-content" style="display:none;">
                        <p style="font-size:0.88rem; color:var(--text-dim); margin-bottom:1rem;">Every exchange or app that holds or can send Bitcoin on your behalf needs its own entry.</p>
                        <div id="exchange-entries"></div>
                        <button class="btn-add-entry" onclick="addRpEntry('exchange')">+ Add Exchange / App</button>
                    </div>
                </div>

                <!-- ‚îÄ‚îÄ Section 2: Software Wallets ‚îÄ‚îÄ -->
                <div class="security-dropdown rp-section">
                    <button class="security-dropdown-header" onclick="toggleSecurityDropdown('rp-software')">
                        <span class="dropdown-icon" id="rp-software-icon">‚ñ∂</span>
                        <span>üì± Software Wallets</span>
                        <span style="margin-left:auto; font-size:0.75rem; color:var(--text-dim); font-weight:400;">Blue Wallet ¬∑ Muun ¬∑ Sparrow ¬∑ etc.</span>
                    </button>
                    <div class="security-dropdown-content" id="rp-software-content" style="display:none;">
                        <p style="font-size:0.88rem; color:var(--text-dim); margin-bottom:1rem;">Each entry should fully describe how to recreate that wallet from scratch ‚Äî seed location, script type, derivation path.</p>
                        <div id="software-entries"></div>
                        <button class="btn-add-entry" onclick="addRpEntry('software')">+ Add Software Wallet</button>
                    </div>
                </div>

                <!-- ‚îÄ‚îÄ Section 3: Hardware Wallets ‚îÄ‚îÄ -->
                <div class="security-dropdown rp-section">
                    <button class="security-dropdown-header" onclick="toggleSecurityDropdown('rp-hardware')">
                        <span class="dropdown-icon" id="rp-hardware-icon">‚ñ∂</span>
                        <span>üîí Hardware Wallets</span>
                        <span style="margin-left:auto; font-size:0.75rem; color:var(--text-dim); font-weight:400;">Coldcard ¬∑ Trezor ¬∑ Jade ¬∑ etc.</span>
                    </button>
                    <div class="security-dropdown-content" id="rp-hardware-content" style="display:none;">
                        <p style="font-size:0.88rem; color:var(--text-dim); margin-bottom:1rem;">Record device details and seed locations only. Never store seed words or passphrases in this tool.</p>
                        <div id="hardware-entries"></div>
                        <button class="btn-add-entry" onclick="addRpEntry('hardware')">+ Add Hardware Wallet</button>
                    </div>
                </div>

                <!-- ‚îÄ‚îÄ Section 4: Multisig & Collaborative Custody ‚îÄ‚îÄ -->
                <div class="security-dropdown rp-section">
                    <button class="security-dropdown-header" onclick="toggleSecurityDropdown('rp-multisig')">
                        <span class="dropdown-icon" id="rp-multisig-icon">‚ñ∂</span>
                        <span>üîê Multisig &amp; Collaborative Custody</span>
                        <span style="margin-left:auto; font-size:0.75rem; color:var(--text-dim); font-weight:400;">Sparrow ¬∑ Unchained ¬∑ Theya ¬∑ Casa</span>
                    </button>
                    <div class="security-dropdown-content" id="rp-multisig-content" style="display:none;">
                        <div class="rp-grid-2" style="margin-bottom:0.85rem;">
                            <div class="rp-field">
                                <label>Multisig Policy</label>
                                <select onchange="rpUpdateProgress()">
                                    <option value="">‚Äî select ‚Äî</option>
                                    <option value="2of3">2-of-3</option>
                                    <option value="3of5">3-of-5</option>
                                    <option value="2of2">2-of-2</option>
                                    <option value="1of2">1-of-2</option>
                                    <option value="custom">Custom</option>
                                </select>
                            </div>
                            <div class="rp-field">
                                <label>Coordinator Software</label>
                                <select onchange="rpUpdateProgress()">
                                    <option value="">‚Äî select ‚Äî</option>
                                    <option value="sparrow">Sparrow Wallet</option>
                                    <option value="nunchuk">Nunchuk</option>
                                    <option value="specter">Specter Desktop</option>
                                    <option value="liana">Liana</option>
                                    <option value="other">Other</option>
                                </select>
                            </div>
                        </div>
                        <div class="rp-field">
                            <label>Wallet Descriptor / Output Descriptor Stored At</label>
                            <input type="text" placeholder="e.g. encrypted USB drive, printed in safe, cloud backup" oninput="rpUpdateProgress()" />
                        </div>
                        <div class="rp-field" style="margin-top:0.25rem;">
                            <label>Collaborative Custody Provider</label>
                            <select onchange="rpShowConditionalSelect(this,'rp-collab-detail')">
                                <option value="">None ‚Äî fully self-custody</option>
                                <option value="unchained">Unchained Capital</option>
                                <option value="theya">Theya</option>
                                <option value="casa">Casa</option>
                                <option value="other">Other provider</option>
                            </select>
                        </div>
                        <div class="rp-conditional" id="rp-collab-detail">
                            <div class="rp-grid-2">
                                <div class="rp-field">
                                    <label>Vault Name / ID</label>
                                    <input type="text" placeholder="Name in provider's system" oninput="rpUpdateProgress()" />
                                </div>
                                <div class="rp-field">
                                    <label>Your Key Stored At</label>
                                    <input type="text" placeholder="Location of your key" oninput="rpUpdateProgress()" />
                                </div>
                            </div>
                            <div class="rp-field">
                                <label>Provider Support / Recovery Contact (for heir)</label>
                                <input type="text" placeholder="Phone or email your heir should call" oninput="rpUpdateProgress()" />
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ‚îÄ‚îÄ Section 5: Seed Storage Map ‚îÄ‚îÄ -->
                <div class="security-dropdown rp-section">
                    <button class="security-dropdown-header" onclick="toggleSecurityDropdown('rp-seeds')">
                        <span class="dropdown-icon" id="rp-seeds-icon">‚ñ∂</span>
                        <span>üó∫Ô∏è Seed Storage Map</span>
                        <span style="margin-left:auto; font-size:0.75rem; color:var(--text-dim); font-weight:400;">Where each physical seed backup lives</span>
                    </button>
                    <div class="security-dropdown-content" id="rp-seeds-content" style="display:none;">
                        <p style="font-size:0.88rem; color:var(--text-dim); margin-bottom:1rem;">Record <strong style="color:var(--text-light);">locations only</strong>. Never enter actual seed words anywhere digitally.</p>
                        <div class="rp-grid-2">
                            <div class="rp-field"><label>Seed / Key 1 ‚Äî Label</label><input type="text" placeholder="e.g. Coldcard main seed" oninput="rpUpdateProgress()" /></div>
                            <div class="rp-field"><label>Seed / Key 1 ‚Äî Physical Location</label><input type="text" placeholder="e.g. Home safe, top shelf" oninput="rpUpdateProgress()" /></div>
                            <div class="rp-field"><label>Seed / Key 2 ‚Äî Label</label><input type="text" placeholder="e.g. Trezor backup" oninput="rpUpdateProgress()" /></div>
                            <div class="rp-field"><label>Seed / Key 2 ‚Äî Physical Location</label><input type="text" placeholder="e.g. Safety deposit box, Bank A" oninput="rpUpdateProgress()" /></div>
                            <div class="rp-field"><label>Seed / Key 3 ‚Äî Label</label><input type="text" placeholder="e.g. Cosigner C" oninput="rpUpdateProgress()" /></div>
                            <div class="rp-field"><label>Seed / Key 3 ‚Äî Physical Location</label><input type="text" placeholder="e.g. Attorney office" oninput="rpUpdateProgress()" /></div>
                        </div>
                        <div class="rp-field" style="margin-top:0.25rem;">
                            <label>Seed Backup Format</label>
                            <select onchange="rpUpdateProgress()">
                                <option value="">‚Äî select all that apply in notes ‚Äî</option>
                                <option value="paper">Paper (hand-written)</option>
                                <option value="metal">Metal plate / stamped steel</option>
                                <option value="cryptosteel">Cryptosteel / Bilodeau</option>
                                <option value="encrypted">Encrypted digital backup</option>
                                <option value="shamir">Shamir Secret Sharing (SLIP39)</option>
                                <option value="multiple">Multiple formats</option>
                            </select>
                        </div>
                        <p style="font-size:0.85rem; font-weight:700; margin:1rem 0 0.5rem; text-transform:uppercase; letter-spacing:0.05em;">Physical Security Checklist</p>
                        <label class="rp-check"><input type="checkbox" onchange="rpUpdateProgress()" /><span>Metal backup present ‚Äî fire and water resistant</span></label>
                        <label class="rp-check"><input type="checkbox" onchange="rpUpdateProgress()" /><span>Fire-resistant storage location confirmed</span></label>
                        <label class="rp-check"><input type="checkbox" onchange="rpUpdateProgress()" /><span>Seeds stored in geographically separate locations</span></label>
                        <label class="rp-check"><input type="checkbox" onchange="rpUpdateProgress()" /><span>Tamper-evident packaging used</span></label>
                        <label class="rp-check"><input type="checkbox" onchange="rpUpdateProgress()" /><span>Trusted heir knows how to locate this recovery plan</span></label>
                    </div>
                </div>

                <!-- ‚îÄ‚îÄ Section 6: Heir Instructions ‚îÄ‚îÄ -->
                <div class="security-dropdown rp-section" style="margin-bottom:1.5rem;">
                    <button class="security-dropdown-header" onclick="toggleSecurityDropdown('rp-heir')">
                        <span class="dropdown-icon" id="rp-heir-icon">‚ñ∂</span>
                        <span>üìú Heir Instructions</span>
                        <span style="margin-left:auto; font-size:0.75rem; color:var(--text-dim); font-weight:400;">Step-by-step recovery protocol</span>
                    </button>
                    <div class="security-dropdown-content" id="rp-heir-content" style="display:none;">
                        <p style="font-size:0.88rem; color:var(--text-dim); margin-bottom:1.25rem;">If you are incapacitated or unable to manage your Bitcoin, the person you trust should follow these steps in order.</p>

                        <div class="heir-step">
                            <div class="heir-num">1</div>
                            <div class="heir-body">
                                <strong>Contact this person first</strong>
                                <div class="rp-grid-2">
                                    <div class="rp-field"><label>Name &amp; relationship</label><input type="text" placeholder="Trusted advisor name" oninput="rpUpdateProgress()" /></div>
                                    <div class="rp-field"><label>Phone / Email</label><input type="text" placeholder="How to reach them" oninput="rpUpdateProgress()" /></div>
                                </div>
                            </div>
                        </div>

                        <div class="heir-step">
                            <div class="heir-num">2</div>
                            <div class="heir-body">
                                <strong>Retrieve the physical recovery binder from</strong>
                                <div class="rp-field"><input type="text" placeholder="Physical location of written recovery binder" oninput="rpUpdateProgress()" /></div>
                            </div>
                        </div>

                        <div class="heir-step">
                            <div class="heir-num">3</div>
                            <div class="heir-body">
                                <strong>Retrieve seed backups from</strong>
                                <div class="rp-field"><input type="text" placeholder="Where physical seeds / metal backups are stored" oninput="rpUpdateProgress()" /></div>
                            </div>
                        </div>

                        <div class="heir-step">
                            <div class="heir-num">4</div>
                            <div class="heir-body">
                                <strong>Contact collaborative custody provider (if applicable)</strong>
                                <div class="rp-grid-2">
                                    <div class="rp-field"><label>Provider &amp; contact</label><input type="text" placeholder="e.g. Unchained Capital, support@unchained.com" oninput="rpUpdateProgress()" /></div>
                                    <div class="rp-field"><label>Documents required</label><input type="text" placeholder="e.g. Death certificate, government ID" oninput="rpUpdateProgress()" /></div>
                                </div>
                            </div>
                        </div>

                        <div class="heir-step">
                            <div class="heir-num">5</div>
                            <div class="heir-body">
                                <strong>Attorney / legal contact for estate</strong>
                                <div class="rp-field"><input type="text" placeholder="Attorney name, phone, and firm" oninput="rpUpdateProgress()" /></div>
                            </div>
                        </div>

                        <div style="margin-top:1rem; padding:1rem 1.25rem; background:rgba(0,0,0,0.35); border:2px solid var(--accent-red); border-radius:8px;">
                            <strong style="color:var(--accent-red);">‚ö†Ô∏è Critical ‚Äî read before touching any funds:</strong>
                            <ul style="margin:0.5rem 0 0 1.5rem; line-height:1.9; font-size:0.9rem;">
                                <li>Never type a seed phrase into any website, app, or computer unless guided by a verified Bitcoin professional in person</li>
                                <li>No legitimate company will ask you to "verify" or "recover" a seed phrase to release funds ‚Äî that is a scam</li>
                                <li>When in doubt, wait and consult the trusted advisor listed in Step 1 before taking any action</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Export -->
                <div style="text-align:center; padding-top:0.5rem; border-top:1px solid var(--border-color); margin-top:0.5rem;">
                    <button class="btn" style="max-width:320px; margin-top:1.25rem;" onclick="exportRecoveryPlan()">üìã Export Summary as Text File</button>
                    <p style="font-size:0.78rem; color:var(--text-dim); margin-top:0.5rem;">Exports labels and locations only ‚Äî never seed phrases or private keys.</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Complete BIP39 word list (all 2048 words from BIP39 standard)
        const BIP39_WORDLIST = [
            "abandon", "ability", "able", "about", "above", "absent", "absorb", "abstract",
            "absurd", "abuse", "access", "accident", "account", "accuse", "achieve", "acid",
            "acoustic", "acquire", "across", "act", "action", "actor", "actress", "actual",
            "adapt", "add", "addict", "address", "adjust", "admit", "adult", "advance",
            "advice", "aerobic", "affair", "afford", "afraid", "again", "age", "agent",
            "agree", "ahead", "aim", "air", "airport", "aisle", "alarm", "album", "alcohol",
            "alert", "alien", "all", "alley", "allow", "almost", "alone", "alpha", "already",
            "also", "alter", "always", "amateur", "amazing", "among", "amount", "amused",
            "analyst", "anchor", "ancient", "anger", "angle", "angry", "animal", "ankle",
            "announce", "annual", "another", "answer", "antenna", "antique", "anxiety", "any",
            "apart", "apology", "appear", "apple", "approve", "april", "arch", "arctic",
            "area", "arena", "argue", "arm", "armed", "armor", "army", "around", "arrange",
            "arrest", "arrive", "arrow", "art", "artefact", "artist", "artwork", "ask",
            "aspect", "assault", "asset", "assist", "assume", "asthma", "athlete", "atom",
            "attack", "attend", "attitude", "attract", "auction", "audit", "august", "aunt",
            "author", "auto", "autumn", "average", "avocado", "avoid", "awake", "aware",
            "away", "awesome", "awful", "awkward", "axis", "baby", "bachelor", "bacon",
            "badge", "bag", "balance", "balcony", "ball", "bamboo", "banana", "banner",
            "bar", "barely", "bargain", "barrel", "base", "basic", "basket", "battle",
            "beach", "bean", "beauty", "because", "become", "beef", "before", "begin",
            "behave", "behind", "believe", "below", "belt", "bench", "benefit", "best",
            "betray", "better", "between", "beyond", "bicycle", "bid", "bike", "bind",
            "biology", "bird", "birth", "bitter", "black", "blade", "blame", "blanket",
            "blast", "bleak", "bless", "blind", "blood", "blossom", "blouse", "blue",
            "blur", "blush", "board", "boat", "body", "boil", "bomb", "bone", "bonus",
            "book", "boost", "border", "boring", "borrow", "boss", "bottom", "bounce",
            "box", "boy", "bracket", "brain", "brand", "brass", "brave", "bread", "breeze",
            "brick", "bridge", "brief", "bright", "bring", "brisk", "broccoli", "broken",
            "bronze", "broom", "brother", "brown", "brush", "bubble", "buddy", "budget",
            "buffalo", "build", "bulb", "bulk", "bullet", "bundle", "bunker", "burden",
            "burger", "burst", "bus", "business", "busy", "butter", "buyer", "buzz",
            "cabbage", "cabin", "cable", "cactus", "cage", "cake", "call", "calm", "camera",
            "camp", "can", "canal", "cancel", "candy", "cannon", "canoe", "canvas", "canyon",
            "capable", "capital", "captain", "car", "carbon", "card", "cargo", "carpet",
            "carry", "cart", "case", "cash", "casino", "castle", "casual", "cat", "catalog",
            "catch", "category", "cattle", "caught", "cause", "caution", "cave", "ceiling",
            "celery", "cement", "census", "century", "cereal", "certain", "chair", "chalk",
            "champion", "change", "chaos", "chapter", "charge", "chase", "chat", "cheap",
            "check", "cheese", "chef", "cherry", "chest", "chicken", "chief", "child",
            "chimney", "choice", "choose", "chronic", "chuckle", "chunk", "churn", "cigar",
            "cinnamon", "circle", "citizen", "city", "civil", "claim", "clap", "clarify",
            "claw", "clay", "clean", "clerk", "clever", "click", "client", "cliff", "climb",
            "clinic", "clip", "clock", "clog", "close", "cloth", "cloud", "clown", "club",
            "clump", "cluster", "clutch", "coach", "coast", "coconut", "code", "coffee",
            "coil", "coin", "collect", "color", "column", "combine", "come", "comfort",
            "comic", "common", "company", "concert", "conduct", "confirm", "congress",
            "connect", "consider", "control", "convince", "cook", "cool", "copper", "copy",
            "coral", "core", "corn", "correct", "cost", "cotton", "couch", "country",
            "couple", "course", "cousin", "cover", "coyote", "crack", "cradle", "craft",
            "cram", "crane", "crash", "crater", "crawl", "crazy", "cream", "credit", "creek",
            "crew", "cricket", "crime", "crisp", "critic", "crop", "cross", "crouch", "crowd",
            "crucial", "cruel", "cruise", "crumble", "crunch", "crush", "cry", "crystal",
            "cube", "culture", "cup", "cupboard", "curious", "current", "curtain", "curve",
            "cushion", "custom", "cute", "cycle", "dad", "damage", "damp", "dance", "danger",
            "daring", "dash", "daughter", "dawn", "day", "deal", "debate", "debris", "decade",
            "december", "decide", "decline", "decorate", "decrease", "deer", "defense",
            "define", "defy", "degree", "delay", "deliver", "demand", "demise", "denial",
            "dentist", "deny", "depart", "depend", "deposit", "depth", "deputy", "derive",
            "describe", "desert", "design", "desk", "despair", "destroy", "detail", "detect",
            "develop", "device", "devote", "diagram", "dial", "diamond", "diary", "dice",
            "diesel", "diet", "differ", "digital", "dignity", "dilemma", "dinner", "dinosaur",
            "direct", "dirt", "disagree", "discover", "disease", "dish", "dismiss", "disorder",
            "display", "distance", "divert", "divide", "divorce", "dizzy", "doctor", "document",
            "dog", "doll", "dolphin", "domain", "donate", "donkey", "donor", "door", "dose",
            "double", "dove", "draft", "dragon", "drama", "drastic", "draw", "dream", "dress",
            "drift", "drill", "drink", "drip", "drive", "drop", "drum", "dry", "duck", "dumb",
            "dune", "during", "dust", "dutch", "duty", "dwarf", "dynamic", "eager", "eagle",
            "early", "earn", "earth", "easily", "east", "easy", "echo", "ecology", "economy",
            "edge", "edit", "educate", "effort", "egg", "eight", "either", "elbow", "elder",
            "electric", "elegant", "element", "elephant", "elevator", "elite", "else", "embark",
            "embody", "embrace", "emerge", "emotion", "employ", "empower", "empty", "enable",
            "enact", "end", "endless", "endorse", "enemy", "energy", "enforce", "engage",
            "engine", "enhance", "enjoy", "enlist", "enough", "enrich", "enroll", "ensure",
            "enter", "entire", "entry", "envelope", "episode", "equal", "equip", "era",
            "erase", "erode", "erosion", "error", "erupt", "escape", "essay", "essence",
            "estate", "eternal", "ethics", "evidence", "evil", "evoke", "evolve", "exact",
            "example", "excess", "exchange", "excite", "exclude", "excuse", "execute",
            "exercise", "exhaust", "exhibit", "exile", "exist", "exit", "exotic", "expand",
            "expect", "expire", "explain", "expose", "express", "extend", "extra", "eye",
            "eyebrow", "fabric", "face", "faculty", "fade", "faint", "faith", "fall", "false",
            "fame", "family", "famous", "fan", "fancy", "fantasy", "farm", "fashion", "fat",
            "fatal", "father", "fatigue", "fault", "favorite", "feature", "february", "federal",
            "fee", "feed", "feel", "female", "fence", "festival", "fetch", "fever", "few",
            "fiber", "fiction", "field", "figure", "file", "film", "filter", "final", "find",
            "fine", "finger", "finish", "fire", "firm", "first", "fiscal", "fish", "fit",
            "fitness", "fix", "flag", "flame", "flash", "flat", "flavor", "flee", "flight",
            "flip", "float", "flock", "floor", "flower", "fluid", "flush", "fly", "foam",
            "focus", "fog", "foil", "fold", "follow", "food", "foot", "force", "forest",
            "forget", "fork", "fortune", "forum", "forward", "fossil", "foster", "found",
            "fox", "fragile", "frame", "frequent", "fresh", "friend", "fringe", "frog",
            "front", "frost", "frown", "frozen", "fruit", "fuel", "fun", "funny", "furnace",
            "fury", "future", "gadget", "gain", "galaxy", "gallery", "game", "gap", "garage",
            "garbage", "garden", "garlic", "garment", "gas", "gasp", "gate", "gather", "gauge",
            "gaze", "general", "genius", "genre", "gentle", "genuine", "gesture", "ghost",
            "giant", "gift", "giggle", "ginger", "giraffe", "girl", "give", "glad", "glance",
            "glare", "glass", "glide", "glimpse", "globe", "gloom", "glory", "glove", "glow",
            "glue", "goat", "goddess", "gold", "good", "goose", "gorilla", "gospel", "gossip",
            "govern", "gown", "grab", "grace", "grain", "grant", "grape", "grass", "gravity",
            "great", "green", "grid", "grief", "grit", "grocery", "group", "grow", "grunt",
            "guard", "guess", "guide", "guilt", "guitar", "gun", "gym", "habit", "hair",
            "half", "hammer", "hamster", "hand", "happy", "harbor", "hard", "harsh", "harvest",
            "hat", "have", "hawk", "hazard", "head", "health", "heart", "heavy", "hedgehog",
            "height", "hello", "helmet", "help", "hen", "hero", "hidden", "high", "hill",
            "hint", "hip", "hire", "history", "hobby", "hockey", "hold", "hole", "holiday",
            "hollow", "home", "honey", "hood", "hope", "horn", "horror", "horse", "hospital",
            "host", "hotel", "hour", "hover", "hub", "huge", "human", "humble", "humor",
            "hundred", "hungry", "hunt", "hurdle", "hurry", "hurt", "husband", "hybrid",
            "ice", "icon", "idea", "identify", "idle", "ignore", "ill", "illegal", "illness",
            "image", "imitate", "immense", "immune", "impact", "impose", "improve", "impulse",
            "inch", "include", "income", "increase", "index", "indicate", "indoor", "industry",
            "infant", "inflict", "inform", "inhale", "inherit", "initial", "inject", "injury",
            "inmate", "inner", "innocent", "input", "inquiry", "insane", "insect", "inside",
            "inspire", "install", "intact", "interest", "into", "invest", "invite", "involve",
            "iron", "island", "isolate", "issue", "item", "ivory", "jacket", "jaguar", "jar",
            "jazz", "jealous", "jeans", "jelly", "jewel", "job", "join", "joke", "journey",
            "joy", "judge", "juice", "jump", "jungle", "junior", "junk", "just", "kangaroo",
            "keen", "keep", "ketchup", "key", "kick", "kid", "kidney", "kind", "kingdom",
            "kiss", "kit", "kitchen", "kite", "kitten", "kiwi", "knee", "knife", "knock",
            "know", "lab", "label", "labor", "ladder", "lady", "lake", "lamp", "language",
            "laptop", "large", "later", "latin", "laugh", "laundry", "lava", "law", "lawn",
            "lawsuit", "layer", "lazy", "leader", "leaf", "learn", "leave", "lecture", "left",
            "leg", "legal", "legend", "leisure", "lemon", "lend", "length", "lens", "leopard",
            "lesson", "letter", "level", "liar", "liberty", "library", "license", "life",
            "lift", "light", "like", "limb", "limit", "link", "lion", "liquid", "list",
            "little", "live", "lizard", "load", "loan", "lobster", "local", "lock", "logic",
            "lonely", "long", "loop", "lottery", "loud", "lounge", "love", "loyal", "lucky",
            "luggage", "lumber", "lunar", "lunch", "luxury", "lyrics", "machine", "mad",
            "magic", "magnet", "maid", "mail", "main", "major", "make", "mammal", "man",
            "manage", "mandate", "mango", "mansion", "manual", "maple", "marble", "march",
            "margin", "marine", "market", "marriage", "mask", "mass", "master", "match",
            "material", "math", "matrix", "matter", "maximum", "maze", "meadow", "mean",
            "measure", "meat", "mechanic", "medal", "media", "melody", "melt", "member",
            "memory", "mention", "menu", "mercy", "merge", "merit", "merry", "mesh", "message",
            "metal", "method", "middle", "midnight", "milk", "million", "mimic", "mind",
            "minimum", "minor", "minute", "miracle", "mirror", "misery", "miss", "mistake",
            "mix", "mixed", "mixture", "mobile", "model", "modify", "mom", "moment", "monitor",
            "monkey", "monster", "month", "moon", "moral", "more", "morning", "mosquito",
            "mother", "motion", "motor", "mountain", "mouse", "move", "movie", "much", "muffin",
            "mule", "multiply", "muscle", "museum", "mushroom", "music", "must", "mutual",
            "myself", "mystery", "myth", "naive", "name", "napkin", "narrow", "nasty", "nation",
            "nature", "near", "neck", "need", "negative", "neglect", "neither", "nephew",
            "nerve", "nest", "net", "network", "neutral", "never", "news", "next", "nice",
            "night", "noble", "noise", "nominee", "noodle", "normal", "north", "nose",
            "notable", "note", "nothing", "notice", "novel", "now", "nuclear", "number",
            "nurse", "nut", "oak", "obey", "object", "oblige", "obscure", "observe", "obtain",
            "obvious", "occur", "ocean", "october", "odor", "off", "offer", "office", "often",
            "oil", "okay", "old", "olive", "olympic", "omit", "once", "one", "onion", "online",
            "only", "open", "opera", "opinion", "oppose", "option", "orange", "orbit",
            "orchard", "order", "ordinary", "organ", "orient", "original", "orphan", "ostrich",
            "other", "outdoor", "outer", "output", "outside", "oval", "oven", "over", "own",
            "owner", "oxygen", "oyster", "ozone", "pact", "paddle", "page", "pair", "palace",
            "palm", "panda", "panel", "panic", "panther", "paper", "parade", "parent", "park",
            "parrot", "party", "pass", "patch", "path", "patient", "patrol", "pattern",
            "pause", "pave", "payment", "peace", "peanut", "pear", "peasant", "pelican",
            "pen", "penalty", "pencil", "people", "pepper", "perfect", "permit", "person",
            "pet", "phone", "photo", "phrase", "physical", "piano", "picnic", "picture",
            "piece", "pig", "pigeon", "pill", "pilot", "pink", "pioneer", "pipe", "pistol",
            "pitch", "pizza", "place", "planet", "plastic", "plate", "play", "please", "pledge",
            "pluck", "plug", "plunge", "poem", "poet", "point", "polar", "pole", "police",
            "pond", "pony", "pool", "popular", "portion", "position", "possible", "post",
            "potato", "pottery", "poverty", "powder", "power", "practice", "praise", "predict",
            "prefer", "prepare", "present", "pretty", "prevent", "price", "pride", "primary",
            "print", "priority", "prison", "private", "prize", "problem", "process", "produce",
            "profit", "program", "project", "promote", "proof", "property", "prosper",
            "protect", "proud", "provide", "public", "pudding", "pull", "pulp", "pulse",
            "pumpkin", "punch", "pupil", "puppy", "purchase", "purity", "purpose", "purse",
            "push", "put", "puzzle", "pyramid", "quality", "quantum", "quarter", "question",
            "quick", "quit", "quiz", "quote", "rabbit", "raccoon", "race", "rack", "radar",
            "radio", "rail", "rain", "raise", "rally", "ramp", "ranch", "random", "range",
            "rapid", "rare", "rate", "rather", "raven", "raw", "razor", "ready", "real",
            "reason", "rebel", "rebuild", "recall", "receive", "recipe", "record", "recycle",
            "reduce", "reflect", "reform", "refuse", "region", "regret", "regular", "reject",
            "relax", "release", "relief", "rely", "remain", "remember", "remind", "remove",
            "render", "renew", "rent", "reopen", "repair", "repeat", "replace", "report",
            "require", "rescue", "resemble", "resist", "resource", "response", "result",
            "retire", "retreat", "return", "reunion", "reveal", "review", "reward", "rhythm",
            "rib", "ribbon", "rice", "rich", "ride", "ridge", "rifle", "right", "rigid",
            "ring", "riot", "ripple", "risk", "ritual", "rival", "river", "road", "roast",
            "robot", "robust", "rocket", "romance", "roof", "rookie", "room", "rose", "rotate",
            "rough", "round", "route", "royal", "rubber", "rude", "rug", "rule", "run",
            "runway", "rural", "sad", "saddle", "sadness", "safe", "sail", "salad", "salmon",
            "salon", "salt", "salute", "same", "sample", "sand", "satisfy", "satoshi", "sauce",
            "sausage", "save", "say", "scale", "scan", "scare", "scatter", "scene", "scheme",
            "school", "science", "scissors", "scorpion", "scout", "scrap", "screen", "script",
            "scrub", "sea", "search", "season", "seat", "second", "secret", "section",
            "security", "seed", "seek", "segment", "select", "sell", "seminar", "senior",
            "sense", "sentence", "series", "service", "session", "settle", "setup", "seven",
            "shadow", "shaft", "shallow", "share", "shed", "shell", "sheriff", "shield",
            "shift", "shine", "ship", "shiver", "shock", "shoe", "shoot", "shop", "short",
            "shoulder", "shove", "shrimp", "shrug", "shuffle", "shy", "sibling", "sick",
            "side", "siege", "sight", "sign", "silent", "silk", "silly", "silver", "similar",
            "simple", "since", "sing", "siren", "sister", "situate", "six", "size", "skate",
            "sketch", "ski", "skill", "skin", "skirt", "skull", "slab", "slam", "sleep",
            "slender", "slice", "slide", "slight", "slim", "slogan", "slot", "slow", "slush",
            "small", "smart", "smile", "smoke", "smooth", "snack", "snake", "snap", "sniff",
            "snow", "soap", "soccer", "social", "sock", "soda", "soft", "solar", "soldier",
            "solid", "solution", "solve", "someone", "song", "soon", "sorry", "sort", "soul",
            "sound", "soup", "source", "south", "space", "spare", "spatial", "spawn", "speak",
            "special", "speed", "spell", "spend", "sphere", "spice", "spider", "spike", "spin",
            "spirit", "split", "spoil", "sponsor", "spoon", "sport", "spot", "spray", "spread",
            "spring", "spy", "square", "squeeze", "squirrel", "stable", "stadium", "staff",
            "stage", "stairs", "stamp", "stand", "start", "state", "stay", "steak", "steel",
            "stem", "step", "stereo", "stick", "still", "sting", "stock", "stomach", "stone",
            "stool", "story", "stove", "strategy", "street", "strike", "strong", "struggle",
            "student", "stuff", "stumble", "style", "subject", "submit", "subway", "success",
            "such", "sudden", "suffer", "sugar", "suggest", "suit", "summer", "sun", "sunny",
            "sunset", "super", "supply", "supreme", "sure", "surface", "surge", "surprise",
            "surround", "survey", "suspect", "sustain", "swallow", "swamp", "swap", "swarm",
            "swear", "sweet", "swift", "swim", "swing", "switch", "sword", "symbol", "symptom",
            "syrup", "system", "table", "tackle", "tag", "tail", "talent", "talk", "tank",
            "tape", "target", "task", "taste", "tattoo", "taxi", "teach", "team", "tell",
            "ten", "tenant", "tennis", "tent", "term", "test", "text", "thank", "that",
            "theme", "then", "theory", "there", "they", "thing", "this", "thought", "three",
            "thrive", "throw", "thumb", "thunder", "ticket", "tide", "tiger", "tilt", "timber",
            "time", "tiny", "tip", "tired", "tissue", "title", "toast", "tobacco", "today",
            "toddler", "toe", "together", "toilet", "token", "tomato", "tomorrow", "tone",
            "tongue", "tonight", "tool", "tooth", "top", "topic", "topple", "torch", "tornado",
            "tortoise", "toss", "total", "tourist", "toward", "tower", "town", "toy", "track",
            "trade", "traffic", "tragic", "train", "transfer", "trap", "trash", "travel",
            "tray", "treat", "tree", "trend", "trial", "tribe", "trick", "trigger", "trim",
            "trip", "trophy", "trouble", "truck", "true", "truly", "trumpet", "trust", "truth",
            "try", "tube", "tuition", "tumble", "tuna", "tunnel", "turkey", "turn", "turtle",
            "twelve", "twenty", "twice", "twin", "twist", "two", "type", "typical", "ugly",
            "umbrella", "unable", "unaware", "uncle", "uncover", "under", "undo", "unfair",
            "unfold", "unhappy", "uniform", "unique", "unit", "universe", "unknown", "unlock",
            "until", "unusual", "unveil", "update", "upgrade", "uphold", "upon", "upper",
            "upset", "urban", "urge", "usage", "use", "used", "useful", "useless", "usual",
            "utility", "vacant", "vacuum", "vague", "valid", "valley", "valve", "van",
            "vanish", "vapor", "various", "vast", "vault", "vehicle", "velvet", "vendor",
            "venture", "venue", "verb", "verify", "version", "very", "vessel", "veteran",
            "viable", "vibrant", "vicious", "victory", "video", "view", "village", "vintage",
            "violin", "virtual", "virus", "visa", "visit", "visual", "vital", "vivid", "vocal",
            "voice", "void", "volcano", "volume", "vote", "voyage", "wage", "wagon", "wait",
            "walk", "wall", "walnut", "want", "warfare", "warm", "warrior", "wash", "wasp",
            "waste", "water", "wave", "way", "wealth", "weapon", "wear", "weasel", "weather",
            "web", "wedding", "weekend", "weird", "welcome", "west", "wet", "whale", "what",
            "wheat", "wheel", "when", "where", "whip", "whisper", "wide", "width", "wife",
            "wild", "will", "win", "window", "wine", "wing", "wink", "winner", "winter",
            "wire", "wisdom", "wise", "wish", "witness", "wolf", "woman", "wonder", "wood",
            "wool", "word", "work", "world", "worry", "worth", "wrap", "wreck", "wrestle",
            "wrist", "write", "wrong", "yard", "year", "yellow", "you", "young", "youth",
            "zebra", "zero", "zone", "zoo"
        ];

        // Preset weak patterns using actual BIP39 words (for demonstration)
        // All words starting with 'a' - showing predictable patterns are dangerous
        const WEAK_PATTERN_A = BIP39_WORDLIST.filter(w => w.startsWith('a'));
        // All words starting with 'b'
        const WEAK_PATTERN_B = BIP39_WORDLIST.filter(w => w.startsWith('b'));

        // Global state
        let currentSeed = '';
        let currentSeedWords = [];
        let securityScore = 0;
        let backupWords = [];
        let selectedBackupWords = [];

        // Level switching
        function switchLevel(level) {
            document.body.className = `level-${level}`;
            document.querySelectorAll('.level-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
        }

        // Tab switching
        function switchTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        // Security score management
        function updateSecurityScore(points) {
            securityScore = Math.max(0, Math.min(100, securityScore + points));
            document.getElementById('securityScore').textContent = securityScore;
        }

        // TRUE CRYPTOGRAPHIC RANDOMNESS using Web Crypto API
        function getSecureRandomInt(max) {
            const array = new Uint32Array(1);
            window.crypto.getRandomValues(array);
            return array[0] % max;
        }

        // Secure Fisher-Yates shuffle using Web Crypto API
        function secureshuffle(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = getSecureRandomInt(i + 1);
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }

        function generateSecureSeed() {
            const length = parseInt(document.getElementById('seedLength').value);
            const seed = [];

            // Use Web Crypto API for true randomness
            for (let i = 0; i < length; i++) {
                const randomIndex = getSecureRandomInt(BIP39_WORDLIST.length);
                seed.push(BIP39_WORDLIST[randomIndex]);
            }

            currentSeed = seed.join(' ');
            currentSeedWords = seed;
            displaySeedWithHighlight(currentSeed);
            enableButtons();
            showSecurityAnalysis(true);
            updateEntropy(100);
            updateSecurityScore(20);
        }

        function generateWeakSeed() {
            const length = parseInt(document.getElementById('seedLength').value);
            const seed = [];

            // Intentionally weak for demonstration - all words start with 'a'
            // This shows why predictable patterns are dangerous even with valid BIP39 words
            for (let i = 0; i < length; i++) {
                // Use words starting with 'a' in order (very predictable pattern)
                seed.push(WEAK_PATTERN_A[i % WEAK_PATTERN_A.length]);
            }

            currentSeed = seed.join(' ');
            currentSeedWords = seed;
            displaySeedWithHighlight(currentSeed);
            enableButtons();
            showSecurityAnalysis(false);
            updateEntropy(15);
            updateSecurityScore(-10);
        }

        function enableButtons() {
            document.getElementById('generateBtn').disabled = false;
            document.getElementById('multipleBtn').disabled = false;
            document.getElementById('startBackupBtn').disabled = false;
        }

        function displaySeedWithHighlight(seed) {
            const words = seed.split(' ');
            const seedDisplay = document.getElementById('seedDisplay');

            seedDisplay.innerHTML = words.map((word, index) =>
                `<span class="seed-word">${index + 1}. ${word}</span>`
            ).join('');
        }

        function updateEntropy(level) {
            const entropyFill = document.getElementById('entropyFill');
            const entropyText = document.getElementById('entropyText');

            entropyFill.style.width = level + '%';

            if (level < 30) {
                entropyFill.style.background = '#F44336';
                entropyText.textContent = 'Very Low - Easily crackable!';
            } else if (level < 60) {
                entropyFill.style.background = '#FF9800';
                entropyText.textContent = 'Low - Vulnerable to attacks';
            } else if (level < 80) {
                entropyFill.style.background = '#FFC107';
                entropyText.textContent = 'Medium - Use only for testing';
            } else {
                entropyFill.style.background = '#4CAF50';
                entropyText.textContent = 'High - Cryptographically secure (Web Crypto API)';
            }
        }

        function showSecurityAnalysis(isSecure) {
            const securityDiv = document.getElementById('seedSecurity');

            if (isSecure) {
                securityDiv.innerHTML = `
                    <div class="security-level level-green">üü¢ SECURE: Cryptographically random seed</div>
                    <ul style="margin-top: 0.5rem; line-height: 1.8;">
                        <li>‚úÖ Generated using Web Crypto API</li>
                        <li>‚úÖ Uses BIP39 wordlist (2048 words)</li>
                        <li>‚úÖ Truly unpredictable entropy source</li>
                        <li>‚ö†Ô∏è This is educational - don't use for real funds!</li>
                    </ul>
                `;
            } else {
                securityDiv.innerHTML = `
                    <div class="security-level level-red">üî¥ INSECURE: Weak seed detected!</div>
                    <ul style="margin-top: 0.5rem; line-height: 1.8;">
                        <li>‚ùå Contains predictable words</li>
                        <li>‚ùå Low entropy - vulnerable to dictionary attacks</li>
                        <li>‚ùå Could be cracked in seconds/minutes</li>
                        <li>‚ùå NEVER use predictable words in real wallets!</li>
                    </ul>
                `;
            }
        }

        function showEntropySource() {
            alert('Entropy Source:\n\nThis demo uses the Web Crypto API (window.crypto.getRandomValues()) which provides cryptographically secure random numbers.\n\nUnlike Math.random() which is predictable, Web Crypto API uses the operating system\'s secure random number generator (CSRNG).\n\nFor real Bitcoin wallets, hardware wallets use specialized hardware RNGs for even more security.');
        }

        // Address generation with simulated BIP32 derivation
        function simpleHash(input) {
            let hash = 0;
            for (let i = 0; i < input.length; i++) {
                const char = input.charCodeAt(i);
                hash = ((hash << 5) - hash) + char;
                hash = hash & hash;
            }

            const chars = '123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz';
            let result = '';
            let num = Math.abs(hash);

            for (let i = 0; i < 64; i++) {
                result += chars[num % chars.length];
                num = Math.floor(num / chars.length) + i * 7;
            }

            return result;
        }

        function generateAddress() {
            if (!currentSeed) return;

            const addressType = document.getElementById('addressType').value;
            const passphrase = document.getElementById('passphrase') ? document.getElementById('passphrase').value : '';
            const index = document.getElementById('addressIndex') ? parseInt(document.getElementById('addressIndex').value) : 0;

            const seedWithPassphrase = currentSeed + (passphrase ? ' ' + passphrase : '');
            const hash = simpleHash(seedWithPassphrase + addressType + index);

            let address, prefix, path;
            switch (addressType) {
                case 'legacy':
                    prefix = '1';
                    path = `m/44'/0'/0'/0/${index}`;
                    break;
                case 'segwit':
                    prefix = '3';
                    path = `m/49'/0'/0'/0/${index}`;
                    break;
                case 'native':
                    prefix = 'bc1';
                    path = `m/84'/0'/0'/0/${index}`;
                    break;
            }

            address = prefix + hash.substring(0, addressType === 'native' ? 39 : 33);

            document.getElementById('addressText').textContent = address;
            document.getElementById('derivationPath').textContent = path;
            document.getElementById('addressDisplay').style.display = 'block';

            generateQRCode(address);
            updateSecurityScore(5);
        }

        function generateMultipleAddresses() {
            if (!currentSeed) return;

            const addressType = document.getElementById('addressType').value;
            const addresses = [];

            for (let i = 0; i < 5; i++) {
                const hash = simpleHash(currentSeed + addressType + i);
                let prefix, path;

                switch (addressType) {
                    case 'legacy':
                        prefix = '1';
                        path = `m/44'/0'/0'/0/${i}`;
                        break;
                    case 'segwit':
                        prefix = '3';
                        path = `m/49'/0'/0'/0/${i}`;
                        break;
                    case 'native':
                        prefix = 'bc1';
                        path = `m/84'/0'/0'/0/${i}`;
                        break;
                }

                const address = prefix + hash.substring(0, addressType === 'native' ? 39 : 33);
                addresses.push({ address, path, index: i });
            }

            displayMultipleAddresses(addresses);
        }

        function displayMultipleAddresses(addresses) {
            const container = document.getElementById('multipleAddresses');
            const list = document.getElementById('addressList');

            list.innerHTML = addresses.map(addr => `
                <div style="margin: 1rem 0; padding: 1rem; background: rgba(255,255,255,0.05); border-radius: 8px; border: 1px solid var(--border-color);">
                    <strong>Address ${addr.index}:</strong><br>
                    <code style="font-size: 0.85rem; word-break: break-all;">${addr.address}</code><br>
                    <small style="color: var(--text-dim);">Path: ${addr.path}</small>
                </div>
            `).join('');

            container.style.display = 'block';
        }

        function generateQRCode(text) {
            const canvas = document.getElementById('qrCode');
            const container = document.getElementById('qrContainer');

            // Ensure canvas has proper dimensions before QR generation
            canvas.width = 200;
            canvas.height = 200;

            if (typeof QRCode !== 'undefined' && QRCode.toCanvas) {
                QRCode.toCanvas(canvas, text, {
                    width: 200,
                    margin: 2,
                    color: { dark: '#000000', light: '#FFFFFF' }
                }, function (error) {
                    if (error) {
                        console.error('QR Code error:', error);
                        // Fallback: show address text prominently if QR fails
                        canvas.style.display = 'none';
                        container.innerHTML = `
                            <h3>QR Code</h3>
                            <div style="padding: 1rem; background: #fff; border-radius: 8px; color: #000; font-family: monospace; word-break: break-all; font-size: 0.8rem;">
                                ${text}
                            </div>
                            <p><small>Copy address above to share</small></p>
                        `;
                    } else {
                        canvas.style.display = 'block';
                    }
                });
            } else {
                // QRCode library not loaded - show text fallback
                console.warn('QRCode library not available');
                canvas.style.display = 'none';
                container.innerHTML = `
                    <h3>Address</h3>
                    <div style="padding: 1rem; background: #fff; border-radius: 8px; color: #000; font-family: monospace; word-break: break-all; font-size: 0.8rem;">
                        ${text}
                    </div>
                    <p><small>Copy address above to share</small></p>
                `;
            }

            container.style.display = 'block';
        }

        function useCustomPath() {
            alert('Custom derivation paths allow you to explore different address spaces.\n\nWarning: Non-standard paths may not be recoverable in other wallets. Always use standard BIP44/49/84 paths for real funds.');
        }

        // Backup practice
        let seedBlurred = false;

        function toggleBlur() {
            const seedDisplay = document.getElementById('seedForBackup');
            const icon = document.getElementById('blurToggleIcon');
            const text = document.getElementById('blurToggleText');

            seedBlurred = !seedBlurred;

            if (seedBlurred) {
                seedDisplay.classList.add('blurred');
                icon.textContent = 'üëÅÔ∏è';
                text.textContent = 'Show Seed';
            } else {
                seedDisplay.classList.remove('blurred');
                icon.textContent = 'üôà';
                text.textContent = 'Hide Seed (Practice Mode)';
            }
        }

        function startBackupPractice() {
            if (!currentSeed) return;

            backupWords = currentSeedWords;
            selectedBackupWords = [];
            seedBlurred = false; // Reset blur state

            document.getElementById('backupInstructions').style.display = 'none';
            document.getElementById('backupPractice').style.display = 'block';

            const seedDisplay = document.getElementById('seedForBackup');
            seedDisplay.classList.remove('blurred'); // Ensure not blurred on start
            seedDisplay.innerHTML =
                backupWords.map((word, index) =>
                    `<span class="seed-word">${index + 1}. ${word}</span>`
                ).join('');

            // Reset blur toggle button
            document.getElementById('blurToggleIcon').textContent = 'üôà';
            document.getElementById('blurToggleText').textContent = 'Hide Seed (Practice Mode)';

            const shuffled = secureshuffle(backupWords);
            const shuffledContainer = document.getElementById('shuffledWords');

            shuffledContainer.innerHTML = shuffled.map(word =>
                `<div class="backup-word" onclick="selectBackupWord('${word}')">${word}</div>`
            ).join('');

            updateSelectedWordsDisplay();
        }

        function selectBackupWord(word) {
            if (selectedBackupWords.length < backupWords.length) {
                selectedBackupWords.push(word);
                updateSelectedWordsDisplay();

                const wordElements = document.querySelectorAll('.backup-word');
                wordElements.forEach(el => {
                    if (el.textContent === word && !el.classList.contains('selected')) {
                        el.classList.add('selected');
                        el.onclick = null;
                        return;
                    }
                });

                if (selectedBackupWords.length === backupWords.length) {
                    document.getElementById('checkBackupBtn').disabled = false;
                }
            }
        }

        function updateSelectedWordsDisplay() {
            const container = document.getElementById('selectedWords');
            container.innerHTML = selectedBackupWords.map((word, index) =>
                `<div class="backup-word selected">${index + 1}. ${word}</div>`
            ).join('');
        }

        function checkBackup() {
            const isCorrect = selectedBackupWords.every((word, index) => word === backupWords[index]);
            const resultDiv = document.getElementById('backupResult');

            if (isCorrect) {
                resultDiv.innerHTML = `
                    <div class="security-level level-green">
                        <strong>üü¢ PERFECT! Backup verified correctly!</strong>
                    </div>
                    <p style="margin-top: 1rem; line-height: 1.6;">
                        You've successfully verified your seed phrase. In a real scenario, store this written backup in a secure location (safe, safety deposit box, metal backup, etc.).
                    </p>
                    <div style="margin-top: 1rem; padding: 1rem; background: rgba(76, 175, 80, 0.1); border-left: 3px solid var(--accent-green); border-radius: 0.5rem; font-size: 0.95rem;">
                        <strong>üí° Good to know:</strong> Different wallets use different verification methods. Some ask you to click words in order (like this), others ask for specific word positions (e.g., "What's word #3 and #7?"), and some let you type them in. The goal is always the same: prove you wrote down your backup correctly.
                    </div>
                `;
                updateSecurityScore(25);
            } else {
                // Find which positions are wrong
                const wrongPositions = [];
                selectedBackupWords.forEach((word, index) => {
                    if (word !== backupWords[index]) {
                        wrongPositions.push(index + 1);
                    }
                });

                resultDiv.innerHTML = `
                    <div class="security-level level-red">
                        <strong>üî¥ Incorrect order! Please try again.</strong>
                    </div>
                    <p style="margin-top: 1rem; line-height: 1.6;">
                        ${wrongPositions.length === backupWords.length
                            ? 'The words you selected are not in the correct order.'
                            : `Position${wrongPositions.length > 1 ? 's' : ''} ${wrongPositions.join(', ')} ${wrongPositions.length > 1 ? 'are' : 'is'} incorrect.`}
                        <strong>Order matters!</strong> Each word must be in the exact position you wrote it down.
                    </p>
                    <div style="margin-top: 1rem; padding: 1rem; background: rgba(244, 67, 54, 0.15); border: 2px solid var(--accent-red); border-radius: 0.5rem; text-align: center;">
                        <p style="margin-bottom: 1rem; font-weight: 600;">üîÑ Your selection has been cleared. Try again!</p>
                        <p style="color: var(--text-dim); font-size: 0.9rem;">Tip: Review the seed phrase above carefully before selecting words.</p>
                    </div>
                `;
                updateSecurityScore(-5);

                // Automatically reset after showing feedback so user must try again
                setTimeout(() => {
                    resetBackup();
                    // Keep the error message visible
                    resultDiv.innerHTML = `
                        <div class="security-level level-yellow" style="margin-bottom: 1rem;">
                            ‚ö†Ô∏è Previous attempt was incorrect. Try again!
                        </div>
                        <div style="padding: 1rem; background: rgba(255, 152, 0, 0.1); border-left: 3px solid #ff9800; border-radius: 0.5rem; font-size: 0.95rem;">
                            <strong>üí° Tips for success:</strong>
                            <ul style="margin-top: 0.5rem; margin-left: 1.5rem; line-height: 1.8;">
                                <li>Read each word and its number carefully</li>
                                <li>Select words in exact order: 1, 2, 3...</li>
                                <li>Double-check before clicking "Check My Backup"</li>
                            </ul>
                        </div>
                    `;
                }, 2500);
            }
        }

        function resetBackup() {
            selectedBackupWords = [];
            document.getElementById('checkBackupBtn').disabled = true;
            document.getElementById('backupResult').innerHTML = '';

            const wordElements = document.querySelectorAll('.backup-word');
            wordElements.forEach((el, index) => {
                el.classList.remove('selected');
                if (index < backupWords.length) {
                    const word = el.textContent;
                    el.onclick = () => selectBackupWord(word);
                }
            });

            updateSelectedWordsDisplay();
        }

        // ===== RECOVERY PLAN =====
        const rpCounters = { exchange: 0, software: 0, hardware: 0 };

        function rpExchangeTemplate(id) {
            return `<div class="rp-entry" id="rp-exchange-${id}">
                <div class="rp-entry-head">
                    <span class="rp-entry-title">Exchange / App ${id}</span>
                    <button class="btn-remove-entry" onclick="rpRemove('exchange',${id})">‚úï Remove</button>
                </div>
                <div class="rp-grid-2">
                    <div class="rp-field">
                        <label>Platform</label>
                        <select onchange="rpOther(this,'rpex-o-${id}'); rpUpdateProgress()">
                            <option value="">‚Äî select ‚Äî</option>
                            <option>Coinbase</option><option>Cash App</option><option>Venmo</option>
                            <option>Kraken</option><option>Gemini</option><option>Strike</option>
                            <option>River</option><option>Swan Bitcoin</option><option>Bisq (P2P)</option>
                            <option value="other">Other</option>
                        </select>
                        <div class="rp-conditional" id="rpex-o-${id}">
                            <input type="text" placeholder="Enter platform name" oninput="rpUpdateProgress()" />
                        </div>
                    </div>
                    <div class="rp-field">
                        <label>Email Account Used</label>
                        <input type="text" placeholder="e.g. personal@email.com" oninput="rpUpdateProgress()" />
                    </div>
                    <div class="rp-field">
                        <label>2FA Method</label>
                        <select onchange="rpUpdateProgress()">
                            <option value="">‚Äî select ‚Äî</option>
                            <option>Authenticator App (Aegis, Google Auth, Authy)</option>
                            <option>Hardware Key (YubiKey, Titan)</option>
                            <option>SMS ‚Äî not recommended</option>
                            <option>Email 2FA</option>
                            <option>None</option>
                        </select>
                    </div>
                    <div class="rp-field">
                        <label>Withdrawal Address Tested</label>
                        <label class="rp-check" style="margin-top:0.4rem;">
                            <input type="checkbox" onchange="rpUpdateProgress()" />
                            <span>Confirmed successful withdrawal to self-custody</span>
                        </label>
                    </div>
                </div>
                <div class="rp-grid-2" style="margin-top:0.25rem;">
                    <div class="rp-field">
                        <label>2FA Backup Codes Stored At</label>
                        <input type="text" placeholder="Location of backup codes" oninput="rpUpdateProgress()" />
                    </div>
                    <div class="rp-field">
                        <label>Authenticator Recovery Seed At</label>
                        <input type="text" placeholder="Location of authenticator backup" oninput="rpUpdateProgress()" />
                    </div>
                </div>
                <div class="rp-field">
                    <label>Email Account Recovery Instructions At</label>
                    <input type="text" placeholder="Where to find email recovery info" oninput="rpUpdateProgress()" />
                </div>
            </div>`;
        }

        function rpSoftwareTemplate(id) {
            return `<div class="rp-entry" id="rp-software-${id}">
                <div class="rp-entry-head">
                    <span class="rp-entry-title">Software Wallet ${id}</span>
                    <button class="btn-remove-entry" onclick="rpRemove('software',${id})">‚úï Remove</button>
                </div>
                <div class="rp-grid-2">
                    <div class="rp-field">
                        <label>Wallet Software</label>
                        <select onchange="rpOther(this,'rpsw-o-${id}'); rpUpdateProgress()">
                            <option value="">‚Äî select ‚Äî</option>
                            <option>Blue Wallet</option><option>Aqua</option><option>Muun</option>
                            <option>Theya</option><option>Sparrow Wallet</option><option>Electrum</option>
                            <option>Nunchuk</option><option>Phoenix (Lightning)</option>
                            <option>Zeus (Lightning)</option><option>Alby Hub</option>
                            <option value="other">Other</option>
                        </select>
                        <div class="rp-conditional" id="rpsw-o-${id}">
                            <input type="text" placeholder="Enter wallet name" oninput="rpUpdateProgress()" />
                        </div>
                    </div>
                    <div class="rp-field">
                        <label>Wallet Type</label>
                        <select onchange="rpToggleDesc(this,'rpsw-desc-${id}'); rpUpdateProgress()">
                            <option value="single">Single Signature</option>
                            <option value="multi">Multisig</option>
                        </select>
                    </div>
                    <div class="rp-field">
                        <label>Script Type</label>
                        <select onchange="rpUpdateProgress()">
                            <option value="">‚Äî select ‚Äî</option>
                            <option>Native SegWit ‚Äî p2wpkh (bc1q...)</option>
                            <option>Taproot ‚Äî p2tr (bc1p...)</option>
                            <option>SegWit Wrapped ‚Äî p2sh-p2wpkh (3...)</option>
                            <option>Multisig SegWit ‚Äî p2wsh</option>
                            <option>Legacy ‚Äî p2pkh (1...)</option>
                        </select>
                    </div>
                    <div class="rp-field">
                        <label>Derivation Path</label>
                        <select onchange="rpOther(this,'rpsw-path-${id}'); rpUpdateProgress()">
                            <option value="">‚Äî select ‚Äî</option>
                            <option>m/84'/0'/0' ‚Äî Native SegWit (default)</option>
                            <option>m/86'/0'/0' ‚Äî Taproot</option>
                            <option>m/49'/0'/0' ‚Äî SegWit Wrapped</option>
                            <option>m/48'/0'/0'/2' ‚Äî Multisig Native SegWit</option>
                            <option>m/48'/0'/0'/3' ‚Äî Multisig Taproot</option>
                            <option>m/44'/0'/0' ‚Äî Legacy</option>
                            <option value="other">Custom</option>
                        </select>
                        <div class="rp-conditional" id="rpsw-path-${id}">
                            <input type="text" placeholder="e.g. m/84'/0'/0'" oninput="rpUpdateProgress()" />
                        </div>
                    </div>
                </div>
                <label class="rp-check" style="margin:0.5rem 0;">
                    <input type="checkbox" onchange="rpToggleCheck(this,'rpsw-pass-${id}'); rpUpdateProgress()" />
                    <span>Passphrase (25th word) used</span>
                </label>
                <div class="rp-conditional" id="rpsw-pass-${id}">
                    <div class="rp-field"><label>Passphrase Stored At (location only)</label>
                        <input type="text" placeholder="Never the passphrase itself ‚Äî location only" oninput="rpUpdateProgress()" />
                    </div>
                </div>
                <div class="rp-field" style="margin-top:0.5rem;">
                    <label>Seed Phrase Stored At (location only)</label>
                    <input type="text" placeholder="Physical location of seed backup" oninput="rpUpdateProgress()" />
                </div>
                <div class="rp-conditional" id="rpsw-desc-${id}">
                    <div class="rp-field"><label>Wallet Descriptor / Output Descriptor Stored At</label>
                        <input type="text" placeholder="Required for multisig recovery ‚Äî location of descriptor file" oninput="rpUpdateProgress()" />
                    </div>
                </div>
            </div>`;
        }

        function rpHardwareTemplate(id) {
            return `<div class="rp-entry" id="rp-hardware-${id}">
                <div class="rp-entry-head">
                    <span class="rp-entry-title">Hardware Wallet ${id}</span>
                    <button class="btn-remove-entry" onclick="rpRemove('hardware',${id})">‚úï Remove</button>
                </div>
                <div class="rp-grid-2">
                    <div class="rp-field">
                        <label>Device</label>
                        <select onchange="rpOther(this,'rphw-o-${id}'); rpUpdateProgress()">
                            <option value="">‚Äî select ‚Äî</option>
                            <option>Coldcard Mk4</option><option>Coldcard Q</option>
                            <option>Trezor Model T</option><option>Trezor Safe 3</option>
                            <option>Blockstream Jade</option><option>Ledger Nano X</option>
                            <option>Foundation Passport</option><option>BitBox02</option>
                            <option>Keystone Pro</option><option>SeedSigner (DIY)</option>
                            <option value="other">Other</option>
                        </select>
                        <div class="rp-conditional" id="rphw-o-${id}">
                            <input type="text" placeholder="Enter device name" oninput="rpUpdateProgress()" />
                        </div>
                    </div>
                    <div class="rp-field">
                        <label>Used As</label>
                        <select onchange="rpToggleDesc(this,'rphw-desc-${id}'); rpUpdateProgress()">
                            <option value="single">Single Signature ‚Äî standalone</option>
                            <option value="multi">Multisig cosigner</option>
                        </select>
                    </div>
                    <div class="rp-field">
                        <label>Script Type</label>
                        <select onchange="rpUpdateProgress()">
                            <option value="">‚Äî select ‚Äî</option>
                            <option>Native SegWit ‚Äî p2wpkh (bc1q...)</option>
                            <option>Taproot ‚Äî p2tr (bc1p...)</option>
                            <option>Multisig SegWit ‚Äî p2wsh</option>
                            <option>SegWit Wrapped ‚Äî p2sh-p2wpkh (3...)</option>
                        </select>
                    </div>
                    <div class="rp-field">
                        <label>Derivation Path</label>
                        <select onchange="rpOther(this,'rphw-path-${id}'); rpUpdateProgress()">
                            <option value="">‚Äî select ‚Äî</option>
                            <option>m/84'/0'/0' ‚Äî Native SegWit</option>
                            <option>m/86'/0'/0' ‚Äî Taproot</option>
                            <option>m/48'/0'/0'/2' ‚Äî Multisig Native SegWit</option>
                            <option>m/48'/0'/0'/3' ‚Äî Multisig Taproot</option>
                            <option>m/44'/0'/0' ‚Äî Legacy</option>
                            <option value="other">Custom</option>
                        </select>
                        <div class="rp-conditional" id="rphw-path-${id}">
                            <input type="text" placeholder="e.g. m/48'/0'/0'/2'" oninput="rpUpdateProgress()" />
                        </div>
                    </div>
                </div>
                <div class="rp-grid-2" style="margin-top:0.5rem;">
                    <div>
                        <label class="rp-check">
                            <input type="checkbox" onchange="rpToggleCheck(this,'rphw-pass-${id}'); rpUpdateProgress()" />
                            <span>Passphrase used</span>
                        </label>
                        <div class="rp-conditional" id="rphw-pass-${id}">
                            <div class="rp-field"><label>Passphrase Stored At</label>
                                <input type="text" placeholder="Location only ‚Äî never the passphrase" oninput="rpUpdateProgress()" />
                            </div>
                        </div>
                    </div>
                    <div class="rp-field">
                        <label>Last Restore Test Date</label>
                        <input type="date" oninput="rpUpdateProgress()" />
                    </div>
                </div>
                <div class="rp-field" style="margin-top:0.25rem;">
                    <label>Seed Phrase Stored At (location only)</label>
                    <input type="text" placeholder="Physical location of seed backup" oninput="rpUpdateProgress()" />
                </div>
                <div class="rp-conditional" id="rphw-desc-${id}">
                    <div class="rp-field"><label>Wallet Descriptor / Wallet File Stored At</label>
                        <input type="text" placeholder="Required for multisig ‚Äî location of descriptor file" oninput="rpUpdateProgress()" />
                    </div>
                </div>
            </div>`;
        }

        function addRpEntry(type) {
            const container = document.getElementById(type + '-entries');
            const id = ++rpCounters[type];
            const div = document.createElement('div');
            div.innerHTML = type === 'exchange' ? rpExchangeTemplate(id)
                          : type === 'software' ? rpSoftwareTemplate(id)
                          : rpHardwareTemplate(id);
            container.appendChild(div.firstElementChild);
            rpUpdateProgress();
        }

        function rpRemove(type, id) {
            const el = document.getElementById('rp-' + type + '-' + id);
            if (el) { el.remove(); rpUpdateProgress(); }
        }

        function rpOther(sel, targetId) {
            const el = document.getElementById(targetId);
            if (el) el.style.display = (sel.value === 'other' || sel.value === 'custom') ? 'block' : 'none';
            rpUpdateProgress();
        }

        function rpToggleCheck(cb, targetId) {
            const el = document.getElementById(targetId);
            if (el) el.style.display = cb.checked ? 'block' : 'none';
            rpUpdateProgress();
        }

        function rpToggleDesc(sel, targetId) {
            const el = document.getElementById(targetId);
            if (el) el.style.display = sel.value === 'multi' ? 'block' : 'none';
            rpUpdateProgress();
        }

        function rpShowConditionalSelect(sel, targetId) {
            const el = document.getElementById(targetId);
            if (el) el.style.display = (sel.value && sel.value !== '') ? 'block' : 'none';
            rpUpdateProgress();
        }

        function rpUpdateProgress() {
            const panel = document.getElementById('recovery-plan');
            if (!panel) return;
            let filled = 0, total = 0;
            panel.querySelectorAll('input[type="text"], input[type="date"], select').forEach(el => {
                if (el.offsetParent !== null) {
                    total++;
                    if (el.value && el.value.trim() !== '' && el.value !== '') filled++;
                }
            });
            const pct = total > 0 ? Math.round((filled / total) * 100) : 0;
            const bar = document.getElementById('rpProgressBar');
            const lbl = document.getElementById('rpProgressLabel');
            if (bar) bar.style.width = pct + '%';
            if (lbl) lbl.textContent = pct + '%';
        }

        function exportRecoveryPlan() {
            const panel = document.getElementById('recovery-plan');
            const lines = ['BITCOIN RECOVERY PLAN SUMMARY', '='.repeat(44), ''];
            panel.querySelectorAll('.security-dropdown').forEach(sec => {
                const titleEl = sec.querySelector('.security-dropdown-header span:nth-child(2)');
                if (!titleEl) return;
                lines.push('\n' + titleEl.textContent.trim().toUpperCase());
                lines.push('-'.repeat(40));
                sec.querySelectorAll('.rp-entry').forEach(entry => {
                    const t = entry.querySelector('.rp-entry-title');
                    if (t) lines.push('\n  [' + t.textContent + ']');
                    entry.querySelectorAll('.rp-field').forEach(field => {
                        if (field.offsetParent === null) return;
                        const lbl = field.querySelector('label');
                        const inp = field.querySelector('input[type="text"], input[type="date"], select');
                        if (lbl && inp && inp.value && inp.value.trim()) {
                            lines.push('  ' + lbl.textContent.trim().replace(/\s+/g,' ') + ': ' + inp.value.trim());
                        }
                    });
                    entry.querySelectorAll('input[type="checkbox"]:checked').forEach(cb => {
                        const sp = cb.closest('label')?.querySelector('span');
                        if (sp) lines.push('  ‚úì ' + sp.textContent.trim());
                    });
                });
                // Section-level fields (not inside entries)
                sec.querySelectorAll('.security-dropdown-content > .rp-field, .security-dropdown-content > .rp-grid-2 .rp-field').forEach(field => {
                    if (field.closest('.rp-entry') || field.offsetParent === null) return;
                    const lbl = field.querySelector('label');
                    const inp = field.querySelector('input[type="text"], input[type="date"], select');
                    if (lbl && inp && inp.value && inp.value.trim()) {
                        lines.push('  ' + lbl.textContent.trim().replace(/\s+/g,' ') + ': ' + inp.value.trim());
                    }
                });
                sec.querySelectorAll('.security-dropdown-content input[type="checkbox"]:checked').forEach(cb => {
                    if (cb.closest('.rp-entry')) return;
                    const sp = cb.closest('label')?.querySelector('span');
                    if (sp) lines.push('  ‚úì ' + sp.textContent.trim());
                });
            });
            lines.push('\n' + '='.repeat(44));
            lines.push('Generated: ' + new Date().toLocaleString());
            lines.push('REMINDER: This file contains locations only ‚Äî never seed phrases or private keys.');
            lines.push('Store this file securely. Delete from cloud/email after printing.');
            const blob = new Blob([lines.join('\n')], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'bitcoin-recovery-plan-' + Date.now() + '.txt';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // Initialize from URL parameters
        const urlParams = new URLSearchParams(window.location.search);
        const levelParam = urlParams.get('level');
        if (levelParam && ['beginner', 'intermediate', 'advanced'].includes(levelParam)) {
            document.body.className = `level-${levelParam}`;
            document.querySelectorAll('.level-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.textContent.toLowerCase().includes(levelParam)) {
                    btn.classList.add('active');
                }
            });
        }

        // Security dropdown toggle
        function toggleSecurityDropdown(sectionId) {
            const content = document.getElementById(`${sectionId}-content`);
            const icon = document.getElementById(`${sectionId}-icon`);
            
            if (content.style.display === 'none' || content.style.display === '') {
                content.style.display = 'block';
                icon.classList.add('rotated');
                icon.textContent = '‚ñº';
            } else {
                content.style.display = 'none';
                icon.classList.remove('rotated');
                icon.textContent = '‚ñ∂';
            }
        }

        // Initialize score
        updateSecurityScore(0);

        console.log('üîê Wallet Security Workshop initialized');
        console.log('‚úÖ Using Web Crypto API for true randomness');
        console.log('‚ö†Ô∏è Educational tool only - never use for real funds!');
    </script>

    <!-- Animated Icon Library -->
    <script src="/js/icon-library.js"></script>
    <script>
        // Inject icons after DOM loads
        document.addEventListener('DOMContentLoaded', function() {
            if (window.IconLibrary) {
                document.querySelectorAll('[data-icon]').forEach(function(element) {
                    var iconName = element.getAttribute('data-icon');
                    if (iconName) {
                        var iconHTML = IconLibrary.get(iconName, 20, true);
                        var span = document.createElement('span');
                        span.innerHTML = iconHTML;
                        span.className = 'icon-inline';
                        span.style.marginRight = '0.5rem';
                        span.style.display = 'inline-block';
                        span.style.verticalAlign = 'middle';
                        element.insertBefore(span, element.firstChild);
                    }
                });
            }
        });
    </script>


    <!-- Navigation Context (return-to-path functionality) -->
    <script src="/js/navigation-context.js"></script>

    <!-- AI Tutor -->
    <script src="/js/tutor-loader.js"></script>
<script src="/js/membership-gate.js"></script>
</body></html>
