<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bitcoin Wallet Security Workshop - Bitcoin Sovereign Academy</title>
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
    <link rel="stylesheet" href="/css/brand.css">
    <link rel="stylesheet" href="/css/status-indicators.css">
    <style>
        :root {
            --primary-orange: #f7931a;
            --primary-dark: #1a1a1a;
            --secondary-dark: #2d2d2d;
            --text-light: #e0e0e0;
            --text-dim: #999;
            --accent-green: #4caf50;
            --accent-red: #F44336;
            --accent-purple: #9C27B0;
            --border-color: rgba(247, 147, 26, 0.3);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: var(--text-light);
            line-height: 1.6;
            padding: 1.5rem;
            min-height: 100vh;
        }

        /* Multi-Level Support */
        body.level-beginner .intermediate-only,
        body.level-beginner .advanced-only { display: none; }
        body.level-intermediate .beginner-only,
        body.level-intermediate .advanced-only { display: none; }
        body.level-advanced .beginner-only,
        body.level-advanced .intermediate-only { display: none; }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 2rem;
            background: rgba(0, 0, 0, 0.3);
            padding: 2rem;
            border-radius: 15px;
            border: 2px solid var(--primary-orange);
        }

        .header h1 {
            color: var(--primary-orange);
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        .header p {
            color: var(--text-dim);
            font-size: 1.1rem;
        }

        .security-score {
            display: inline-block;
            background: rgba(247, 147, 26, 0.2);
            padding: 0.75rem 1.5rem;
            border-radius: 25px;
            margin-top: 1rem;
            font-weight: bold;
            border: 2px solid var(--primary-orange);
        }

        /* Level Switcher */
        .level-switcher {
            display: flex;
            gap: 0.75rem;
            justify-content: center;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .level-btn {
            padding: 0.75rem 1.5rem;
            background: rgba(247, 147, 26, 0.1);
            border: 2px solid var(--border-color);
            border-radius: 0.5rem;
            cursor: pointer;
            font-weight: 600;
            color: var(--text-light);
            transition: all 0.3s ease;
        }

        .level-btn.active {
            background: var(--primary-orange);
            color: #000;
            border-color: var(--primary-orange);
        }

        /* Tabs */
        .tabs {
            display: flex;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 0.5rem;
            margin-bottom: 2rem;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .tab {
            flex: 1;
            min-width: 150px;
            padding: 0.75rem;
            text-align: center;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
            background: rgba(255, 255, 255, 0.05);
        }

        .tab.active {
            background: var(--primary-orange);
            color: #000;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Two-column layout for better UX */
        .demo-grid {
            display: grid;
            grid-template-columns: 1.5fr 1fr;
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .card {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid var(--border-color);
            border-radius: 15px;
            padding: 1.5rem;
            transition: all 0.3s ease;
        }

        .card h2 {
            color: var(--primary-orange);
            font-size: 1.5rem;
            margin-bottom: 1rem;
            border-bottom: 2px solid var(--primary-orange);
            padding-bottom: 0.5rem;
        }

        .card h3 {
            color: var(--primary-orange);
            font-size: 1.2rem;
            margin: 1.5rem 0 0.75rem 0;
        }

        /* Sticky controls */
        .controls-panel {
            position: sticky;
            top: 1rem;
            background: rgba(0, 0, 0, 0.5);
            padding: 1.5rem;
            border-radius: 0.75rem;
            border: 2px solid var(--border-color);
        }

        .seed-display {
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid var(--primary-orange);
            border-radius: 10px;
            padding: 1.5rem;
            margin: 1rem 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            word-break: break-all;
            min-height: 100px;
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            transition: filter 0.3s ease;
        }

        .seed-display.blurred {
            filter: blur(10px);
            user-select: none;
            pointer-events: none;
        }

        .seed-word {
            display: inline-block;
            padding: 0.5rem 0.75rem;
            background: rgba(247, 147, 26, 0.2);
            border-radius: 5px;
            border: 1px solid var(--border-color);
        }

        .address-display {
            background: rgba(76, 175, 80, 0.1);
            border: 2px solid var(--accent-green);
            border-radius: 10px;
            padding: 1rem;
            margin: 1rem 0;
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
            word-break: break-all;
        }

        .qr-container {
            text-align: center;
            margin: 1.5rem 0;
            padding: 1.5rem;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            border: 2px solid var(--accent-green);
        }

        .qr-container h3 {
            margin-bottom: 1rem;
            color: var(--text-light);
        }

        .qr-code {
            margin: 0 auto;
            display: block;
            background: white;
            padding: 10px;
            border-radius: 8px;
        }

        .entropy-meter {
            width: 100%;
            height: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            overflow: hidden;
            margin: 1rem 0;
        }

        .entropy-fill {
            height: 100%;
            transition: all 0.5s ease;
            border-radius: 10px;
        }

        .input-group {
            margin: 1rem 0;
        }

        .input-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: bold;
            color: var(--text-light);
        }

        .input-group input,
        .input-group select {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            background: rgba(0, 0, 0, 0.3);
            color: var(--text-light);
            font-size: 1rem;
        }

        .input-group input:focus,
        .input-group select:focus {
            outline: none;
            border-color: var(--primary-orange);
        }

        .btn {
            background: var(--primary-orange);
            color: #000;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            font-size: 1rem;
            margin: 0.5rem 0.5rem 0.5rem 0;
            transition: all 0.3s ease;
            width: 100%;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(247, 147, 26, 0.4);
        }

        .btn-secondary {
            background: linear-gradient(45deg, #6c757d, #868e96);
            color: white;
        }

        .btn-danger {
            background: linear-gradient(45deg, #F44336, #ff6b6b);
            color: white;
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .security-level {
            display: inline-block;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9rem;
            margin: 0.5rem 0;
        }

        .level-green { background: rgba(76, 175, 80, 0.2); color: #4CAF50; border: 2px solid #4CAF50; }
        .level-yellow { background: rgba(255, 193, 7, 0.2); color: #FFC107; border: 2px solid #FFC107; }
        .level-red { background: rgba(244, 67, 54, 0.2); color: #F44336; border: 2px solid #F44336; }

        .tip-box {
            background: rgba(33, 150, 243, 0.1);
            border-left: 4px solid #2196F3;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 0.5rem;
        }

        .backup-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 0.75rem;
            margin: 1rem 0;
        }

        .backup-word {
            padding: 0.75rem;
            text-align: center;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid transparent;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .backup-word:hover {
            border-color: var(--primary-orange);
        }

        .backup-word.selected {
            border-color: var(--accent-green);
            background: rgba(76, 175, 80, 0.2);
        }

        .derivation-path {
            font-family: 'Courier New', monospace;
            background: rgba(0, 0, 0, 0.3);
            padding: 0.75rem;
            border-radius: 8px;
            margin: 0.5rem 0;
            font-size: 0.9rem;
        }

        /* ===== ACCESSIBILITY ENHANCEMENTS (WCAG 2.1 AA) ===== */

        /* Color Contrast - Change dim text from #999 to #b3b3b3 for 4.6:1 ratio */
        :root {
            --text-dim: #b3b3b3;
        }

        .header p, small, .node-value, .node-path {
            color: #b3b3b3;
        }

        /* Touch Targets - Minimum 44x44px */
        button, a, [role="button"], input[type="button"], input[type="submit"],
        .btn, .level-btn, .tab, .backup-word {
            min-height: 44px;
            min-width: 44px;
        }

        /* Focus Indicators */
        *:focus-visible {
            outline: 3px solid var(--primary-orange, #f7931a);
            outline-offset: 2px;
        }

        button:focus-visible, a:focus-visible, input:focus-visible, select:focus-visible,
        .tab:focus-visible, .backup-word:focus-visible {
            outline: 3px solid var(--primary-orange, #f7931a);
            outline-offset: 4px;
            box-shadow: 0 0 0 4px rgba(247, 147, 26, 0.2);
        }

        /* Reduced Motion */
        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }

        /* Mobile Reflow */
        @media (max-width: 360px) {
            body {
                overflow-x: hidden;
            }
        }

        @media (max-width: 968px) {
            .demo-grid {
                grid-template-columns: 1fr;
            }

            .controls-panel {
                position: static;
            }

            .backup-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 768px) {
            body {
                padding: 1rem;
            }

            .header h1 {
                font-size: 2rem;
            }

            .tabs {
                flex-direction: column;
            }

            .tab {
                min-width: 100%;
            }
        }
    </style>
    <link rel="stylesheet" href="/css/icons.css">
    <link rel="stylesheet" href="/css/interactive-demos.css">
</head>
<body class="level-beginner">
    <script src="/js/config.js"></script>
    <script src="/js/demo-lock-subdomain.js"></script>
    <script src="/js/subdomain-access-control.js"></script>



    <div class="container">
        <header class="header">
            <h1><span data-icon="lock"></span> Bitcoin Wallet Security Workshop</h1>
            <p class="beginner-only">Learn how Bitcoin wallets work and practice security in a safe environment</p>
            <p class="intermediate-only">Master seed phrases, derivation paths, and wallet security best practices</p>
            <p class="advanced-only">Deep dive into BIP39, BIP32/44, cryptographic security, and advanced wallet features</p>
            <div class="security-score">
                Security Score: <span id="securityScore">0</span>/100
            </div>
        </header>

        <div class="level-switcher">
            <button class="level-btn active" onclick="switchLevel('beginner')">üå± Beginner</button>
            <button class="level-btn" onclick="switchLevel('intermediate')"><span data-icon="lightning"></span> Intermediate</button>
            <button class="level-btn" onclick="switchLevel('advanced')"><span data-icon="tool"></span> Advanced</button>
        </div>

        <div class="tabs">
            <div class="tab active" onclick="switchTab('generator')">Seed Generator</div>
            <div class="tab" onclick="switchTab('backup')">Backup Practice</div>
            <div class="tab" onclick="switchTab('addresses')">Address Explorer</div>
            <div class="tab beginner-only" onclick="switchTab('tips')">Security Tips</div>
            <div class="tab intermediate-only advanced-only" onclick="switchTab('advanced')">Advanced</div>
        </div>

        <!-- Generator Tab -->
        <div id="generator" class="tab-content active">
            <div class="demo-grid">
                <section class="card">
                    <h2>üé≤ Seed Phrase Generator</h2>
                    <div class="security-level level-green">üü¢ Educational Tool - Safe Environment</div>

                    <p class="beginner-only">A seed phrase is like a master password for your Bitcoin. It's a list of 12 or 24 random words that can recreate your entire wallet.</p>
                    <p class="intermediate-only">Your seed phrase uses BIP39 standard - a list of words from a 2048-word dictionary. Each word adds ~11 bits of entropy.</p>
                    <p class="advanced-only">BIP39 mnemonic sentences use SHA-512 PBKDF2 with 2048 iterations to derive the seed. Entropy: 128 bits (12 words) or 256 bits (24 words).</p>

                    <div class="entropy-meter">
                        <div id="entropyFill" class="entropy-fill" style="width: 0%; background: #F44336;"></div>
                    </div>
                    <small>Entropy Level: <span id="entropyText">No seed generated</span></small>

                    <div id="seedDisplay" class="seed-display">
                        Click "Generate New Seed Phrase" to create a truly random seed phrase
                    </div>

                    <div id="seedSecurity"></div>

                    <div class="beginner-only tip-box">
                        <strong><span data-icon="lightbulb"></span> Why Random Words?</strong><br>
                        Using random words makes it impossible for hackers to guess. Never use words you can think of yourself!
                    </div>

                    <div class="intermediate-only tip-box">
                        <strong>‚ö†Ô∏è Passphrase (25th Word):</strong><br>
                        Optional extra security layer. Even if someone finds your 24 words, they can't access funds without the passphrase.
                    </div>

                    <div class="advanced-only tip-box">
                        <strong>üî¨ Cryptographic Entropy:</strong><br>
                        Uses Web Crypto API (crypto.getRandomValues) for cryptographically secure randomness. Never use Math.random() for real wallets!
                    </div>
                </section>

                <section class="controls-panel">
                    <h3 style="color: var(--primary-orange); margin-top: 0;">‚öôÔ∏è Controls</h3>

                    <div class="input-group">
                        <label for="seedLength">Seed Phrase Length:</label>
                        <select id="seedLength">
                            <option value="12">12 words (Standard)</option>
                            <option value="24">24 words (Maximum Security)</option>
                        </select>
                    </div>

                    <div class="input-group intermediate-only advanced-only">
                        <label for="passphrase">Passphrase (Optional 25th Word):</label>
                        <input type="password" id="passphrase" placeholder="Leave empty for standard wallet">
                    </div>

                    <button class="btn" onclick="generateSecureSeed()">üé≤ Generate Secure Seed</button>
                    <button class="btn btn-danger beginner-only" onclick="generateWeakSeed()">‚ö†Ô∏è Generate Weak Seed (Demo)</button>

                    <div class="advanced-only">
                        <button class="btn btn-secondary" onclick="showEntropySource()"><span data-icon="chart"></span> Show Entropy Source</button>
                    </div>
                </section>
            </div>

            <div class="card beginner-only">
                <h2><span data-icon="shield"></span> Security Best Practices</h2>
                <ul style="line-height: 2;">
                    <li>‚úÖ <strong>Always write</strong> your seed phrase on paper</li>
                    <li>‚úÖ <strong>Never type</strong> it into a computer or phone</li>
                    <li>‚úÖ <strong>Never share</strong> it with anyone - not even "support"</li>
                    <li>‚úÖ <strong>Store it safely</strong> like cash or jewelry</li>
                    <li>‚ùå <strong>Never store</strong> it in cloud, email, or photos</li>
                </ul>
            </div>
        </div>

        <!-- Backup Practice Tab -->
        <div id="backup" class="tab-content">
            <div class="card">
                <h2>üìù Seed Phrase Backup Practice</h2>
                <div class="security-level level-yellow">üü° Practice proper backup procedures</div>

                <p class="beginner-only">The most important part of Bitcoin security is backing up your seed phrase correctly. Let's practice!</p>
                <p class="intermediate-only">Practice the backup verification process used by hardware wallets like Ledger and Trezor.</p>
                <p class="advanced-only">Simulate BIP39 backup verification with scrambled word selection. Tests memory and accuracy.</p>

                <div id="backupInstructions">
                    <p>First, generate a seed phrase in the Generator tab, then return here to practice backing it up.</p>
                    <button class="btn" onclick="startBackupPractice()" id="startBackupBtn" disabled>Start Backup Practice</button>
                </div>

                <div id="backupPractice" style="display: none;">
                    <h3>Step 1: Review Your Seed Phrase</h3>
                    <p class="beginner-only">In real life, you would write these words on paper. Write them in order!</p>
                    <p class="intermediate-only">Write these on paper, metal backup, or hardware wallet recovery card.</p>
                    <div style="position: relative;">
                        <div id="seedForBackup" class="seed-display"></div>
                        <button class="btn btn-secondary" onclick="toggleBlur()" id="blurToggleBtn" style="margin-top: 0.5rem; font-size: 0.85rem;">
                            <span id="blurToggleIcon">üôà</span> <span id="blurToggleText">Hide Seed (Practice Mode)</span>
                        </button>
                    </div>

                    <h3>Step 2: Verify Your Backup</h3>
                    <p>Click the words in the correct order to verify your backup:</p>
                    <p class="beginner-only" style="font-size: 0.9rem; color: var(--text-dim); margin-top: -0.5rem;">üí° Tip: In real practice, hide the seed phrase above to truly test your backup!</p>
                    <div id="shuffledWords" class="backup-grid"></div>

                    <h3>Your Selection:</h3>
                    <div id="selectedWords" class="backup-grid"></div>

                    <button class="btn" onclick="checkBackup()" id="checkBackupBtn" disabled>‚úÖ Check My Backup</button>
                    <button class="btn btn-secondary" onclick="resetBackup()"><span data-icon="refresh"></span> Reset</button>

                    <div id="backupResult" style="margin-top: 1.5rem;"></div>
                </div>
            </div>
        </div>

        <!-- Address Explorer Tab -->
        <div id="addresses" class="tab-content">
            <div class="demo-grid">
                <section class="card">
                    <h2>üîë Address Generator</h2>
                    <div class="security-level level-green">üü¢ Addresses are safe to share publicly</div>

                    <p class="beginner-only">Your seed phrase creates many different Bitcoin addresses. Each address can receive Bitcoin separately!</p>
                    <p class="intermediate-only">HD wallets use derivation paths to generate billions of addresses from one seed. Understanding paths is key to wallet recovery.</p>
                    <p class="advanced-only">BIP32 hierarchical deterministic key derivation. Path notation: m / purpose' / coin_type' / account' / change / address_index</p>

                    <div class="input-group">
                        <label for="addressType">Address Type:</label>
                        <select id="addressType">
                            <option value="legacy">Legacy (P2PKH) - 1...</option>
                            <option value="segwit">SegWit (P2SH-P2WPKH) - 3...</option>
                            <option value="native">Native SegWit (Bech32) - bc1...</option>
                        </select>
                    </div>

                    <div class="input-group intermediate-only advanced-only">
                        <label for="addressIndex">Address Index:</label>
                        <input type="number" id="addressIndex" min="0" max="20" value="0" placeholder="0">
                        <small>Generate different addresses from the same seed</small>
                    </div>

                    <button class="btn" onclick="generateAddress()" id="generateBtn" disabled>Generate Address</button>
                    <button class="btn btn-secondary" onclick="generateMultipleAddresses()" id="multipleBtn" disabled>Generate 5 Addresses</button>

                    <div id="addressDisplay" class="address-display" style="display: none;">
                        <strong>Bitcoin Address:</strong><br>
                        <span id="addressText"></span>
                        <div class="derivation-path">
                            Path: <span id="derivationPath"></span>
                        </div>
                    </div>

                    <div id="qrContainer" class="qr-container" style="display: none;">
                        <h3>QR Code</h3>
                        <canvas id="qrCode" class="qr-code"></canvas>
                        <p><small>Scan to share address</small></p>
                    </div>

                    <div id="multipleAddresses" style="display: none;">
                        <h3>Generated Addresses:</h3>
                        <div id="addressList"></div>
                    </div>
                </section>

                <section class="controls-panel">
                    <h3 style="color: var(--primary-orange); margin-top: 0;"><span data-icon="books"></span> Learn</h3>

                    <div class="beginner-only tip-box">
                        <strong>Address Types Explained:</strong><br><br>
                        <strong>Legacy (1...):</strong> Original format. Works everywhere but has higher fees.<br><br>
                        <strong>SegWit (3...):</strong> Lower fees, widely supported.<br><br>
                        <strong>Native SegWit (bc1...):</strong> Lowest fees, most efficient. Use this!
                    </div>

                    <div class="intermediate-only tip-box">
                        <strong>Why Multiple Addresses?</strong><br><br>
                        Privacy! Use a new address for each transaction. Reusing addresses links all your payments together.<br><br>
                        Your wallet automatically generates new addresses from the same seed.
                    </div>

                    <div class="advanced-only">
                        <div class="tip-box">
                            <strong>Derivation Path Standards:</strong><br><br>
                            <code>m/44'/0'/0'/0/0</code> - BIP44 Legacy<br>
                            <code>m/49'/0'/0'/0/0</code> - BIP49 SegWit<br>
                            <code>m/84'/0'/0'/0/0</code> - BIP84 Native SegWit<br><br>
                            The 0'/0'/0' means Bitcoin (0'), Account 0 (0'), External chain (0')
                        </div>

                        <div class="input-group">
                            <label for="customPath">Custom Derivation Path:</label>
                            <input type="text" id="customPath" value="m/84'/0'/0'/0/0" placeholder="m/44'/0'/0'/0/0">
                        </div>
                        <button class="btn btn-secondary" onclick="useCustomPath()">Use Custom Path</button>
                    </div>
                </section>
            </div>
        </div>

        <!-- Security Tips Tab -->
        <div id="tips" class="tab-content">
            <div class="card">
                <h2><span data-icon="shield"></span> Bitcoin Security Guidelines</h2>

                <div class="security-level level-green">üü¢ Essential Security Practices</div>
                <ul style="line-height: 2; margin: 1rem 0;">
                    <li>‚úÖ Store seed phrases offline on paper or metal</li>
                    <li>‚úÖ Never share your seed phrase with anyone</li>
                    <li>‚úÖ Use hardware wallets for large amounts</li>
                    <li>‚úÖ Verify addresses before sending funds</li>
                    <li>‚úÖ Test backups with small amounts first</li>
                </ul>

                <div class="security-level level-red" style="margin-top: 2rem;">üî¥ Never Do These Things</div>
                <ul style="line-height: 2; margin: 1rem 0;">
                    <li>‚ùå Never store seeds digitally or in cloud</li>
                    <li>‚ùå Never use predictable seed phrases</li>
                    <li>‚ùå Never share private keys or seeds</li>
                    <li>‚ùå Never use untrusted wallet software</li>
                    <li>‚ùå Never enter seeds on websites</li>
                </ul>

                <div class="tip-box" style="margin-top: 2rem;">
                    <strong><span data-icon="lightbulb"></span> Remember:</strong><br><br>
                    "Not your keys, not your coins" - If someone else holds your seed phrase, they control your Bitcoin. Always maintain personal custody of your seed phrase.
                </div>
            </div>

            <!-- Advanced Device Security -->
            <div class="card" style="margin-top: 2rem;">
                <h2>üì± Advanced Device Security</h2>
                <p style="margin-bottom: 1.5rem;">Beyond seed phrases, protecting your devices and accounts creates multiple layers of security. A sophisticated attacker who gains access to your email and cloud backups could potentially compromise your wallet apps.</p>

                <!-- Hide Wallet Apps -->
                <h3 style="color: var(--primary-orange); margin-top: 1.5rem;">üôà Hide Wallet Apps on iPhone</h3>
                <p>Keep your Bitcoin wallets hidden from prying eyes or casual phone borrowers:</p>
                <ul style="line-height: 2; margin: 1rem 0 1rem 1.5rem;">
                    <li><strong>Lock apps with Face ID/Touch ID:</strong> Require biometric authentication to open sensitive apps</li>
                    <li><strong>Hide apps from Home Screen:</strong> Move wallet apps to the App Library only (not visible on home screen)</li>
                    <li><strong>Hide entire pages:</strong> Create a hidden page with all financial apps</li>
                </ul>
                <div class="tip-box">
                    <strong>üìñ How to do it:</strong> Long-press any app ‚Üí "Require Face ID" or drag to App Library.
                    <a href="https://support.apple.com/guide/iphone/lock-or-hide-or-an-app-iph00f208d05/ios" target="_blank" rel="noopener" style="color: var(--primary-orange);">Apple's official guide ‚Üí</a>
                </div>

                <!-- Password Managers & Hardware Keys -->
                <h3 style="color: var(--primary-orange); margin-top: 2rem;">üîê Use a Hardware Security Key</h3>
                <p>Hardware security keys like YubiKey eliminate phishing and password theft entirely. Even if someone steals your password, they can't log in without the physical key.</p>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin: 1.5rem 0;">
                    <div style="background: rgba(255,255,255,0.05); padding: 1rem; border-radius: 8px; border: 1px solid var(--border-color);">
                        <strong style="color: var(--primary-orange);">YubiKey</strong><br>
                        <small>Hardware 2FA key. Works with 1000+ services. Phishing-proof.</small><br>
                        <a href="https://www.yubico.com/" target="_blank" rel="noopener" style="color: var(--primary-orange); font-size: 0.85rem;">yubico.com ‚Üí</a>
                    </div>
                    <div style="background: rgba(255,255,255,0.05); padding: 1rem; border-radius: 8px; border: 1px solid var(--border-color);">
                        <strong style="color: var(--primary-orange);">1Password</strong><br>
                        <small>Password manager with hardware key support.</small><br>
                        <a href="https://support.1password.com/1password-security/" target="_blank" rel="noopener" style="color: var(--primary-orange); font-size: 0.85rem;">Security whitepaper ‚Üí</a>
                    </div>
                    <div style="background: rgba(255,255,255,0.05); padding: 1rem; border-radius: 8px; border: 1px solid var(--border-color);">
                        <strong style="color: var(--primary-orange);">Bitwarden</strong><br>
                        <small>Open-source password manager. Free tier available.</small><br>
                        <a href="https://bitwarden.com/" target="_blank" rel="noopener" style="color: var(--primary-orange); font-size: 0.85rem;">bitwarden.com ‚Üí</a>
                    </div>
                    <div style="background: rgba(255,255,255,0.05); padding: 1rem; border-radius: 8px; border: 1px solid var(--border-color);">
                        <strong style="color: var(--primary-orange);">Dashlane</strong><br>
                        <small>Password manager with VPN included.</small><br>
                        <a href="https://www.dashlane.com/" target="_blank" rel="noopener" style="color: var(--primary-orange); font-size: 0.85rem;">dashlane.com ‚Üí</a>
                    </div>
                </div>

                <!-- iCloud Security Warning -->
                <h3 style="color: var(--accent-red); margin-top: 2rem;">‚ö†Ô∏è The iCloud Attack Vector</h3>
                <p>Your iCloud account is a potential weak point. Here's why it matters:</p>

                <div style="background: rgba(244, 67, 54, 0.1); border: 2px solid var(--accent-red); border-radius: 10px; padding: 1.5rem; margin: 1rem 0;">
                    <strong style="color: var(--accent-red);">The Chain Attack:</strong>
                    <ol style="margin: 1rem 0 0 1.5rem; line-height: 2;">
                        <li>Attacker gains access to your <strong>email</strong> (phishing, data breach, weak password)</li>
                        <li>Uses email to reset your <strong>iCloud password</strong></li>
                        <li>Downloads your full <strong>iPhone backup</strong> from iCloud</li>
                        <li>Restores backup to their device, now has access to all your apps and data</li>
                        <li>If your wallet app uses iCloud Keychain for encryption keys, attacker could access wallet</li>
                    </ol>
                </div>

                <div class="tip-box" style="background: rgba(76, 175, 80, 0.1); border-left-color: var(--accent-green);">
                    <strong style="color: var(--accent-green);">üõ°Ô∏è How Hardware Keys Stop This:</strong><br><br>
                    With a YubiKey protecting your email and iCloud:
                    <ul style="margin: 0.5rem 0 0 1.5rem; line-height: 1.8;">
                        <li>Even with your password, attackers can't log in without the physical key</li>
                        <li>Phishing sites can't capture your hardware key credentials</li>
                        <li>The entire chain attack becomes impossible</li>
                        <li>Protects <em>everything</em>, not just Bitcoin‚Äîbank accounts, exchanges, social media</li>
                    </ul>
                </div>

                <!-- Mobile Key Security -->
                <h3 style="color: var(--primary-orange); margin-top: 2rem;">üì≤ Mobile Wallet Security Best Practices</h3>
                <ul style="line-height: 2; margin: 1rem 0 1rem 1.5rem;">
                    <li><strong>Disable iCloud Keychain sync</strong> for sensitive wallet apps when possible</li>
                    <li><strong>Use app-specific passwords</strong> instead of iCloud Keychain autofill for exchanges</li>
                    <li><strong>Enable "Erase Data"</strong> after 10 failed passcode attempts (Settings ‚Üí Face ID & Passcode)</li>
                    <li><strong>Use a strong alphanumeric passcode</strong>, not just 6 digits</li>
                    <li><strong>Disable lock screen notifications</strong> for sensitive apps</li>
                    <li><strong>Review "Apps Using iCloud"</strong> regularly and disable for wallet apps</li>
                </ul>

                <div class="tip-box">
                    <strong><span data-icon="lightbulb"></span> Defense in Depth:</strong><br><br>
                    Security isn't about one perfect solution‚Äîit's about layers. Hardware wallet + hidden apps + hardware security key + strong passwords + disabled cloud backups = a much harder target than any single measure alone.
                </div>
            </div>
        </div>

        <!-- Advanced Tab -->
        <div id="advanced" class="tab-content">
            <div class="card">
                <h2>üî¨ Advanced Features</h2>

                <h3 class="intermediate-only">Understanding Entropy</h3>
                <div class="intermediate-only">
                    <p>Entropy measures randomness. Higher entropy = better security.</p>
                    <ul style="margin: 1rem 0; line-height: 1.8;">
                        <li><strong>12 words:</strong> 128 bits of entropy (2<sup>128</sup> combinations)</li>
                        <li><strong>24 words:</strong> 256 bits of entropy (2<sup>256</sup> combinations)</li>
                    </ul>
                    <p>To crack a 12-word seed by brute force would take billions of years with current technology.</p>
                </div>

                <h3 class="advanced-only">BIP39 Technical Details</h3>
                <div class="advanced-only">
                    <p><strong>Specification:</strong> Bitcoin Improvement Proposal 39</p>
                    <ul style="margin: 1rem 0; line-height: 1.8;">
                        <li>Wordlist: 2048 words (2<sup>11</sup>)</li>
                        <li>12 words = 128 bits entropy + 4 bits checksum = 132 bits</li>
                        <li>24 words = 256 bits entropy + 8 bits checksum = 264 bits</li>
                        <li>Derivation: PBKDF2-HMAC-SHA512, 2048 iterations</li>
                        <li>Passphrase: Optional salt for seed derivation</li>
                    </ul>

                    <div class="tip-box" style="margin: 1rem 0;">
                        <strong>Security Analysis:</strong><br><br>
                        A 256-bit seed has 2<sup>256</sup> possible combinations. This number is approximately 10<sup>77</sup> - more than the estimated number of atoms in the observable universe (10<sup>80</sup>).<br><br>
                        Even with quantum computers, brute-forcing a properly generated BIP39 seed is computationally infeasible.
                    </div>
                </div>

                <h3><span data-icon="lock"></span> Test Your Understanding</h3>
                <div class="tip-box">
                    <p><strong>Question:</strong> Why must seed phrases be truly random?</p>
                    <button class="btn btn-secondary" onclick="alert('Answer: If seed phrases aren\'t truly random, attackers can predict them. Using predictable words (like \'password\', \'bitcoin\', etc.) or words from books dramatically reduces the search space from billions of years to minutes or hours. True randomness ensures the full 2^128 or 2^256 security guarantee.')">Show Answer</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Complete BIP39 word list (all 2048 words from BIP39 standard)
        const BIP39_WORDLIST = [
            "abandon", "ability", "able", "about", "above", "absent", "absorb", "abstract",
            "absurd", "abuse", "access", "accident", "account", "accuse", "achieve", "acid",
            "acoustic", "acquire", "across", "act", "action", "actor", "actress", "actual",
            "adapt", "add", "addict", "address", "adjust", "admit", "adult", "advance",
            "advice", "aerobic", "affair", "afford", "afraid", "again", "age", "agent",
            "agree", "ahead", "aim", "air", "airport", "aisle", "alarm", "album", "alcohol",
            "alert", "alien", "all", "alley", "allow", "almost", "alone", "alpha", "already",
            "also", "alter", "always", "amateur", "amazing", "among", "amount", "amused",
            "analyst", "anchor", "ancient", "anger", "angle", "angry", "animal", "ankle",
            "announce", "annual", "another", "answer", "antenna", "antique", "anxiety", "any",
            "apart", "apology", "appear", "apple", "approve", "april", "arch", "arctic",
            "area", "arena", "argue", "arm", "armed", "armor", "army", "around", "arrange",
            "arrest", "arrive", "arrow", "art", "artefact", "artist", "artwork", "ask",
            "aspect", "assault", "asset", "assist", "assume", "asthma", "athlete", "atom",
            "attack", "attend", "attitude", "attract", "auction", "audit", "august", "aunt",
            "author", "auto", "autumn", "average", "avocado", "avoid", "awake", "aware",
            "away", "awesome", "awful", "awkward", "axis", "baby", "bachelor", "bacon",
            "badge", "bag", "balance", "balcony", "ball", "bamboo", "banana", "banner",
            "bar", "barely", "bargain", "barrel", "base", "basic", "basket", "battle",
            "beach", "bean", "beauty", "because", "become", "beef", "before", "begin",
            "behave", "behind", "believe", "below", "belt", "bench", "benefit", "best",
            "betray", "better", "between", "beyond", "bicycle", "bid", "bike", "bind",
            "biology", "bird", "birth", "bitter", "black", "blade", "blame", "blanket",
            "blast", "bleak", "bless", "blind", "blood", "blossom", "blouse", "blue",
            "blur", "blush", "board", "boat", "body", "boil", "bomb", "bone", "bonus",
            "book", "boost", "border", "boring", "borrow", "boss", "bottom", "bounce",
            "box", "boy", "bracket", "brain", "brand", "brass", "brave", "bread", "breeze",
            "brick", "bridge", "brief", "bright", "bring", "brisk", "broccoli", "broken",
            "bronze", "broom", "brother", "brown", "brush", "bubble", "buddy", "budget",
            "buffalo", "build", "bulb", "bulk", "bullet", "bundle", "bunker", "burden",
            "burger", "burst", "bus", "business", "busy", "butter", "buyer", "buzz",
            "cabbage", "cabin", "cable", "cactus", "cage", "cake", "call", "calm", "camera",
            "camp", "can", "canal", "cancel", "candy", "cannon", "canoe", "canvas", "canyon",
            "capable", "capital", "captain", "car", "carbon", "card", "cargo", "carpet",
            "carry", "cart", "case", "cash", "casino", "castle", "casual", "cat", "catalog",
            "catch", "category", "cattle", "caught", "cause", "caution", "cave", "ceiling",
            "celery", "cement", "census", "century", "cereal", "certain", "chair", "chalk",
            "champion", "change", "chaos", "chapter", "charge", "chase", "chat", "cheap",
            "check", "cheese", "chef", "cherry", "chest", "chicken", "chief", "child",
            "chimney", "choice", "choose", "chronic", "chuckle", "chunk", "churn", "cigar",
            "cinnamon", "circle", "citizen", "city", "civil", "claim", "clap", "clarify",
            "claw", "clay", "clean", "clerk", "clever", "click", "client", "cliff", "climb",
            "clinic", "clip", "clock", "clog", "close", "cloth", "cloud", "clown", "club",
            "clump", "cluster", "clutch", "coach", "coast", "coconut", "code", "coffee",
            "coil", "coin", "collect", "color", "column", "combine", "come", "comfort",
            "comic", "common", "company", "concert", "conduct", "confirm", "congress",
            "connect", "consider", "control", "convince", "cook", "cool", "copper", "copy",
            "coral", "core", "corn", "correct", "cost", "cotton", "couch", "country",
            "couple", "course", "cousin", "cover", "coyote", "crack", "cradle", "craft",
            "cram", "crane", "crash", "crater", "crawl", "crazy", "cream", "credit", "creek",
            "crew", "cricket", "crime", "crisp", "critic", "crop", "cross", "crouch", "crowd",
            "crucial", "cruel", "cruise", "crumble", "crunch", "crush", "cry", "crystal",
            "cube", "culture", "cup", "cupboard", "curious", "current", "curtain", "curve",
            "cushion", "custom", "cute", "cycle", "dad", "damage", "damp", "dance", "danger",
            "daring", "dash", "daughter", "dawn", "day", "deal", "debate", "debris", "decade",
            "december", "decide", "decline", "decorate", "decrease", "deer", "defense",
            "define", "defy", "degree", "delay", "deliver", "demand", "demise", "denial",
            "dentist", "deny", "depart", "depend", "deposit", "depth", "deputy", "derive",
            "describe", "desert", "design", "desk", "despair", "destroy", "detail", "detect",
            "develop", "device", "devote", "diagram", "dial", "diamond", "diary", "dice",
            "diesel", "diet", "differ", "digital", "dignity", "dilemma", "dinner", "dinosaur",
            "direct", "dirt", "disagree", "discover", "disease", "dish", "dismiss", "disorder",
            "display", "distance", "divert", "divide", "divorce", "dizzy", "doctor", "document",
            "dog", "doll", "dolphin", "domain", "donate", "donkey", "donor", "door", "dose",
            "double", "dove", "draft", "dragon", "drama", "drastic", "draw", "dream", "dress",
            "drift", "drill", "drink", "drip", "drive", "drop", "drum", "dry", "duck", "dumb",
            "dune", "during", "dust", "dutch", "duty", "dwarf", "dynamic", "eager", "eagle",
            "early", "earn", "earth", "easily", "east", "easy", "echo", "ecology", "economy",
            "edge", "edit", "educate", "effort", "egg", "eight", "either", "elbow", "elder",
            "electric", "elegant", "element", "elephant", "elevator", "elite", "else", "embark",
            "embody", "embrace", "emerge", "emotion", "employ", "empower", "empty", "enable",
            "enact", "end", "endless", "endorse", "enemy", "energy", "enforce", "engage",
            "engine", "enhance", "enjoy", "enlist", "enough", "enrich", "enroll", "ensure",
            "enter", "entire", "entry", "envelope", "episode", "equal", "equip", "era",
            "erase", "erode", "erosion", "error", "erupt", "escape", "essay", "essence",
            "estate", "eternal", "ethics", "evidence", "evil", "evoke", "evolve", "exact",
            "example", "excess", "exchange", "excite", "exclude", "excuse", "execute",
            "exercise", "exhaust", "exhibit", "exile", "exist", "exit", "exotic", "expand",
            "expect", "expire", "explain", "expose", "express", "extend", "extra", "eye",
            "eyebrow", "fabric", "face", "faculty", "fade", "faint", "faith", "fall", "false",
            "fame", "family", "famous", "fan", "fancy", "fantasy", "farm", "fashion", "fat",
            "fatal", "father", "fatigue", "fault", "favorite", "feature", "february", "federal",
            "fee", "feed", "feel", "female", "fence", "festival", "fetch", "fever", "few",
            "fiber", "fiction", "field", "figure", "file", "film", "filter", "final", "find",
            "fine", "finger", "finish", "fire", "firm", "first", "fiscal", "fish", "fit",
            "fitness", "fix", "flag", "flame", "flash", "flat", "flavor", "flee", "flight",
            "flip", "float", "flock", "floor", "flower", "fluid", "flush", "fly", "foam",
            "focus", "fog", "foil", "fold", "follow", "food", "foot", "force", "forest",
            "forget", "fork", "fortune", "forum", "forward", "fossil", "foster", "found",
            "fox", "fragile", "frame", "frequent", "fresh", "friend", "fringe", "frog",
            "front", "frost", "frown", "frozen", "fruit", "fuel", "fun", "funny", "furnace",
            "fury", "future", "gadget", "gain", "galaxy", "gallery", "game", "gap", "garage",
            "garbage", "garden", "garlic", "garment", "gas", "gasp", "gate", "gather", "gauge",
            "gaze", "general", "genius", "genre", "gentle", "genuine", "gesture", "ghost",
            "giant", "gift", "giggle", "ginger", "giraffe", "girl", "give", "glad", "glance",
            "glare", "glass", "glide", "glimpse", "globe", "gloom", "glory", "glove", "glow",
            "glue", "goat", "goddess", "gold", "good", "goose", "gorilla", "gospel", "gossip",
            "govern", "gown", "grab", "grace", "grain", "grant", "grape", "grass", "gravity",
            "great", "green", "grid", "grief", "grit", "grocery", "group", "grow", "grunt",
            "guard", "guess", "guide", "guilt", "guitar", "gun", "gym", "habit", "hair",
            "half", "hammer", "hamster", "hand", "happy", "harbor", "hard", "harsh", "harvest",
            "hat", "have", "hawk", "hazard", "head", "health", "heart", "heavy", "hedgehog",
            "height", "hello", "helmet", "help", "hen", "hero", "hidden", "high", "hill",
            "hint", "hip", "hire", "history", "hobby", "hockey", "hold", "hole", "holiday",
            "hollow", "home", "honey", "hood", "hope", "horn", "horror", "horse", "hospital",
            "host", "hotel", "hour", "hover", "hub", "huge", "human", "humble", "humor",
            "hundred", "hungry", "hunt", "hurdle", "hurry", "hurt", "husband", "hybrid",
            "ice", "icon", "idea", "identify", "idle", "ignore", "ill", "illegal", "illness",
            "image", "imitate", "immense", "immune", "impact", "impose", "improve", "impulse",
            "inch", "include", "income", "increase", "index", "indicate", "indoor", "industry",
            "infant", "inflict", "inform", "inhale", "inherit", "initial", "inject", "injury",
            "inmate", "inner", "innocent", "input", "inquiry", "insane", "insect", "inside",
            "inspire", "install", "intact", "interest", "into", "invest", "invite", "involve",
            "iron", "island", "isolate", "issue", "item", "ivory", "jacket", "jaguar", "jar",
            "jazz", "jealous", "jeans", "jelly", "jewel", "job", "join", "joke", "journey",
            "joy", "judge", "juice", "jump", "jungle", "junior", "junk", "just", "kangaroo",
            "keen", "keep", "ketchup", "key", "kick", "kid", "kidney", "kind", "kingdom",
            "kiss", "kit", "kitchen", "kite", "kitten", "kiwi", "knee", "knife", "knock",
            "know", "lab", "label", "labor", "ladder", "lady", "lake", "lamp", "language",
            "laptop", "large", "later", "latin", "laugh", "laundry", "lava", "law", "lawn",
            "lawsuit", "layer", "lazy", "leader", "leaf", "learn", "leave", "lecture", "left",
            "leg", "legal", "legend", "leisure", "lemon", "lend", "length", "lens", "leopard",
            "lesson", "letter", "level", "liar", "liberty", "library", "license", "life",
            "lift", "light", "like", "limb", "limit", "link", "lion", "liquid", "list",
            "little", "live", "lizard", "load", "loan", "lobster", "local", "lock", "logic",
            "lonely", "long", "loop", "lottery", "loud", "lounge", "love", "loyal", "lucky",
            "luggage", "lumber", "lunar", "lunch", "luxury", "lyrics", "machine", "mad",
            "magic", "magnet", "maid", "mail", "main", "major", "make", "mammal", "man",
            "manage", "mandate", "mango", "mansion", "manual", "maple", "marble", "march",
            "margin", "marine", "market", "marriage", "mask", "mass", "master", "match",
            "material", "math", "matrix", "matter", "maximum", "maze", "meadow", "mean",
            "measure", "meat", "mechanic", "medal", "media", "melody", "melt", "member",
            "memory", "mention", "menu", "mercy", "merge", "merit", "merry", "mesh", "message",
            "metal", "method", "middle", "midnight", "milk", "million", "mimic", "mind",
            "minimum", "minor", "minute", "miracle", "mirror", "misery", "miss", "mistake",
            "mix", "mixed", "mixture", "mobile", "model", "modify", "mom", "moment", "monitor",
            "monkey", "monster", "month", "moon", "moral", "more", "morning", "mosquito",
            "mother", "motion", "motor", "mountain", "mouse", "move", "movie", "much", "muffin",
            "mule", "multiply", "muscle", "museum", "mushroom", "music", "must", "mutual",
            "myself", "mystery", "myth", "naive", "name", "napkin", "narrow", "nasty", "nation",
            "nature", "near", "neck", "need", "negative", "neglect", "neither", "nephew",
            "nerve", "nest", "net", "network", "neutral", "never", "news", "next", "nice",
            "night", "noble", "noise", "nominee", "noodle", "normal", "north", "nose",
            "notable", "note", "nothing", "notice", "novel", "now", "nuclear", "number",
            "nurse", "nut", "oak", "obey", "object", "oblige", "obscure", "observe", "obtain",
            "obvious", "occur", "ocean", "october", "odor", "off", "offer", "office", "often",
            "oil", "okay", "old", "olive", "olympic", "omit", "once", "one", "onion", "online",
            "only", "open", "opera", "opinion", "oppose", "option", "orange", "orbit",
            "orchard", "order", "ordinary", "organ", "orient", "original", "orphan", "ostrich",
            "other", "outdoor", "outer", "output", "outside", "oval", "oven", "over", "own",
            "owner", "oxygen", "oyster", "ozone", "pact", "paddle", "page", "pair", "palace",
            "palm", "panda", "panel", "panic", "panther", "paper", "parade", "parent", "park",
            "parrot", "party", "pass", "patch", "path", "patient", "patrol", "pattern",
            "pause", "pave", "payment", "peace", "peanut", "pear", "peasant", "pelican",
            "pen", "penalty", "pencil", "people", "pepper", "perfect", "permit", "person",
            "pet", "phone", "photo", "phrase", "physical", "piano", "picnic", "picture",
            "piece", "pig", "pigeon", "pill", "pilot", "pink", "pioneer", "pipe", "pistol",
            "pitch", "pizza", "place", "planet", "plastic", "plate", "play", "please", "pledge",
            "pluck", "plug", "plunge", "poem", "poet", "point", "polar", "pole", "police",
            "pond", "pony", "pool", "popular", "portion", "position", "possible", "post",
            "potato", "pottery", "poverty", "powder", "power", "practice", "praise", "predict",
            "prefer", "prepare", "present", "pretty", "prevent", "price", "pride", "primary",
            "print", "priority", "prison", "private", "prize", "problem", "process", "produce",
            "profit", "program", "project", "promote", "proof", "property", "prosper",
            "protect", "proud", "provide", "public", "pudding", "pull", "pulp", "pulse",
            "pumpkin", "punch", "pupil", "puppy", "purchase", "purity", "purpose", "purse",
            "push", "put", "puzzle", "pyramid", "quality", "quantum", "quarter", "question",
            "quick", "quit", "quiz", "quote", "rabbit", "raccoon", "race", "rack", "radar",
            "radio", "rail", "rain", "raise", "rally", "ramp", "ranch", "random", "range",
            "rapid", "rare", "rate", "rather", "raven", "raw", "razor", "ready", "real",
            "reason", "rebel", "rebuild", "recall", "receive", "recipe", "record", "recycle",
            "reduce", "reflect", "reform", "refuse", "region", "regret", "regular", "reject",
            "relax", "release", "relief", "rely", "remain", "remember", "remind", "remove",
            "render", "renew", "rent", "reopen", "repair", "repeat", "replace", "report",
            "require", "rescue", "resemble", "resist", "resource", "response", "result",
            "retire", "retreat", "return", "reunion", "reveal", "review", "reward", "rhythm",
            "rib", "ribbon", "rice", "rich", "ride", "ridge", "rifle", "right", "rigid",
            "ring", "riot", "ripple", "risk", "ritual", "rival", "river", "road", "roast",
            "robot", "robust", "rocket", "romance", "roof", "rookie", "room", "rose", "rotate",
            "rough", "round", "route", "royal", "rubber", "rude", "rug", "rule", "run",
            "runway", "rural", "sad", "saddle", "sadness", "safe", "sail", "salad", "salmon",
            "salon", "salt", "salute", "same", "sample", "sand", "satisfy", "satoshi", "sauce",
            "sausage", "save", "say", "scale", "scan", "scare", "scatter", "scene", "scheme",
            "school", "science", "scissors", "scorpion", "scout", "scrap", "screen", "script",
            "scrub", "sea", "search", "season", "seat", "second", "secret", "section",
            "security", "seed", "seek", "segment", "select", "sell", "seminar", "senior",
            "sense", "sentence", "series", "service", "session", "settle", "setup", "seven",
            "shadow", "shaft", "shallow", "share", "shed", "shell", "sheriff", "shield",
            "shift", "shine", "ship", "shiver", "shock", "shoe", "shoot", "shop", "short",
            "shoulder", "shove", "shrimp", "shrug", "shuffle", "shy", "sibling", "sick",
            "side", "siege", "sight", "sign", "silent", "silk", "silly", "silver", "similar",
            "simple", "since", "sing", "siren", "sister", "situate", "six", "size", "skate",
            "sketch", "ski", "skill", "skin", "skirt", "skull", "slab", "slam", "sleep",
            "slender", "slice", "slide", "slight", "slim", "slogan", "slot", "slow", "slush",
            "small", "smart", "smile", "smoke", "smooth", "snack", "snake", "snap", "sniff",
            "snow", "soap", "soccer", "social", "sock", "soda", "soft", "solar", "soldier",
            "solid", "solution", "solve", "someone", "song", "soon", "sorry", "sort", "soul",
            "sound", "soup", "source", "south", "space", "spare", "spatial", "spawn", "speak",
            "special", "speed", "spell", "spend", "sphere", "spice", "spider", "spike", "spin",
            "spirit", "split", "spoil", "sponsor", "spoon", "sport", "spot", "spray", "spread",
            "spring", "spy", "square", "squeeze", "squirrel", "stable", "stadium", "staff",
            "stage", "stairs", "stamp", "stand", "start", "state", "stay", "steak", "steel",
            "stem", "step", "stereo", "stick", "still", "sting", "stock", "stomach", "stone",
            "stool", "story", "stove", "strategy", "street", "strike", "strong", "struggle",
            "student", "stuff", "stumble", "style", "subject", "submit", "subway", "success",
            "such", "sudden", "suffer", "sugar", "suggest", "suit", "summer", "sun", "sunny",
            "sunset", "super", "supply", "supreme", "sure", "surface", "surge", "surprise",
            "surround", "survey", "suspect", "sustain", "swallow", "swamp", "swap", "swarm",
            "swear", "sweet", "swift", "swim", "swing", "switch", "sword", "symbol", "symptom",
            "syrup", "system", "table", "tackle", "tag", "tail", "talent", "talk", "tank",
            "tape", "target", "task", "taste", "tattoo", "taxi", "teach", "team", "tell",
            "ten", "tenant", "tennis", "tent", "term", "test", "text", "thank", "that",
            "theme", "then", "theory", "there", "they", "thing", "this", "thought", "three",
            "thrive", "throw", "thumb", "thunder", "ticket", "tide", "tiger", "tilt", "timber",
            "time", "tiny", "tip", "tired", "tissue", "title", "toast", "tobacco", "today",
            "toddler", "toe", "together", "toilet", "token", "tomato", "tomorrow", "tone",
            "tongue", "tonight", "tool", "tooth", "top", "topic", "topple", "torch", "tornado",
            "tortoise", "toss", "total", "tourist", "toward", "tower", "town", "toy", "track",
            "trade", "traffic", "tragic", "train", "transfer", "trap", "trash", "travel",
            "tray", "treat", "tree", "trend", "trial", "tribe", "trick", "trigger", "trim",
            "trip", "trophy", "trouble", "truck", "true", "truly", "trumpet", "trust", "truth",
            "try", "tube", "tuition", "tumble", "tuna", "tunnel", "turkey", "turn", "turtle",
            "twelve", "twenty", "twice", "twin", "twist", "two", "type", "typical", "ugly",
            "umbrella", "unable", "unaware", "uncle", "uncover", "under", "undo", "unfair",
            "unfold", "unhappy", "uniform", "unique", "unit", "universe", "unknown", "unlock",
            "until", "unusual", "unveil", "update", "upgrade", "uphold", "upon", "upper",
            "upset", "urban", "urge", "usage", "use", "used", "useful", "useless", "usual",
            "utility", "vacant", "vacuum", "vague", "valid", "valley", "valve", "van",
            "vanish", "vapor", "various", "vast", "vault", "vehicle", "velvet", "vendor",
            "venture", "venue", "verb", "verify", "version", "very", "vessel", "veteran",
            "viable", "vibrant", "vicious", "victory", "video", "view", "village", "vintage",
            "violin", "virtual", "virus", "visa", "visit", "visual", "vital", "vivid", "vocal",
            "voice", "void", "volcano", "volume", "vote", "voyage", "wage", "wagon", "wait",
            "walk", "wall", "walnut", "want", "warfare", "warm", "warrior", "wash", "wasp",
            "waste", "water", "wave", "way", "wealth", "weapon", "wear", "weasel", "weather",
            "web", "wedding", "weekend", "weird", "welcome", "west", "wet", "whale", "what",
            "wheat", "wheel", "when", "where", "whip", "whisper", "wide", "width", "wife",
            "wild", "will", "win", "window", "wine", "wing", "wink", "winner", "winter",
            "wire", "wisdom", "wise", "wish", "witness", "wolf", "woman", "wonder", "wood",
            "wool", "word", "work", "world", "worry", "worth", "wrap", "wreck", "wrestle",
            "wrist", "write", "wrong", "yard", "year", "yellow", "you", "young", "youth",
            "zebra", "zero", "zone", "zoo"
        ];

        const WEAK_WORDS = ['password', 'bitcoin', 'wallet', 'money', 'crypto', 'blockchain', 'test', '123'];

        // Global state
        let currentSeed = '';
        let currentSeedWords = [];
        let securityScore = 0;
        let backupWords = [];
        let selectedBackupWords = [];

        // Level switching
        function switchLevel(level) {
            document.body.className = `level-${level}`;
            document.querySelectorAll('.level-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
        }

        // Tab switching
        function switchTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        // Security score management
        function updateSecurityScore(points) {
            securityScore = Math.max(0, Math.min(100, securityScore + points));
            document.getElementById('securityScore').textContent = securityScore;
        }

        // TRUE CRYPTOGRAPHIC RANDOMNESS using Web Crypto API
        function getSecureRandomInt(max) {
            const array = new Uint32Array(1);
            window.crypto.getRandomValues(array);
            return array[0] % max;
        }

        // Secure Fisher-Yates shuffle using Web Crypto API
        function secureshuffle(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = getSecureRandomInt(i + 1);
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }

        function generateSecureSeed() {
            const length = parseInt(document.getElementById('seedLength').value);
            const seed = [];

            // Use Web Crypto API for true randomness
            for (let i = 0; i < length; i++) {
                const randomIndex = getSecureRandomInt(BIP39_WORDLIST.length);
                seed.push(BIP39_WORDLIST[randomIndex]);
            }

            currentSeed = seed.join(' ');
            currentSeedWords = seed;
            displaySeedWithHighlight(currentSeed);
            enableButtons();
            showSecurityAnalysis(true);
            updateEntropy(100);
            updateSecurityScore(20);
        }

        function generateWeakSeed() {
            const length = parseInt(document.getElementById('seedLength').value);
            const seed = [];

            // Intentionally weak for demonstration
            for (let i = 0; i < length; i++) {
                if (i < WEAK_WORDS.length) {
                    seed.push(WEAK_WORDS[i]);
                } else {
                    seed.push(BIP39_WORDLIST[i % 20]);
                }
            }

            currentSeed = seed.join(' ');
            currentSeedWords = seed;
            displaySeedWithHighlight(currentSeed);
            enableButtons();
            showSecurityAnalysis(false);
            updateEntropy(15);
            updateSecurityScore(-10);
        }

        function enableButtons() {
            document.getElementById('generateBtn').disabled = false;
            document.getElementById('multipleBtn').disabled = false;
            document.getElementById('startBackupBtn').disabled = false;
        }

        function displaySeedWithHighlight(seed) {
            const words = seed.split(' ');
            const seedDisplay = document.getElementById('seedDisplay');

            seedDisplay.innerHTML = words.map((word, index) =>
                `<span class="seed-word">${index + 1}. ${word}</span>`
            ).join('');
        }

        function updateEntropy(level) {
            const entropyFill = document.getElementById('entropyFill');
            const entropyText = document.getElementById('entropyText');

            entropyFill.style.width = level + '%';

            if (level < 30) {
                entropyFill.style.background = '#F44336';
                entropyText.textContent = 'Very Low - Easily crackable!';
            } else if (level < 60) {
                entropyFill.style.background = '#FF9800';
                entropyText.textContent = 'Low - Vulnerable to attacks';
            } else if (level < 80) {
                entropyFill.style.background = '#FFC107';
                entropyText.textContent = 'Medium - Use only for testing';
            } else {
                entropyFill.style.background = '#4CAF50';
                entropyText.textContent = 'High - Cryptographically secure (Web Crypto API)';
            }
        }

        function showSecurityAnalysis(isSecure) {
            const securityDiv = document.getElementById('seedSecurity');

            if (isSecure) {
                securityDiv.innerHTML = `
                    <div class="security-level level-green">üü¢ SECURE: Cryptographically random seed</div>
                    <ul style="margin-top: 0.5rem; line-height: 1.8;">
                        <li>‚úÖ Generated using Web Crypto API</li>
                        <li>‚úÖ Uses BIP39 wordlist (2048 words)</li>
                        <li>‚úÖ Truly unpredictable entropy source</li>
                        <li>‚ö†Ô∏è This is educational - don't use for real funds!</li>
                    </ul>
                `;
            } else {
                securityDiv.innerHTML = `
                    <div class="security-level level-red">üî¥ INSECURE: Weak seed detected!</div>
                    <ul style="margin-top: 0.5rem; line-height: 1.8;">
                        <li>‚ùå Contains predictable words</li>
                        <li>‚ùå Low entropy - vulnerable to dictionary attacks</li>
                        <li>‚ùå Could be cracked in seconds/minutes</li>
                        <li>‚ùå NEVER use predictable words in real wallets!</li>
                    </ul>
                `;
            }
        }

        function showEntropySource() {
            alert('Entropy Source:\n\nThis demo uses the Web Crypto API (window.crypto.getRandomValues()) which provides cryptographically secure random numbers.\n\nUnlike Math.random() which is predictable, Web Crypto API uses the operating system\'s secure random number generator (CSRNG).\n\nFor real Bitcoin wallets, hardware wallets use specialized hardware RNGs for even more security.');
        }

        // Address generation with simulated BIP32 derivation
        function simpleHash(input) {
            let hash = 0;
            for (let i = 0; i < input.length; i++) {
                const char = input.charCodeAt(i);
                hash = ((hash << 5) - hash) + char;
                hash = hash & hash;
            }

            const chars = '123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz';
            let result = '';
            let num = Math.abs(hash);

            for (let i = 0; i < 64; i++) {
                result += chars[num % chars.length];
                num = Math.floor(num / chars.length) + i * 7;
            }

            return result;
        }

        function generateAddress() {
            if (!currentSeed) return;

            const addressType = document.getElementById('addressType').value;
            const passphrase = document.getElementById('passphrase') ? document.getElementById('passphrase').value : '';
            const index = document.getElementById('addressIndex') ? parseInt(document.getElementById('addressIndex').value) : 0;

            const seedWithPassphrase = currentSeed + (passphrase ? ' ' + passphrase : '');
            const hash = simpleHash(seedWithPassphrase + addressType + index);

            let address, prefix, path;
            switch (addressType) {
                case 'legacy':
                    prefix = '1';
                    path = `m/44'/0'/0'/0/${index}`;
                    break;
                case 'segwit':
                    prefix = '3';
                    path = `m/49'/0'/0'/0/${index}`;
                    break;
                case 'native':
                    prefix = 'bc1';
                    path = `m/84'/0'/0'/0/${index}`;
                    break;
            }

            address = prefix + hash.substring(0, addressType === 'native' ? 39 : 33);

            document.getElementById('addressText').textContent = address;
            document.getElementById('derivationPath').textContent = path;
            document.getElementById('addressDisplay').style.display = 'block';

            generateQRCode(address);
            updateSecurityScore(5);
        }

        function generateMultipleAddresses() {
            if (!currentSeed) return;

            const addressType = document.getElementById('addressType').value;
            const addresses = [];

            for (let i = 0; i < 5; i++) {
                const hash = simpleHash(currentSeed + addressType + i);
                let prefix, path;

                switch (addressType) {
                    case 'legacy':
                        prefix = '1';
                        path = `m/44'/0'/0'/0/${i}`;
                        break;
                    case 'segwit':
                        prefix = '3';
                        path = `m/49'/0'/0'/0/${i}`;
                        break;
                    case 'native':
                        prefix = 'bc1';
                        path = `m/84'/0'/0'/0/${i}`;
                        break;
                }

                const address = prefix + hash.substring(0, addressType === 'native' ? 39 : 33);
                addresses.push({ address, path, index: i });
            }

            displayMultipleAddresses(addresses);
        }

        function displayMultipleAddresses(addresses) {
            const container = document.getElementById('multipleAddresses');
            const list = document.getElementById('addressList');

            list.innerHTML = addresses.map(addr => `
                <div style="margin: 1rem 0; padding: 1rem; background: rgba(255,255,255,0.05); border-radius: 8px; border: 1px solid var(--border-color);">
                    <strong>Address ${addr.index}:</strong><br>
                    <code style="font-size: 0.85rem; word-break: break-all;">${addr.address}</code><br>
                    <small style="color: var(--text-dim);">Path: ${addr.path}</small>
                </div>
            `).join('');

            container.style.display = 'block';
        }

        function generateQRCode(text) {
            const canvas = document.getElementById('qrCode');
            const container = document.getElementById('qrContainer');

            if (typeof QRCode !== 'undefined') {
                QRCode.toCanvas(canvas, text, {
                    width: 200,
                    margin: 2,
                    color: { dark: '#000000', light: '#FFFFFF' }
                }, function (error) {
                    if (error) console.error(error);
                });
            }

            container.style.display = 'block';
        }

        function useCustomPath() {
            alert('Custom derivation paths allow you to explore different address spaces.\n\nWarning: Non-standard paths may not be recoverable in other wallets. Always use standard BIP44/49/84 paths for real funds.');
        }

        // Backup practice
        let seedBlurred = false;

        function toggleBlur() {
            const seedDisplay = document.getElementById('seedForBackup');
            const icon = document.getElementById('blurToggleIcon');
            const text = document.getElementById('blurToggleText');

            seedBlurred = !seedBlurred;

            if (seedBlurred) {
                seedDisplay.classList.add('blurred');
                icon.textContent = 'üëÅÔ∏è';
                text.textContent = 'Show Seed';
            } else {
                seedDisplay.classList.remove('blurred');
                icon.textContent = 'üôà';
                text.textContent = 'Hide Seed (Practice Mode)';
            }
        }

        function startBackupPractice() {
            if (!currentSeed) return;

            backupWords = currentSeedWords;
            selectedBackupWords = [];
            seedBlurred = false; // Reset blur state

            document.getElementById('backupInstructions').style.display = 'none';
            document.getElementById('backupPractice').style.display = 'block';

            const seedDisplay = document.getElementById('seedForBackup');
            seedDisplay.classList.remove('blurred'); // Ensure not blurred on start
            seedDisplay.innerHTML =
                backupWords.map((word, index) =>
                    `<span class="seed-word">${index + 1}. ${word}</span>`
                ).join('');

            // Reset blur toggle button
            document.getElementById('blurToggleIcon').textContent = 'üôà';
            document.getElementById('blurToggleText').textContent = 'Hide Seed (Practice Mode)';

            const shuffled = secureshuffle(backupWords);
            const shuffledContainer = document.getElementById('shuffledWords');

            shuffledContainer.innerHTML = shuffled.map(word =>
                `<div class="backup-word" onclick="selectBackupWord('${word}')">${word}</div>`
            ).join('');

            updateSelectedWordsDisplay();
        }

        function selectBackupWord(word) {
            if (selectedBackupWords.length < backupWords.length) {
                selectedBackupWords.push(word);
                updateSelectedWordsDisplay();

                const wordElements = document.querySelectorAll('.backup-word');
                wordElements.forEach(el => {
                    if (el.textContent === word && !el.classList.contains('selected')) {
                        el.classList.add('selected');
                        el.onclick = null;
                        return;
                    }
                });

                if (selectedBackupWords.length === backupWords.length) {
                    document.getElementById('checkBackupBtn').disabled = false;
                }
            }
        }

        function updateSelectedWordsDisplay() {
            const container = document.getElementById('selectedWords');
            container.innerHTML = selectedBackupWords.map((word, index) =>
                `<div class="backup-word selected">${index + 1}. ${word}</div>`
            ).join('');
        }

        function checkBackup() {
            const isCorrect = selectedBackupWords.every((word, index) => word === backupWords[index]);
            const resultDiv = document.getElementById('backupResult');

            if (isCorrect) {
                resultDiv.innerHTML = `
                    <div class="security-level level-green">
                        <strong>üü¢ PERFECT! Backup verified correctly!</strong>
                    </div>
                    <p style="margin-top: 1rem; line-height: 1.6;">
                        You've successfully verified your seed phrase. In a real scenario, store this written backup in a secure location (safe, safety deposit box, metal backup, etc.).
                    </p>
                    <div style="margin-top: 1rem; padding: 1rem; background: rgba(76, 175, 80, 0.1); border-left: 3px solid var(--accent-green); border-radius: 0.5rem; font-size: 0.95rem;">
                        <strong>üí° Good to know:</strong> Different wallets use different verification methods. Some ask you to click words in order (like this), others ask for specific word positions (e.g., "What's word #3 and #7?"), and some let you type them in. The goal is always the same: prove you wrote down your backup correctly.
                    </div>
                `;
                updateSecurityScore(25);
            } else {
                // Find which positions are wrong
                const wrongPositions = [];
                selectedBackupWords.forEach((word, index) => {
                    if (word !== backupWords[index]) {
                        wrongPositions.push(index + 1);
                    }
                });

                resultDiv.innerHTML = `
                    <div class="security-level level-red">
                        <strong>üî¥ Incorrect order! Try again.</strong>
                    </div>
                    <p style="margin-top: 1rem; line-height: 1.6;">
                        ${wrongPositions.length === backupWords.length
                            ? 'The words you selected are not in the correct order.'
                            : `Position${wrongPositions.length > 1 ? 's' : ''} ${wrongPositions.join(', ')} ${wrongPositions.length > 1 ? 'are' : 'is'} incorrect.`}
                        <strong>Order matters!</strong> Each word must be in the exact position you wrote it down.
                    </p>
                    <div style="margin-top: 1rem; padding: 1rem; background: rgba(255, 152, 0, 0.1); border-left: 3px solid #ff9800; border-radius: 0.5rem; font-size: 0.95rem;">
                        <strong>üìö About Wallet Verification:</strong>
                        <p style="margin-top: 0.5rem; line-height: 1.6;">
                            Different wallets verify backups in different ways:
                        </p>
                        <ul style="margin-top: 0.5rem; margin-left: 1.5rem; line-height: 1.8;">
                            <li><strong>Click in order</strong> (like this demo) - Click all words sequentially</li>
                            <li><strong>Specific positions</strong> - "Enter word #3, #7, and #12"</li>
                            <li><strong>Type all words</strong> - Manually type the entire phrase</li>
                            <li><strong>Random selection</strong> - Wallet randomly asks for 4-6 words</li>
                        </ul>
                        <p style="margin-top: 0.75rem; font-style: italic; color: var(--text-dim);">
                            All methods test the same thing: Did you write it down correctly and can you read your own handwriting?
                        </p>
                    </div>
                    <p style="margin-top: 1rem; color: var(--text-light);">
                        Click <strong>Reset</strong> below to try again, or use the <strong>Hide Seed</strong> button above to practice for real!
                    </p>
                `;
                updateSecurityScore(-5);
            }
        }

        function resetBackup() {
            selectedBackupWords = [];
            document.getElementById('checkBackupBtn').disabled = true;
            document.getElementById('backupResult').innerHTML = '';

            const wordElements = document.querySelectorAll('.backup-word');
            wordElements.forEach((el, index) => {
                el.classList.remove('selected');
                if (index < backupWords.length) {
                    const word = el.textContent;
                    el.onclick = () => selectBackupWord(word);
                }
            });

            updateSelectedWordsDisplay();
        }

        // Initialize from URL parameters
        const urlParams = new URLSearchParams(window.location.search);
        const levelParam = urlParams.get('level');
        if (levelParam && ['beginner', 'intermediate', 'advanced'].includes(levelParam)) {
            document.body.className = `level-${levelParam}`;
            document.querySelectorAll('.level-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.textContent.toLowerCase().includes(levelParam)) {
                    btn.classList.add('active');
                }
            });
        }

        // Initialize score
        updateSecurityScore(0);

        console.log('üîê Wallet Security Workshop initialized');
        console.log('‚úÖ Using Web Crypto API for true randomness');
        console.log('‚ö†Ô∏è Educational tool only - never use for real funds!');
    </script>

    <!-- Animated Icon Library -->
    <script src="/js/icon-library.js"></script>
    <script>
        // Inject icons after DOM loads
        document.addEventListener('DOMContentLoaded', function() {
            if (window.IconLibrary) {
                document.querySelectorAll('[data-icon]').forEach(function(element) {
                    var iconName = element.getAttribute('data-icon');
                    if (iconName) {
                        var iconHTML = IconLibrary.get(iconName, 20, true);
                        var span = document.createElement('span');
                        span.innerHTML = iconHTML;
                        span.className = 'icon-inline';
                        span.style.marginRight = '0.5rem';
                        span.style.display = 'inline-block';
                        span.style.verticalAlign = 'middle';
                        element.insertBefore(span, element.firstChild);
                    }
                });
            }
        });
    </script>
</body>
</html>
