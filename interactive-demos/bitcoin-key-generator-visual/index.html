<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bitcoin Key Generator â€” Visual Learning</title>
<link rel="stylesheet" href="/css/brand.css">
<style>
/* â”€â”€ base â”€â”€ */
:root {
    --orange: #f7931a;
    --dark:   #1a1a1a;
    --surf:   #2d2d2d;
    --surf2:  #383838;
    --text:   #e0e0e0;
    --dim:    #999;
    --purple: #7c5cff;
    --green:  #28c76f;
    --red:    #ea5455;
    --blue:   #00b0ff;
}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;
     background:var(--dark);color:var(--text);min-height:100vh;line-height:1.6}
.wrap{max-width:1100px;margin:0 auto;padding:1.5rem}
a{color:var(--orange);text-decoration:none}
code,pre,.mono{font-family:'Courier New',Courier,monospace}
button:focus-visible,a:focus-visible{outline:3px solid var(--orange);outline-offset:2px}
@media(prefers-reduced-motion:reduce){*,*::before,*::after{animation-duration:.01ms!important;transition-duration:.01ms!important}}

/* â”€â”€ header â”€â”€ */
.hdr{text-align:center;padding:1.5rem 1rem 1rem;background:linear-gradient(135deg,rgba(247,147,26,.12),rgba(124,92,255,.12));border-radius:14px;margin-bottom:1.5rem}
.hdr h1{color:var(--orange);font-size:clamp(1.5rem,4vw,2.2rem);margin-bottom:.4rem}
.hdr p{color:var(--dim);font-size:.95rem}

/* â”€â”€ FLOW DIAGRAM â”€â”€ */
.flow-panel{background:var(--surf);border:2px solid rgba(124,92,255,.4);border-radius:14px;padding:1.5rem;margin-bottom:1.5rem}
.flow-panel h2{color:var(--purple);font-size:1rem;text-transform:uppercase;letter-spacing:.08em;margin-bottom:1.2rem;display:flex;align-items:center;gap:.5rem}
.flow-chain{display:flex;flex-wrap:wrap;align-items:center;gap:.4rem}
.flow-node{background:var(--surf2);border:2px solid rgba(124,92,255,.5);border-radius:10px;padding:.6rem .9rem;min-width:130px;transition:border-color .3s,box-shadow .3s}
.flow-node.active{border-color:var(--orange);box-shadow:0 0 14px rgba(247,147,26,.3)}
.flow-node .fn-label{font-size:.68rem;color:var(--dim);text-transform:uppercase;letter-spacing:.06em}
.flow-node .fn-value{font-size:.72rem;color:var(--text);word-break:break-all;font-family:'Courier New',monospace;margin-top:.2rem;min-height:1rem;transition:color .4s}
.flow-node .fn-value.changed{color:var(--orange)}
.flow-arrow{color:var(--purple);font-size:1.3rem;flex-shrink:0}
.flow-arrow.down{display:block;width:100%;text-align:center;font-size:1rem;color:var(--purple);margin:.2rem 0}
.flow-row{display:flex;flex-wrap:wrap;align-items:center;gap:.4rem;width:100%;margin:.3rem 0}

/* â”€â”€ spinner â”€â”€ */
.spin-wrap{text-align:center;padding:1rem;display:none}
.spin-wrap.show{display:block}
.spinner{display:inline-block;width:28px;height:28px;border:3px solid rgba(247,147,26,.2);border-top-color:var(--orange);border-radius:50%;animation:spin .7s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}
.spin-label{color:var(--orange);font-size:.85rem;margin-top:.5rem}

/* â”€â”€ accordion â”€â”€ */
.accordion{margin-bottom:1rem}
details.step{background:var(--surf);border:2px solid rgba(124,92,255,.3);border-radius:12px;overflow:hidden;transition:border-color .3s}
details.step[open]{border-color:var(--orange)}
details.step>summary{display:flex;align-items:center;gap:.75rem;padding:1rem 1.25rem;cursor:pointer;list-style:none;user-select:none;transition:background .2s}
details.step>summary::-webkit-details-marker{display:none}
details.step>summary:hover{background:rgba(247,147,26,.06)}
.step-badge{background:var(--orange);color:#fff;width:32px;height:32px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:.95rem;flex-shrink:0}
.step-title{font-size:1.05rem;font-weight:600;flex:1}
.step-pill{font-size:.7rem;background:rgba(124,92,255,.2);color:var(--purple);padding:.2rem .6rem;border-radius:20px;margin-left:.5rem}
.step-chevron{color:var(--dim);font-size:1.2rem;transition:transform .3s;margin-left:auto}
details.step[open] .step-chevron{transform:rotate(90deg)}
.step-body{padding:0 1.25rem 1.25rem}

/* â”€â”€ bit grid â”€â”€ */
.bit-grid-wrap{display:flex;justify-content:center;margin:1rem 0}
.bit-grid{display:grid;grid-template-columns:repeat(16,1fr);gap:3px;max-width:520px;width:100%;background:rgba(0,0,0,.5);padding:10px;border-radius:10px;border:2px solid rgba(124,92,255,.4)}
.bc{aspect-ratio:1;background:#333;border:1px solid #555;border-radius:2px;display:flex;align-items:center;justify-content:center;font-size:.55rem;font-weight:700;cursor:pointer;transition:background .15s,transform .1s;user-select:none}
.bc.one{background:var(--orange);color:#fff;border-color:#c96f0a}
.bc.zero{background:#222;color:#555}
.bc:hover{transform:scale(1.25);z-index:5;border-color:var(--orange)}

/* â”€â”€ entropy slider â”€â”€ */
.entropy-slider-wrap{display:flex;align-items:center;gap:1rem;margin:1rem 0;flex-wrap:wrap}
.entropy-slider-wrap label{font-size:.85rem;color:var(--dim);white-space:nowrap}
#entropy-slider{flex:1;min-width:180px;accent-color:var(--orange)}
.entropy-hex{background:rgba(0,0,0,.4);border:1.5px solid rgba(124,92,255,.4);border-radius:8px;padding:.7rem 1rem;font-family:monospace;font-size:.75rem;word-break:break-all;margin-top:.5rem;line-height:1.6;min-height:2.5rem;transition:background .3s}
.entropy-hex.flash{background:rgba(247,147,26,.12)}
.bit-stats{display:grid;grid-template-columns:repeat(4,1fr);gap:.75rem;margin:.75rem 0}
.bs-box{background:rgba(124,92,255,.1);border:1.5px solid rgba(124,92,255,.3);border-radius:8px;padding:.6rem;text-align:center}
.bs-val{color:var(--orange);font-size:1.3rem;font-weight:700}
.bs-lbl{color:var(--dim);font-size:.7rem;margin-top:.15rem}

/* â”€â”€ key displays â”€â”€ */
.kd{background:rgba(0,0,0,.4);border:1.5px solid rgba(124,92,255,.35);border-radius:8px;padding:.9rem 1rem;margin:.6rem 0}
.kd-label{color:var(--purple);font-size:.78rem;font-weight:600;margin-bottom:.35rem;display:flex;align-items:center;gap:.5rem}
.kd-value{color:var(--text);font-size:.75rem;word-break:break-all;font-family:monospace;line-height:1.5}
.kd-value.hi{color:var(--orange);font-size:.85rem}
.kd-value.placeholder{color:var(--dim);font-style:italic}
.copy-btn{background:rgba(0,176,255,.15);color:var(--blue);border:1px solid rgba(0,176,255,.4);padding:.2rem .55rem;border-radius:4px;font-size:.72rem;cursor:pointer;transition:all .2s;margin-left:auto}
.copy-btn:hover{background:rgba(0,176,255,.28)}
.copy-btn.ok{background:rgba(40,199,111,.15);color:var(--green);border-color:var(--green)}

/* â”€â”€ mnemonic grid â”€â”€ */
.mnemonic-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(110px,1fr));gap:.6rem;margin:.75rem 0}
.mw{background:rgba(124,92,255,.15);border:1.5px solid rgba(124,92,255,.35);border-radius:8px;padding:.65rem .5rem;text-align:center}
.mw-n{color:var(--dim);font-size:.65rem}
.mw-w{color:var(--text);font-weight:600;font-size:.9rem}

/* â”€â”€ HD address table â”€â”€ */
.hd-table{width:100%;border-collapse:collapse;font-size:.75rem;margin:.75rem 0}
.hd-table th{background:rgba(124,92,255,.2);color:var(--purple);padding:.5rem .7rem;text-align:left;font-size:.68rem;text-transform:uppercase}
.hd-table td{padding:.5rem .7rem;border-bottom:1px solid rgba(255,255,255,.06);word-break:break-all;font-family:monospace;vertical-align:top}
.hd-table tr:hover td{background:rgba(247,147,26,.05)}
.hd-table .path-col{color:var(--orange);white-space:nowrap;font-family:monospace}
.hd-table .addr-col{color:var(--green)}

/* â”€â”€ tabs â”€â”€ */
.tabs{display:flex;gap:.5rem;margin-bottom:.75rem;flex-wrap:wrap}
.tab-btn{background:rgba(0,0,0,.3);border:1.5px solid rgba(124,92,255,.3);color:var(--dim);padding:.4rem 1rem;border-radius:20px;font-size:.82rem;cursor:pointer;transition:all .2s}
.tab-btn.active{background:rgba(124,92,255,.2);border-color:var(--purple);color:var(--text)}
.tab-pane{display:none}
.tab-pane.active{display:block}

/* â”€â”€ curve canvas â”€â”€ */
.curve-wrap{text-align:center;margin:.75rem 0}
#curve-canvas{background:#111;border:2px solid rgba(124,92,255,.4);border-radius:8px;max-width:100%;height:220px}

/* â”€â”€ info box â”€â”€ */
.info{background:rgba(124,92,255,.07);border-left:3px solid var(--purple);border-radius:4px;padding:.75rem 1rem;margin:.6rem 0;font-size:.85rem}
.info h4{color:var(--purple);margin-bottom:.35rem}
.info ul{margin-left:1.2rem}
.warn{background:rgba(234,84,85,.08);border-left:3px solid var(--red);border-radius:4px;padding:.75rem 1rem;margin:.6rem 0;font-size:.85rem}
.warn h4{color:var(--red);margin-bottom:.3rem}

/* â”€â”€ buttons â”€â”€ */
.btn{background:var(--orange);color:#fff;padding:.65rem 1.4rem;border:none;border-radius:8px;font-weight:700;cursor:pointer;transition:all .2s;font-size:.9rem;margin:.25rem}
.btn:hover{filter:brightness(1.1);transform:translateY(-1px)}
.btn-sec{background:var(--purple)}
.btn-sml{padding:.4rem .9rem;font-size:.78rem}
.btn-row{display:flex;flex-wrap:wrap;gap:.25rem;margin:.6rem 0}

/* â”€â”€ toast â”€â”€ */
.toast{position:fixed;top:18px;right:18px;background:#28c76f;color:#fff;padding:.75rem 1.25rem;border-radius:8px;box-shadow:0 4px 16px rgba(0,0,0,.4);font-size:.88rem;z-index:9999;display:none}
.toast.show{display:block;animation:fadeIn .25s ease}
@keyframes fadeIn{from{opacity:0;transform:translateX(30px)}to{opacity:1;transform:none}}

/* â”€â”€ error banner â”€â”€ */
.err-bar{background:rgba(234,84,85,.15);border:1.5px solid var(--red);border-radius:8px;padding:.75rem 1rem;color:var(--red);font-size:.85rem;display:none;margin:.75rem 0}
.err-bar.show{display:block}

/* â”€â”€ hashing playground â”€â”€ */
.hash-playground{background:rgba(0,0,0,.25);border-radius:8px;padding:1rem;margin:.75rem 0}
.hash-playground input{width:100%;padding:.6rem .8rem;background:rgba(0,0,0,.4);border:1.5px solid rgba(124,92,255,.4);border-radius:6px;color:var(--text);font-size:.9rem}
.hash-result{font-family:monospace;font-size:.78rem;word-break:break-all;color:var(--green);padding:.6rem;background:rgba(0,0,0,.3);border-radius:6px;margin-top:.6rem;display:none}

/* â”€â”€ responsive â”€â”€ */
@media(max-width:640px){
    .bit-grid{grid-template-columns:repeat(16,1fr);gap:2px;padding:5px}
    .bc{font-size:.45rem}
    .bit-stats{grid-template-columns:repeat(2,1fr)}
    .hd-table{font-size:.68rem}
    .flow-chain{flex-direction:column;align-items:flex-start}
}
</style>
</head>
<body>
<div class="wrap">

<!-- â”€â”€ HEADER â”€â”€ -->
<div class="hdr">
    <h1>ğŸ”‘ Bitcoin Key Generator</h1>
    <p>Real cryptography, live and reactive â€” change one bit, watch everything cascade</p>
</div>

<!-- â”€â”€ ERROR BAR â”€â”€ -->
<div class="err-bar" id="err-bar">âš  <span id="err-msg"></span></div>

<!-- â”€â”€ FLOW DIAGRAM â”€â”€ -->
<div class="flow-panel">
    <h2>ğŸ”— Relationship Map â€” how everything connects</h2>
    <div class="flow-chain">

        <div class="flow-row">
            <div class="flow-node" id="fn-entropy">
                <div class="fn-label">ğŸ² Entropy</div>
                <div class="fn-value placeholder" id="fv-entropy">â€”</div>
            </div>
            <div class="flow-arrow">â†’</div>
            <div class="flow-node" id="fn-priv">
                <div class="fn-label">ğŸ” Private Key (hex)</div>
                <div class="fn-value placeholder" id="fv-priv">â€”</div>
            </div>
            <div class="flow-arrow">â†’</div>
            <div class="flow-node" id="fn-mnemonic">
                <div class="fn-label">ğŸ“ Mnemonic</div>
                <div class="fn-value placeholder" id="fv-mnemonic">â€”</div>
            </div>
        </div>

        <div class="flow-arrow down">â†“ PBKDF2 (2048 iter)</div>

        <div class="flow-row">
            <div class="flow-node" id="fn-seed">
                <div class="fn-label">ğŸŒ± 512-bit Seed</div>
                <div class="fn-value placeholder" id="fv-seed">â€”</div>
            </div>
            <div class="flow-arrow">â†’</div>
            <div class="flow-node" id="fn-master">
                <div class="fn-label">ğŸ”‘ Master Key (BIP32)</div>
                <div class="fn-value placeholder" id="fv-master">â€”</div>
            </div>
            <div class="flow-arrow">â†’</div>
            <div class="flow-node" id="fn-pub">
                <div class="fn-label">ğŸ”“ Public Key</div>
                <div class="fn-value placeholder" id="fv-pub">â€”</div>
            </div>
        </div>

        <div class="flow-arrow down">â†“ SHA-256 â†’ RIPEMD-160</div>

        <div class="flow-row">
            <div class="flow-node" id="fn-h160">
                <div class="fn-label">ğŸ”µ hash160</div>
                <div class="fn-value placeholder" id="fv-h160">â€”</div>
            </div>
            <div class="flow-arrow">â†’</div>
            <div class="flow-node" id="fn-legacy">
                <div class="fn-label">ğŸ“® Legacy (P2PKH)</div>
                <div class="fn-value placeholder" id="fv-legacy">â€”</div>
            </div>
            <div class="flow-arrow">&amp;</div>
            <div class="flow-node" id="fn-segwit">
                <div class="fn-label">âš¡ SegWit (bc1qâ€¦)</div>
                <div class="fn-value placeholder" id="fv-segwit">â€”</div>
            </div>
        </div>

        <div class="flow-arrow down">â†“ BIP32 child derivation (HD Wallet)</div>

        <div class="flow-row">
            <div class="flow-node" id="fn-hd">
                <div class="fn-label">ğŸŒ³ HD Addresses (5 shown)</div>
                <div class="fn-value placeholder" id="fv-hd">â€”</div>
            </div>
        </div>

    </div>

    <!-- Spinner -->
    <div class="spin-wrap" id="spinner">
        <div class="spinner"></div>
        <div class="spin-label">Computing secp256k1 Â· BIP32 Â· BIP39 â€¦</div>
    </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     STEP 1 â€” ENTROPY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="accordion">
<details class="step" id="step1" open>
<summary>
    <span class="step-badge">1</span>
    <span class="step-title">Entropy â€” your 256 random bits</span>
    <span class="step-pill">GENERATE HERE</span>
    <span class="step-chevron">â€º</span>
</summary>
<div class="step-body">

    <div class="info">
        <h4>What is entropy?</h4>
        <p>A Bitcoin private key is simply a <strong>very large random number</strong> â€” 256 ones and zeros chosen at random.
        There are 2Â²âµâ¶ possible combinations: more than atoms in the observable universe.
        <strong>Click any bit</strong> to flip it and watch every downstream value change instantly.</p>
    </div>

    <div class="btn-row">
        <button class="btn" onclick="randomize()">ğŸ² New Random Key</button>
        <button class="btn btn-sec" onclick="animateBits()">âœ¨ Animate Generation</button>
    </div>

    <div class="bit-grid-wrap"><div class="bit-grid" id="bit-grid"></div></div>

    <div class="bit-stats">
        <div class="bs-box"><div class="bs-val" id="stat-ones">0</div><div class="bs-lbl">Ones</div></div>
        <div class="bs-box"><div class="bs-val" id="stat-zeros">256</div><div class="bs-lbl">Zeros</div></div>
        <div class="bs-box"><div class="bs-val">256</div><div class="bs-lbl">Total bits</div></div>
        <div class="bs-box"><div class="bs-val" style="font-size:.9rem">2Â²âµâ¶</div><div class="bs-lbl">Possible keys</div></div>
    </div>

    <div class="kd">
        <div class="kd-label">ğŸ”¢ Binary (256 bits)</div>
        <div class="kd-value placeholder mono" id="kd-binary" style="line-height:1.8;font-size:.65rem;word-spacing:.15em">Generate to begin</div>
    </div>
    <div class="kd">
        <div class="kd-label">
            ğŸ”¤ Private Key â€” Hex (64 chars = 256 bits Ã· 4)
            <button class="copy-btn" onclick="copyEl('kd-hex',this)">Copy</button>
        </div>
        <div class="kd-value hi placeholder" id="kd-hex">â€”</div>
    </div>

    <div class="warn">
        <h4>âš ï¸ Security: what makes entropy safe?</h4>
        <ul style="margin-left:1.2rem">
            <li>Must be <strong>truly random</strong> â€” not your birthday, name, or any predictable pattern</li>
            <li>Generated by the operating system's cryptographic RNG (CSPRNG)</li>
            <li>Never stored digitally or photographed</li>
        </ul>
    </div>
</div>
</details>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     STEP 2 â€” MNEMONIC
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="accordion">
<details class="step" id="step2">
<summary>
    <span class="step-badge">2</span>
    <span class="step-title">BIP39 Mnemonic Seed Phrase</span>
    <span class="step-pill">12 WORDS</span>
    <span class="step-chevron">â€º</span>
</summary>
<div class="step-body">

    <div class="info">
        <h4>Entropy â†’ Words (BIP39)</h4>
        <ul>
            <li><strong>Step 1:</strong> Take your 128-bit entropy</li>
            <li><strong>Step 2:</strong> SHA-256 hash it; take first 4 bits as checksum</li>
            <li><strong>Step 3:</strong> Combine 128 + 4 = 132 bits</li>
            <li><strong>Step 4:</strong> Split into 12 groups of 11 bits â†’ each picks 1 of 2,048 words</li>
        </ul>
        <p style="margin-top:.5rem">The <strong>same entropy always produces the same words</strong>.
        Writing down 12 words is equivalent to writing down your private key â€” but far easier to verify.</p>
    </div>

    <div class="mnemonic-grid" id="mnemonic-grid">
        <div class="mw" style="opacity:.3;grid-column:1/-1;text-align:center;color:var(--dim)">Generate entropy firstâ€¦</div>
    </div>

    <div class="kd">
        <div class="kd-label">
            ğŸ“‹ Full phrase (copy to paper â€” never digital)
            <button class="copy-btn" onclick="copyEl('kd-phrase',this)">Copy</button>
        </div>
        <div class="kd-value placeholder" id="kd-phrase">â€”</div>
    </div>

    <div class="warn">
        <h4>âš ï¸ Anyone who has these 12 words controls your Bitcoin</h4>
        <p>Write on paper Â· Store in fireproof safe Â· Never type into a website Â· Never photograph</p>
    </div>
</div>
</details>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     STEP 3 â€” SEED & MASTER KEY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="accordion">
<details class="step" id="step3">
<summary>
    <span class="step-badge">3</span>
    <span class="step-title">Seed &amp; BIP32 Master Key</span>
    <span class="step-pill">BIP39 + BIP32</span>
    <span class="step-chevron">â€º</span>
</summary>
<div class="step-body">

    <div class="info">
        <h4>Words â†’ Seed â†’ Master Key</h4>
        <ul>
            <li><strong>PBKDF2</strong>: Your 12 words + passphrase "" are stretched through 2,048 rounds of HMAC-SHA-512</li>
            <li>Output: <strong>512-bit root seed</strong></li>
            <li><strong>HMAC-SHA-512</strong>(key="Bitcoin seed", data=seed) â†’ left 32 bytes = master private key Â· right 32 bytes = master chain code</li>
            <li>Chain code acts as entropy for all child key derivations</li>
        </ul>
    </div>

    <div class="kd">
        <div class="kd-label">
            ğŸŒ± 512-bit Seed (hex)
            <button class="copy-btn" onclick="copyEl('kd-seed',this)">Copy</button>
        </div>
        <div class="kd-value placeholder mono" id="kd-seed" style="font-size:.68rem">â€”</div>
    </div>
    <div class="kd">
        <div class="kd-label">
            ğŸ”‘ Master Private Key (BIP32)
            <button class="copy-btn" onclick="copyEl('kd-master-priv',this)">Copy</button>
        </div>
        <div class="kd-value hi placeholder" id="kd-master-priv">â€”</div>
    </div>
    <div class="kd">
        <div class="kd-label">
            ğŸ”— Master Chain Code
            <button class="copy-btn" onclick="copyEl('kd-master-chain',this)">Copy</button>
        </div>
        <div class="kd-value placeholder mono" id="kd-master-chain" style="font-size:.72rem">â€”</div>
    </div>
</div>
</details>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     STEP 4 â€” PUBLIC KEY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="accordion">
<details class="step" id="step4">
<summary>
    <span class="step-badge">4</span>
    <span class="step-title">Public Key via secp256k1</span>
    <span class="step-pill">ELLIPTIC CURVE</span>
    <span class="step-chevron">â€º</span>
</summary>
<div class="step-body">

    <div class="info">
        <h4>Private key Ã— G = Public key</h4>
        <p>Bitcoin uses <strong>secp256k1</strong>: the elliptic curve yÂ² = xÂ³ + 7 over a 256-bit prime field.</p>
        <ul style="margin-top:.4rem">
            <li><strong>G</strong> (generator point) is a fixed public constant</li>
            <li>Multiplying G by your private key k times gives the public key point (x, y)</li>
            <li>This is a <strong>one-way operation</strong>: given the public key, recovering k is computationally impossible</li>
        </ul>
        <p style="margin-top:.5rem;font-size:.8rem;color:var(--dim)">
            G.x = 79BE667EF9DCBBACâ€¦B16F81798<br>
            G.y = 483ADA7726A3C465â€¦B10D4B8
        </p>
    </div>

    <div class="curve-wrap">
        <canvas id="curve-canvas" width="600" height="220"></canvas>
        <p style="color:var(--dim);font-size:.75rem;margin-top:.4rem">yÂ² = xÂ³ + 7 over â„ (conceptual â€” actual computation is over ğ”½â‚š with p â‰ˆ 2Â²âµâ¶)</p>
    </div>

    <div class="kd">
        <div class="kd-label">
            ğŸ”“ Compressed Public Key (33 bytes)
            <button class="copy-btn" onclick="copyEl('kd-pub-comp',this)">Copy</button>
        </div>
        <div class="kd-value hi placeholder" id="kd-pub-comp">â€”</div>
    </div>
    <div class="kd">
        <div class="kd-label">
            ğŸ”“ Uncompressed Public Key (65 bytes = 04 + x + y)
            <button class="copy-btn" onclick="copyEl('kd-pub-unc',this)">Copy</button>
        </div>
        <div class="kd-value placeholder mono" id="kd-pub-unc" style="font-size:.68rem">â€”</div>
    </div>
    <div class="kd">
        <div class="kd-label">X coordinate</div>
        <div class="kd-value placeholder mono" id="kd-pub-x" style="font-size:.72rem">â€”</div>
    </div>
    <div class="kd">
        <div class="kd-label">Y coordinate</div>
        <div class="kd-value placeholder mono" id="kd-pub-y" style="font-size:.72rem">â€”</div>
    </div>
    <div class="kd">
        <div class="kd-label">
            ğŸ”µ hash160 = RIPEMD-160(SHA-256(pubkey))
            <button class="copy-btn" onclick="copyEl('kd-h160',this)">Copy</button>
        </div>
        <div class="kd-value placeholder mono" id="kd-h160" style="font-size:.72rem">â€”</div>
    </div>

    <!-- Hashing playground -->
    <details style="margin-top:1rem">
        <summary style="cursor:pointer;color:var(--purple);font-size:.88rem;padding:.4rem 0">ğŸ® Hash playground â€” try it yourself</summary>
        <div class="hash-playground" style="margin-top:.6rem">
            <p style="font-size:.83rem;margin-bottom:.5rem">Type anything and see SHA-256. Change one letter â€” the entire hash changes:</p>
            <div style="display:flex;gap:.5rem">
                <input type="text" id="hash-input" placeholder="Type somethingâ€¦" oninput="liveHash(this.value)">
            </div>
            <div class="hash-result" id="hash-result"></div>
        </div>
    </details>
</div>
</details>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     STEP 5 â€” ADDRESSES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="accordion">
<details class="step" id="step5">
<summary>
    <span class="step-badge">5</span>
    <span class="step-title">Bitcoin Addresses &amp; HD Wallet</span>
    <span class="step-pill">BIP44 Â· BIP84</span>
    <span class="step-chevron">â€º</span>
</summary>
<div class="step-body">

    <div class="info">
        <h4>Public key â†’ Address</h4>
        <ul>
            <li><strong>hash160</strong> = RIPEMD-160(SHA-256(compressed pubkey)) â†’ 20 bytes</li>
            <li><strong>Legacy P2PKH</strong>: 0x00 + hash160 â†’ double-SHA-256 checksum â†’ Base58Check â†’ starts with <code>1</code></li>
            <li><strong>Native SegWit P2WPKH</strong>: Bech32(witness v0, hash160) â†’ starts with <code>bc1q</code></li>
        </ul>
    </div>

    <!-- Single-key addresses -->
    <h3 style="color:var(--orange);font-size:.9rem;margin:.75rem 0 .35rem">From this entropy's private key directly:</h3>
    <div class="kd">
        <div class="kd-label">
            ğŸ“® Legacy P2PKH (Base58Check)
            <button class="copy-btn" onclick="copyEl('kd-addr-legacy',this)">Copy</button>
        </div>
        <div class="kd-value hi placeholder" id="kd-addr-legacy">â€”</div>
    </div>
    <div class="kd">
        <div class="kd-label">
            âš¡ Native SegWit P2WPKH (Bech32)
            <button class="copy-btn" onclick="copyEl('kd-addr-segwit',this)">Copy</button>
        </div>
        <div class="kd-value hi placeholder" id="kd-addr-segwit">â€”</div>
    </div>

    <!-- HD addresses -->
    <h3 style="color:var(--purple);font-size:.9rem;margin:1.1rem 0 .35rem">HD Wallet â€” from the BIP32 master key (BIP44 &amp; BIP84):</h3>

    <div class="info">
        <h4>One seed â†’ infinite addresses</h4>
        <p>Modern wallets derive a <strong>tree of child keys</strong> from the master key using HMAC-SHA-512.
        Each child has its own private key, public key, and address â€” but all are recoverable from your 12 words alone.</p>
        <p style="margin-top:.4rem">
            BIP44 path: <code>m/44'/0'/0'/0/i</code> â†’ Legacy<br>
            BIP84 path: <code>m/84'/0'/0'/0/i</code> â†’ Native SegWit
        </p>
    </div>

    <div class="tabs">
        <button class="tab-btn active" onclick="switchTab('legacy')">P2PKH Legacy (BIP44)</button>
        <button class="tab-btn" onclick="switchTab('segwit')">P2WPKH SegWit (BIP84)</button>
    </div>

    <div class="tab-pane active" id="tab-legacy">
        <table class="hd-table">
            <thead><tr><th>#</th><th>Path</th><th>Address (starts with 1)</th></tr></thead>
            <tbody id="hd-legacy-body">
                <tr><td colspan="3" style="color:var(--dim);text-align:center;padding:1rem">Generate entropy to deriveâ€¦</td></tr>
            </tbody>
        </table>
    </div>
    <div class="tab-pane" id="tab-segwit">
        <table class="hd-table">
            <thead><tr><th>#</th><th>Path</th><th>Address (bc1qâ€¦)</th></tr></thead>
            <tbody id="hd-segwit-body">
                <tr><td colspan="3" style="color:var(--dim);text-align:center;padding:1rem">Generate entropy to deriveâ€¦</td></tr>
            </tbody>
        </table>
    </div>

    <div class="warn" style="margin-top:1rem">
        <h4>âš ï¸ Security rules</h4>
        <ul style="margin-left:1.2rem">
            <li>Never share your private key or seed phrase with anyone</li>
            <li>Use a new address for every payment (privacy)</li>
            <li>In production wallets, Sparrow/Coldcard/Trezor handle all derivation automatically</li>
        </ul>
    </div>
</div>
</details>
</div>

<!-- bottom actions -->
<div style="text-align:center;margin:2rem 0;padding:1.5rem;background:rgba(247,147,26,.07);border-radius:10px">
    <p style="color:var(--dim);margin-bottom:.75rem">Every time you press "New Random Key", a fresh universe of keys unfolds</p>
    <button class="btn" onclick="randomize()">ğŸ² New Random Key</button>
    <button class="btn btn-sec" onclick="resetAll()">â†º Reset</button>
</div>

</div><!-- /wrap -->

<div class="toast" id="toast"></div>

<script src="bitcoin-crypto.js"></script>
<script>
/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   State
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
let bits = new Array(256).fill(0);
let updateTimer = null;
let animating  = false;
let lastResult = null;

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   Grid initialisation
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function initGrid() {
    const g = document.getElementById('bit-grid');
    g.innerHTML = '';
    for (let i = 0; i < 256; i++) {
        const c = document.createElement('div');
        c.className = 'bc zero';
        c.textContent = '0';
        c.addEventListener('click', () => { if (!animating) { bits[i] ^= 1; refreshCell(i); scheduleUpdate(); } });
        g.appendChild(c);
    }
}

function refreshCell(i) {
    const c = document.getElementById('bit-grid').children[i];
    c.className = bits[i] ? 'bc one' : 'bc zero';
    c.textContent = bits[i];
}

function refreshGrid() {
    const cells = document.getElementById('bit-grid').children;
    for (let i = 0; i < 256; i++) {
        cells[i].className = bits[i] ? 'bc one' : 'bc zero';
        cells[i].textContent = bits[i];
    }
    const ones = bits.filter(b => b).length;
    document.getElementById('stat-ones').textContent  = ones;
    document.getElementById('stat-zeros').textContent = 256 - ones;
    document.getElementById('kd-binary').textContent  = bits.join('');
    document.getElementById('kd-binary').classList.remove('placeholder');
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   Randomise
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function randomize() {
    const rand = new Uint8Array(32);
    crypto.getRandomValues(rand);
    for (let i = 0; i < 256; i++)
        bits[i] = (rand[i >> 3] >> (7 - (i & 7))) & 1;
    refreshGrid();
    scheduleUpdate();
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   Animated bit generation
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
async function animateBits() {
    if (animating) return;
    animating = true;
    const rand = new Uint8Array(32);
    crypto.getRandomValues(rand);
    for (let i = 0; i < 256; i++) {
        bits[i] = (rand[i >> 3] >> (7 - (i & 7))) & 1;
        refreshCell(i);
        if (i % 16 === 15) {
            // update stats periodically
            const ones = bits.slice(0, i+1).filter(b => b).length;
            document.getElementById('stat-ones').textContent  = ones;
            document.getElementById('stat-zeros').textContent = (i + 1) - ones;
            await delay(18);
        }
    }
    refreshGrid();
    animating = false;
    scheduleUpdate();
}

function delay(ms) { return new Promise(r => setTimeout(r, ms)); }

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   Debounced pipeline trigger
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function scheduleUpdate() {
    clearTimeout(updateTimer);
    updateTimer = setTimeout(runPipeline, 350);
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   Main cryptographic pipeline
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
async function runPipeline() {
    if (bits.every(b => b === 0)) return;

    setSpinner(true);
    setError('');

    try {
        const result = await window.BitcoinCrypto.generateFullKeychain(bits);
        lastResult = result;
        renderAll(result);
    } catch (e) {
        setError(e.message);
    } finally {
        setSpinner(false);
    }
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   Render all outputs
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function renderAll(r) {
    // flow diagram
    flashFlow('fv-entropy',  bits.slice(0,16).join('') + 'â€¦');
    flashFlow('fv-priv',     r.privKeyHex.slice(0,16) + 'â€¦');
    flashFlow('fv-mnemonic', r.mnemonic.slice(0,3).join(' ') + 'â€¦');
    flashFlow('fv-seed',     r.seedHex.slice(0,16) + 'â€¦');
    flashFlow('fv-master',   r.masterPrivHex.slice(0,16) + 'â€¦');
    flashFlow('fv-pub',      r.pubKey.compressed.slice(0,16) + 'â€¦');
    flashFlow('fv-h160',     r.h160Hex);
    flashFlow('fv-legacy',   r.legacySingle);
    flashFlow('fv-segwit',   r.segwitSingle);
    flashFlow('fv-hd',       r.hdLegacy[0].address + ' â€¦');

    // step 1
    set('kd-hex', r.privKeyHex);

    // step 2
    const grid = document.getElementById('mnemonic-grid');
    grid.innerHTML = r.mnemonic.map((w, i) =>
        `<div class="mw"><div class="mw-n">#${i+1}</div><div class="mw-w">${w}</div></div>`
    ).join('');
    set('kd-phrase', r.mnemonic.join(' '));

    // step 3
    set('kd-seed',         r.seedHex);
    set('kd-master-priv',  r.masterPrivHex);
    set('kd-master-chain', r.masterChainHex);

    // step 4
    set('kd-pub-comp', r.pubKey.compressed);
    set('kd-pub-unc',  r.pubKey.uncompressed);
    set('kd-pub-x',    r.pubKey.x);
    set('kd-pub-y',    r.pubKey.y);
    set('kd-h160',     r.h160Hex);
    drawCurve(r.pubKey);

    // step 5 â€” single addresses
    set('kd-addr-legacy', r.legacySingle);
    set('kd-addr-segwit', r.segwitSingle);

    // HD tables
    const legBody = document.getElementById('hd-legacy-body');
    legBody.innerHTML = r.hdLegacy.map((e, i) =>
        `<tr>
           <td>${i}</td>
           <td class="path-col">${e.path}</td>
           <td class="addr-col">${e.address}</td>
         </tr>`
    ).join('');

    const swBody = document.getElementById('hd-segwit-body');
    swBody.innerHTML = r.hdSegwit.map((e, i) =>
        `<tr>
           <td>${i}</td>
           <td class="path-col">${e.path}</td>
           <td class="addr-col">${e.address}</td>
         </tr>`
    ).join('');
}

function set(id, val) {
    const el = document.getElementById(id);
    if (!el) return;
    el.textContent = val;
    el.classList.remove('placeholder');
}

function flashFlow(id, val) {
    const el = document.getElementById(id);
    if (!el) return;
    el.textContent = val;
    el.classList.remove('placeholder', 'changed');
    void el.offsetWidth; // reflow
    el.classList.add('changed');
    setTimeout(() => el.classList.remove('changed'), 800);
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   Elliptic curve canvas
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function drawCurve(pubKey) {
    const canvas = document.getElementById('curve-canvas');
    const ctx    = canvas.getContext('2d');
    const W = canvas.width, H = canvas.height;
    const cx = W / 2, cy = H / 2;

    ctx.clearRect(0, 0, W, H);
    ctx.fillStyle = '#111';
    ctx.fillRect(0, 0, W, H);

    // axes
    ctx.strokeStyle = '#333'; ctx.lineWidth = 1; ctx.setLineDash([4,4]);
    ctx.beginPath(); ctx.moveTo(0,cy); ctx.lineTo(W,cy); ctx.stroke();
    ctx.beginPath(); ctx.moveTo(cx,0); ctx.lineTo(cx,H); ctx.stroke();
    ctx.setLineDash([]);

    // curve yÂ² = xÂ³ + 7
    const scale = 38;
    function drawHalf(sign) {
        ctx.beginPath();
        let first = true;
        for (let px = -cx; px < cx; px += 0.5) {
            const x = px / scale;
            const y2 = x**3 + 7;
            if (y2 < 0) { first = true; continue; }
            const py = sign * Math.sqrt(y2) * scale;
            first ? ctx.moveTo(cx + px, cy - py) : ctx.lineTo(cx + px, cy - py);
            first = false;
        }
        ctx.stroke();
    }
    ctx.strokeStyle = '#5a4fcf'; ctx.lineWidth = 2.5;
    drawHalf(1); drawHalf(-1);

    // generator point G (canonical position on curve)
    function dot(px, py, color, label, sub) {
        ctx.fillStyle = color;
        ctx.beginPath(); ctx.arc(px, py, 8, 0, Math.PI*2); ctx.fill();
        ctx.strokeStyle = '#fff'; ctx.lineWidth = 1.5; ctx.stroke();
        ctx.fillStyle = color; ctx.font = 'bold 13px sans-serif';
        ctx.fillText(label, px + 12, py + 4);
        if (sub) { ctx.font = '10px sans-serif'; ctx.fillText(sub, px + 12, py + 16); }
    }

    const gx = -2, gy = Math.sqrt(gx**3 + 7);
    const gPx = cx + gx * scale, gPy = cy - gy * scale;
    dot(gPx, gPy, '#f7931a', 'G', '(generator)');

    // public key â€” pick a deterministic display position from first bytes of pubkey
    const xFrac = parseInt(pubKey.x.slice(0, 8), 16) / 0xFFFFFFFF;
    const pkx   = -1.5 + xFrac * 3.5;
    const pky2  = pkx**3 + 7;
    if (pky2 >= 0) {
        const pky = (pubKey.y[63] % 2 === 1 ? -1 : 1) * Math.sqrt(pky2);
        const pkPx = cx + pkx * scale, pkPy = cy - pky * scale;
        dot(pkPx, pkPy, '#28c76f', 'K', '(public key)');
        // dashed line G â†’ K
        ctx.strokeStyle = '#f7931a'; ctx.lineWidth = 1.5; ctx.setLineDash([7,4]);
        ctx.beginPath(); ctx.moveTo(gPx, gPy); ctx.lineTo(pkPx, pkPy); ctx.stroke();
        ctx.setLineDash([]);
    }

    // label
    ctx.fillStyle = '#e0e0e0'; ctx.font = 'bold 13px sans-serif';
    ctx.fillText('yÂ² = xÂ³ + 7', 14, 22);
    ctx.fillStyle = '#888'; ctx.font = '11px sans-serif';
    ctx.fillText('K = k Â· G  (scalar multiplication)', cx - 90, H - 8);
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   Hashing playground
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
async function liveHash(text) {
    const el = document.getElementById('hash-result');
    if (!text) { el.style.display = 'none'; return; }
    const h = await window.BitcoinCrypto.hashText(text);
    el.textContent = h;
    el.style.display = 'block';
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   Tabs
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function switchTab(name) {
    document.querySelectorAll('.tab-btn').forEach((b,i) => {
        const match = (name === 'legacy' && i === 0) || (name === 'segwit' && i === 1);
        b.classList.toggle('active', match);
    });
    document.getElementById('tab-legacy').classList.toggle('active', name === 'legacy');
    document.getElementById('tab-segwit').classList.toggle('active', name === 'segwit');
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   Copy to clipboard
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function copyEl(id, btn) {
    const val = document.getElementById(id).textContent.trim();
    if (!val || val === 'â€”') return;
    navigator.clipboard.writeText(val).then(() => {
        showToast('Copied!');
        btn.textContent = 'âœ“ Copied'; btn.classList.add('ok');
        setTimeout(() => { btn.textContent = 'Copy'; btn.classList.remove('ok'); }, 2000);
    });
}

function showToast(msg) {
    const t = document.getElementById('toast');
    t.textContent = msg; t.classList.add('show');
    setTimeout(() => t.classList.remove('show'), 2500);
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   UI helpers
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function setSpinner(on) {
    document.getElementById('spinner').classList.toggle('show', on);
}
function setError(msg) {
    const b = document.getElementById('err-bar');
    if (msg) { document.getElementById('err-msg').textContent = msg; b.classList.add('show'); }
    else      { b.classList.remove('show'); }
}

function resetAll() {
    bits.fill(0);
    refreshGrid();
    document.getElementById('kd-binary').textContent = 'Generate to begin';
    document.getElementById('kd-binary').classList.add('placeholder');
    ['kd-hex','kd-phrase','kd-seed','kd-master-priv','kd-master-chain',
     'kd-pub-comp','kd-pub-unc','kd-pub-x','kd-pub-y','kd-h160',
     'kd-addr-legacy','kd-addr-segwit'].forEach(id => {
        const el = document.getElementById(id);
        if (el) { el.textContent = 'â€”'; el.classList.add('placeholder'); }
    });
    ['fv-entropy','fv-priv','fv-mnemonic','fv-seed','fv-master',
     'fv-pub','fv-h160','fv-legacy','fv-segwit','fv-hd'].forEach(id => {
        const el = document.getElementById(id);
        if (el) { el.textContent = 'â€”'; el.classList.add('placeholder'); }
    });
    document.getElementById('mnemonic-grid').innerHTML =
        '<div class="mw" style="opacity:.3;grid-column:1/-1;text-align:center;color:var(--dim)">Generate entropy firstâ€¦</div>';
    ['hd-legacy-body','hd-segwit-body'].forEach(id => {
        document.getElementById(id).innerHTML =
            '<tr><td colspan="3" style="color:var(--dim);text-align:center;padding:1rem">Generate entropy to deriveâ€¦</td></tr>';
    });
    const ctx = document.getElementById('curve-canvas').getContext('2d');
    ctx.clearRect(0, 0, 600, 220);
    setError('');
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   Boot
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
window.addEventListener('DOMContentLoaded', () => {
    initGrid();
    randomize(); // start with a fresh random key on load
});
</script>

<script src="/js/navigation-context.js"></script>
<script src="/js/membership-gate.js"></script>
</body>
</html>
