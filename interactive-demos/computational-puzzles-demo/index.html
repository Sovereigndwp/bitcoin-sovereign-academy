<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Computational Puzzles Demo - Bitcoin Sovereign Academy</title>
    <link rel="stylesheet" href="/css/brand.css">
    <style>
        :root {
            --primary-orange: #f7931a;
            --primary-dark: #1a1a1a;
            --secondary-dark: #2d2d2d;
            --text-light: #e0e0e0;
            --text-dim: #b3b3b3;
            --accent-purple: #4f46e5;
            --accent-green: #28a745;
            --accent-red: #dc3545;
            --accent-blue: #2196F3;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--primary-dark);
            color: var(--text-light);
            min-height: 100vh;
            padding: 2rem;
        }

        /* Multi-Level Support */
        body.level-beginner .advanced-only { display: none; }
        body.level-beginner .intermediate-only { display: none; }
        body.level-intermediate .advanced-only { display: none; }
        body.level-intermediate .beginner-only { display: none; }
        body.level-advanced .beginner-only { display: none; }
        body.level-advanced .intermediate-only { display: none; }

        .container { max-width: 1200px; margin: 0 auto; }
        .header { text-align: center; margin-bottom: 2rem; }
        .header h1 { color: var(--primary-orange); font-size: 2rem; margin-bottom: 0.5rem; }

        .level-switcher { background: var(--secondary-dark); border: 2px solid var(--primary-orange); border-radius: 12px; padding: 1rem; margin-bottom: 2rem; }
        .level-info { text-align: center; margin-bottom: 0.75rem; }
        .level-buttons { display: flex; gap: 0.75rem; justify-content: center; flex-wrap: wrap; }
        .level-btn { padding: 0.6rem 1.2rem; background: rgba(247, 147, 26, 0.1); border: 2px solid rgba(247, 147, 26, 0.3); border-radius: 8px; color: var(--text-light); cursor: pointer; font-weight: 600; transition: all 0.3s ease; }
        .level-btn.active { background: var(--primary-orange); border-color: var(--primary-orange); color: white; }

        .section { background: var(--secondary-dark); border: 2px solid rgba(247, 147, 26, 0.3); border-radius: 15px; padding: 2rem; margin: 2rem 0; }
        .section h2 { color: var(--primary-orange); margin-bottom: 1rem; font-size: 1.5rem; }
        .section h3 { color: var(--accent-purple); margin: 1.5rem 0 1rem; font-size: 1.2rem; }

        .info-box { background: rgba(79, 70, 229, 0.1); border-left: 4px solid var(--accent-purple); border-radius: 0.5rem; padding: 1.5rem; margin: 1rem 0; }
        .success-box { background: rgba(40, 167, 80, 0.1); border-left: 4px solid var(--accent-green); border-radius: 0.5rem; padding: 1.5rem; margin: 1rem 0; }
        .warning-box { background: rgba(255, 193, 7, 0.1); border-left: 4px solid #FFC107; border-radius: 0.5rem; padding: 1.5rem; margin: 1rem 0; }

        /* Hash Playground */
        .hash-playground { background: rgba(33, 150, 243, 0.05); border: 2px solid var(--accent-blue); border-radius: 12px; padding: 2rem; margin: 2rem 0; }
        .input-group { margin: 1.5rem 0; }
        .input-group label { display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--accent-blue); }
        .input-group input { width: 100%; padding: 1rem; background: rgba(0, 0, 0, 0.3); border: 2px solid rgba(33, 150, 243, 0.3); border-radius: 8px; color: var(--text-light); font-size: 1rem; font-family: 'Courier New', monospace; }
        .input-group input:focus { outline: none; border-color: var(--accent-blue); }

        .hash-output { background: rgba(40, 167, 80, 0.1); border: 2px solid var(--accent-green); border-radius: 8px; padding: 1.5rem; margin: 1rem 0; font-family: 'Courier New', monospace; word-break: break-all; color: var(--accent-green); font-size: 0.9rem; line-height: 1.6; }

        /* Mining Simulator */
        .mining-sim { display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin: 2rem 0; }
        .sim-controls { background: rgba(79, 70, 229, 0.05); border: 2px solid var(--accent-purple); border-radius: 12px; padding: 1.5rem; }
        .sim-display { background: rgba(0, 0, 0, 0.3); border: 2px solid rgba(247, 147, 26, 0.3); border-radius: 12px; padding: 1.5rem; }

        .stat-box { background: rgba(247, 147, 26, 0.1); border-radius: 8px; padding: 1rem; margin: 0.75rem 0; }
        .stat-label { color: var(--text-dim); font-size: 0.85rem; margin-bottom: 0.25rem; }
        .stat-value { color: var(--primary-orange); font-size: 1.8rem; font-weight: bold; font-family: 'Courier New', monospace; }

        .difficulty-slider { width: 100%; margin: 1rem 0; }
        .difficulty-slider input { width: 100%; }

        .btn { background: var(--primary-orange); color: white; padding: 0.75rem 1.5rem; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; transition: all 0.3s ease; margin: 0.5rem; min-width: 44px; min-height: 44px; }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 5px 20px rgba(247, 147, 26, 0.4); }
        .btn:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }
        .btn-secondary { background: #6c757d; }
        .btn-success { background: var(--accent-green); }

        .hash-attempts { background: rgba(0, 0, 0, 0.4); border-radius: 8px; padding: 1rem; max-height: 300px; overflow-y: auto; margin: 1rem 0; }
        .hash-attempt { font-family: 'Courier New', monospace; font-size: 0.75rem; padding: 0.5rem; margin: 0.25rem 0; border-radius: 4px; background: rgba(255, 255, 255, 0.03); }
        .hash-attempt.success { background: rgba(40, 167, 80, 0.2); border-left: 3px solid var(--accent-green); }
        .hash-attempt.fail { background: rgba(244, 67, 54, 0.1); border-left: 3px solid var(--accent-red); }

        .comparison-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin: 2rem 0; }
        .comparison-card { background: rgba(79, 70, 229, 0.05); border: 2px solid var(--accent-purple); border-radius: 12px; padding: 1.5rem; }
        .comparison-card h4 { color: var(--accent-purple); margin-bottom: 1rem; }

        .progress-bar { background: rgba(0, 0, 0, 0.3); border-radius: 8px; height: 30px; overflow: hidden; margin: 1rem 0; }
        .progress-fill { background: linear-gradient(90deg, var(--primary-orange), #ff6b35); height: 100%; transition: width 0.3s ease; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 0.85rem; }

        @media (max-width: 768px) {
            .mining-sim { grid-template-columns: 1fr; }
            .comparison-grid { grid-template-columns: 1fr; }
        }

        /* ===== ACCESSIBILITY ENHANCEMENTS (WCAG 2.1 AA) ===== */
        button, a, [role="button"], input[type="button"], input[type="submit"], .level-btn {
            min-height: 44px;
            min-width: 44px;
        }

        *:focus-visible {
            outline: 3px solid var(--primary-orange, #f7931a);
            outline-offset: 2px;
        }

        button:focus-visible, a:focus-visible {
            outline: 3px solid var(--primary-orange, #f7931a);
            outline-offset: 4px;
            box-shadow: 0 0 0 4px rgba(247, 147, 26, 0.2);
        }

        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }

        @media (max-width: 360px) {
            body { overflow-x: hidden; }
        }
    </style>
    <link rel="stylesheet" href="/css/icons.css">
</head>
<body>
    <script src="/js/config.js"></script>
    <script src="/js/demo-lock-subdomain.js"></script>
    <script src="/js/subdomain-access-control.js"></script>

    <div class="container">
        <div class="header">
            <h1>üß© Understanding Proof of Work</h1>
            <p>Learn how Bitcoin mining works through interactive hash puzzles</p>
        </div>

        <div class="level-switcher">
            <div class="level-info">
                <span style="color: var(--text-dim); font-size: 0.9rem;">Difficulty:</span>
                <span style="color: var(--primary-orange); font-weight: bold; font-size: 1.1rem; margin-left: 0.5rem;" id="current-level-name">Beginner Mode</span>
            </div>
            <div class="level-buttons">
                <button class="level-btn active" data-level="beginner">Beginner</button>
                <button class="level-btn" data-level="intermediate">Intermediate</button>
                <button class="level-btn" data-level="advanced">Advanced</button>
            </div>
        </div>

        <!-- SECTION 1: What is a Hash? -->
        <div class="section">
            <h2>üîê Step 1: What is a Hash Function?</h2>

            <div class="info-box">
                <p class="beginner-only">
                    A <strong>hash function</strong> is like a magic blender: you put in any text (a word, a sentence, a whole book) and it transforms it into a unique string of letters and numbers. The same input always gives the same output, but changing even one letter completely changes the result. And most importantly: you can't work backwards from the output to figure out the input!
                </p>
                <p class="intermediate-only">
                    A <strong>cryptographic hash function</strong> takes any input data and produces a fixed-size output (256 bits for SHA-256). It's deterministic (same input = same output), one-way (irreversible), and has the avalanche effect (tiny input change = completely different output).
                </p>
                <p class="advanced-only">
                    <strong>SHA-256</strong> is a cryptographic hash function that maps arbitrary-length input to a fixed 256-bit output. It's computationally infeasible to: (1) find the input from output (preimage resistance), (2) find two inputs with same output (collision resistance), (3) find second input with same output as first (second preimage resistance). Bitcoin uses SHA-256(SHA-256(data)) for mining.
                </p>
            </div>

            <h3>üéÆ Interactive Hash Playground</h3>
            <p style="margin-bottom: 1rem;">Try typing anything below and watch how the hash changes:</p>

            <div class="hash-playground">
                <div class="input-group">
                    <label for="hash-input">Your Input:</label>
                    <input type="text" id="hash-input" value="Hello Bitcoin" placeholder="Type anything...">
                </div>

                <div class="input-group">
                    <label>SHA-256 Hash Output:</label>
                    <div class="hash-output" id="hash-output">Loading...</div>
                </div>

                <div class="warning-box beginner-only">
                    <strong>üí° Try this:</strong> Change just one letter in your input (like "hello" to "Hello") and see how dramatically the hash changes. This is called the "avalanche effect"!
                </div>

                <div class="comparison-grid">
                    <div class="comparison-card">
                        <h4>‚úÖ Properties You'll Notice:</h4>
                        <ul style="margin-left: 1.5rem; line-height: 1.8;">
                            <li>Always 64 characters long</li>
                            <li>Same input = same output (try typing "Hello" twice)</li>
                            <li>Tiny change = completely different hash</li>
                            <li>Looks random but isn't</li>
                        </ul>
                    </div>
                    <div class="comparison-card">
                        <h4>üéØ Examples to Try:</h4>
                        <ul style="margin-left: 1.5rem; line-height: 1.8;">
                            <li>Type: "Bitcoin" then "bitcoin"</li>
                            <li>Type: "123" then "124"</li>
                            <li>Type: "Hello World" then "Hello World!"</li>
                            <li>Your own name vs your name + space</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- SECTION 2: The Mining Challenge -->
        <div class="section">
            <h2>‚õèÔ∏è Step 2: The Mining Challenge</h2>

            <div class="info-box">
                <p class="beginner-only">
                    Bitcoin miners compete to find a special number (called a "nonce") that, when combined with transaction data, creates a hash starting with a certain number of zeros. The more zeros required, the harder the puzzle! Miners have to try billions of different numbers until they find one that works.
                </p>
                <p class="intermediate-only">
                    Mining is a brute-force search for a nonce that produces a hash below the difficulty target. If the target requires 4 leading zeros (0000...), miners must test ~65,536 hashes on average. Real Bitcoin requires ~20 leading zeros, meaning miners globally test ~400 quintillion hashes per second.
                </p>
                <p class="advanced-only">
                    The mining difficulty target is a 256-bit number. The network adjusts this every 2016 blocks (~2 weeks) to maintain 10-minute block times. Current difficulty ~60 trillion means finding a valid hash requires ~2^72 attempts on average. Total network hashrate ~400 EH/s provides thermodynamic security via unforgeable costliness.
                </p>
            </div>

            <h3>üéÆ Interactive Mining Simulator</h3>
            <p style="margin-bottom: 1rem;">Try to find a hash that starts with the required number of zeros:</p>

            <div class="mining-sim">
                <div class="sim-controls">
                    <h4 style="color: var(--accent-purple); margin-bottom: 1rem;">Mining Controls</h4>

                    <div class="difficulty-slider">
                        <label for="difficulty">Difficulty (Leading Zeros Required): <span id="difficulty-display">1</span></label>
                        <input type="range" id="difficulty" min="1" max="5" value="1" class="slider">
                        <p style="font-size: 0.85rem; color: var(--text-dim); margin-top: 0.5rem;">
                            <span class="beginner-only">1 zero = easy | 3 zeros = hard | 5 zeros = very hard!</span>
                            <span class="intermediate-only">1 zero = ~16 attempts | 3 zeros = ~4,096 attempts</span>
                            <span class="advanced-only">Each zero = 16x harder (2^4). Real Bitcoin ‚âà 19 zeros.</span>
                        </p>
                    </div>

                    <div class="input-group">
                        <label for="block-data">Block Data (transactions):</label>
                        <input type="text" id="block-data" value="Alice->Bob: 1 BTC">
                    </div>

                    <div style="text-align: center; margin-top: 1.5rem;">
                        <button class="btn" id="start-mining" onclick="startMining()">‚õèÔ∏è Start Mining</button>
                        <button class="btn btn-secondary" onclick="stopMining()">‚è∏Ô∏è Stop</button>
                        <button class="btn btn-secondary" onclick="resetMining()">üîÑ Reset</button>
                    </div>
                </div>

                <div class="sim-display">
                    <h4 style="color: var(--primary-orange); margin-bottom: 1rem;">Mining Results</h4>

                    <div class="stat-box">
                        <div class="stat-label">Attempts</div>
                        <div class="stat-value" id="attempts">0</div>
                    </div>

                    <div class="stat-box">
                        <div class="stat-label">Hashes per Second</div>
                        <div class="stat-value" id="hashrate">0</div>
                    </div>

                    <div class="stat-box">
                        <div class="stat-label">Current Nonce</div>
                        <div class="stat-value" id="current-nonce" style="font-size: 1.2rem;">-</div>
                    </div>

                    <div class="progress-bar">
                        <div class="progress-fill" id="progress" style="width: 0%">0%</div>
                    </div>

                    <div id="mining-result"></div>
                </div>
            </div>

            <div class="hash-attempts" id="hash-attempts">
                <p style="color: var(--text-dim); text-align: center;">Mining attempts will appear here...</p>
            </div>
        </div>

        <!-- SECTION 3: Why This Matters -->
        <div class="section">
            <h2>üéØ Step 3: Why This Matters for Bitcoin</h2>

            <div class="comparison-grid">
                <div class="comparison-card">
                    <h4>üî® Hard to Mine</h4>
                    <p class="beginner-only">Finding the right hash takes billions of guesses and lots of electricity. This makes it expensive to attack Bitcoin.</p>
                    <p class="intermediate-only">Computational work creates unforgeable costliness. Attackers must expend real energy to create fake votes, making Sybil attacks economically infeasible.</p>
                    <p class="advanced-only">PoW converts energy into consensus. Attack cost scales linearly with honest hashrate, creating Nash equilibrium where honest mining is the dominant strategy.</p>
                </div>

                <div class="comparison-card">
                    <h4>‚úÖ Easy to Verify</h4>
                    <p class="beginner-only">Once a miner finds the winning number, anyone can check it instantly with just one hash calculation.</p>
                    <p class="intermediate-only">Asymmetric verification: Finding requires ~2^(difficulty) attempts, verifying requires exactly 1 hash. This allows lightweight nodes to validate blocks.</p>
                    <p class="advanced-only">O(2^n) to find vs O(1) to verify. SPV clients can verify merkle proofs without downloading full blocks, enabling scalable verification.</p>
                </div>
            </div>

            <div class="success-box">
                <h4 style="color: var(--accent-green); margin-bottom: 1rem;">üéì Key Takeaways</h4>
                <ul style="margin-left: 1.5rem; line-height: 1.8;">
                    <li class="beginner-only"><strong>Proof of Work = Computational Lottery:</strong> Miners compete to find winning numbers</li>
                    <li class="beginner-only"><strong>Difficulty Adjusts:</strong> If miners get faster, Bitcoin makes the puzzle harder</li>
                    <li class="beginner-only"><strong>Secure by Design:</strong> Changing old transactions would require re-mining everything after it</li>

                    <li class="intermediate-only"><strong>Unforgeable Costliness:</strong> Energy expenditure creates objective consensus anchor</li>
                    <li class="intermediate-only"><strong>Difficulty Adjustment:</strong> Every 2016 blocks (~2 weeks) to maintain 10-min target</li>
                    <li class="intermediate-only"><strong>51% Attack Cost:</strong> Requires controlling majority hashrate continuously</li>

                    <li class="advanced-only"><strong>Nakamoto Consensus:</strong> Longest chain = most work = truth</li>
                    <li class="advanced-only"><strong>Thermodynamic Security:</strong> Physical laws enforce consensus</li>
                    <li class="advanced-only"><strong>Game Theoretic Equilibrium:</strong> Honest mining maximizes expected return</li>
                </ul>
            </div>

            <div class="info-box intermediate-only advanced-only">
                <h4 style="color: var(--accent-purple); margin-bottom: 0.75rem;">üìä Real Bitcoin Mining Stats</h4>
                <ul style="margin-left: 1.5rem; line-height: 1.8;">
                    <li><strong>Network Hashrate:</strong> ~400 EH/s (400 quintillion hashes/second)</li>
                    <li><strong>Difficulty:</strong> ~60 trillion (requires ~19-20 leading zeros)</li>
                    <li><strong>Block Reward:</strong> 3.125 BTC + fees (~$312,500 at $100k/BTC)</li>
                    <li><strong>Energy Usage:</strong> ~120 TWh/year (mostly renewable)</li>
                    <li><strong>Average Block Time:</strong> 10 minutes (maintained via difficulty adjustment)</li>
                </ul>
            </div>
        </div>

        <div style="background: rgba(247, 147, 26, 0.1); border: 2px solid var(--primary-orange); border-radius: 12px; padding: 2rem; margin-top: 2rem; text-align: center;">
            <h3 style="color: var(--primary-orange); margin-bottom: 1rem;">üöÄ Ready to Learn More?</h3>
            <p style="margin-bottom: 1.5rem;">Explore other aspects of Bitcoin's design:</p>
            <div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap;">
                <a href="/interactive-demos/mining-simulator/" class="btn">Mining Simulator ‚Üí</a>
                <a href="/interactive-demos/consensus-game/" class="btn">Consensus Game ‚Üí</a>
                <a href="/interactive-demos/difficulty-calculator/" class="btn">Difficulty Calculator ‚Üí</a>
            </div>
        </div>
    </div>

    <script>
        // Level Management
        const urlParams = new URLSearchParams(window.location.search);
        const currentLevel = urlParams.get('level') || 'beginner';
        document.body.classList.add(`level-${currentLevel}`);

        const LEVEL_CONFIG = {
            beginner: { name: "Beginner Mode" },
            intermediate: { name: "Intermediate Mode" },
            advanced: { name: "Advanced Mode" }
        };

        document.getElementById('current-level-name').textContent = LEVEL_CONFIG[currentLevel].name;

        document.querySelectorAll('.level-btn').forEach(btn => {
            if (btn.dataset.level === currentLevel) btn.classList.add('active');
            btn.addEventListener('click', (e) => {
                const newUrl = new URL(window.location);
                newUrl.searchParams.set('level', e.target.dataset.level);
                window.location.href = newUrl.toString();
            });
        });

        // SHA-256 Hash Function
        async function sha256(message) {
            const msgBuffer = new TextEncoder().encode(message);
            const hashBuffer = await crypto.subtle.digest('SHA-256', msgBuffer);
            const hashArray = Array.from(new Uint8Array(hashBuffer));
            const hashHex = hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
            return hashHex;
        }

        // Hash Playground
        const hashInput = document.getElementById('hash-input');
        const hashOutput = document.getElementById('hash-output');

        async function updateHash() {
            const input = hashInput.value;
            if (input === '') {
                hashOutput.textContent = 'Type something to see the hash...';
                hashOutput.style.color = 'var(--text-dim)';
                return;
            }

            hashOutput.textContent = 'Calculating...';
            hashOutput.style.color = 'var(--text-dim)';

            try {
                const hash = await sha256(input);
                hashOutput.textContent = hash;
                hashOutput.style.color = 'var(--accent-green)';
            } catch (error) {
                hashOutput.textContent = 'Error calculating hash';
                hashOutput.style.color = 'var(--accent-red)';
            }
        }

        hashInput.addEventListener('input', updateHash);
        updateHash(); // Initial hash

        // Mining Simulator
        let miningInterval = null;
        let attempts = 0;
        let startTime = null;
        let foundNonce = null;

        const difficultySlider = document.getElementById('difficulty');
        const difficultyDisplay = document.getElementById('difficulty-display');
        const blockDataInput = document.getElementById('block-data');
        const attemptsDisplay = document.getElementById('attempts');
        const hashrateDisplay = document.getElementById('hashrate');
        const currentNonceDisplay = document.getElementById('current-nonce');
        const progressBar = document.getElementById('progress');
        const hashAttemptsDiv = document.getElementById('hash-attempts');
        const miningResultDiv = document.getElementById('mining-result');

        difficultySlider.addEventListener('input', (e) => {
            difficultyDisplay.textContent = e.target.value;
            if (miningInterval) stopMining();
        });

        async function startMining() {
            if (miningInterval) return;

            attempts = 0;
            startTime = Date.now();
            foundNonce = null;
            miningResultDiv.innerHTML = '';
            hashAttemptsDiv.innerHTML = '<p style="color: var(--text-dim); text-align: center;">Mining in progress...</p>';

            const difficulty = parseInt(difficultySlider.value);
            const target = '0'.repeat(difficulty);
            const blockData = blockDataInput.value;

            document.getElementById('start-mining').disabled = true;

            let nonce = 0;
            const maxAttempts = Math.pow(16, difficulty) * 2; // Estimate

            miningInterval = setInterval(async () => {
                attempts++;
                nonce = Math.floor(Math.random() * 1000000000);

                const data = blockData + nonce;
                const hash = await sha256(data);

                currentNonceDisplay.textContent = nonce;
                attemptsDisplay.textContent = attempts.toLocaleString();

                // Calculate hashrate
                const elapsed = (Date.now() - startTime) / 1000;
                const hashrate = Math.floor(attempts / elapsed);
                hashrateDisplay.textContent = hashrate.toLocaleString();

                // Update progress
                const progress = Math.min(100, (attempts / maxAttempts) * 100);
                progressBar.style.width = progress + '%';
                progressBar.textContent = Math.floor(progress) + '%';

                // Add attempt to list (only show last 10)
                const isSuccess = hash.startsWith(target);
                const attemptDiv = document.createElement('div');
                attemptDiv.className = 'hash-attempt ' + (isSuccess ? 'success' : 'fail');
                attemptDiv.textContent = `Nonce: ${nonce} | Hash: ${hash.substring(0, 40)}...`;
                hashAttemptsDiv.insertBefore(attemptDiv, hashAttemptsDiv.firstChild);

                // Keep only last 10 attempts
                while (hashAttemptsDiv.children.length > 10) {
                    hashAttemptsDiv.removeChild(hashAttemptsDiv.lastChild);
                }

                // Check if we found it
                if (isSuccess) {
                    stopMining();
                    foundNonce = nonce;
                    showSuccess(nonce, hash, attempts, elapsed);
                }

                // Stop after too many attempts (safety)
                if (attempts > 10000) {
                    stopMining();
                    miningResultDiv.innerHTML = `
                        <div style="background: rgba(255, 193, 7, 0.2); border: 2px solid #FFC107; border-radius: 12px; padding: 1.5rem; margin-top: 1rem;">
                            <strong>‚è±Ô∏è Mining stopped after 10,000 attempts.</strong><br>
                            <small>Try reducing the difficulty or click "Start Mining" again to continue searching.</small>
                        </div>
                    `;
                }
            }, 10);
        }

        function stopMining() {
            if (miningInterval) {
                clearInterval(miningInterval);
                miningInterval = null;
                document.getElementById('start-mining').disabled = false;
            }
        }

        function resetMining() {
            stopMining();
            attempts = 0;
            foundNonce = null;
            attemptsDisplay.textContent = '0';
            hashrateDisplay.textContent = '0';
            currentNonceDisplay.textContent = '-';
            progressBar.style.width = '0%';
            progressBar.textContent = '0%';
            hashAttemptsDiv.innerHTML = '<p style="color: var(--text-dim); text-align: center;">Mining attempts will appear here...</p>';
            miningResultDiv.innerHTML = '';
        }

        function showSuccess(nonce, hash, attempts, elapsed) {
            let message = '';
            if (currentLevel === 'beginner') {
                message = `
                    <strong>üéâ Success! You Found It!</strong><br>
                    After ${attempts.toLocaleString()} attempts, you found nonce <strong>${nonce}</strong> which creates a hash starting with the required zeros!<br><br>
                    <strong>Why this matters:</strong> Real Bitcoin miners do this billions of times per second to secure the network and earn rewards.
                `;
            } else if (currentLevel === 'intermediate') {
                message = `
                    <strong>‚úÖ Valid Block Found!</strong><br>
                    <strong>Nonce:</strong> ${nonce}<br>
                    <strong>Attempts:</strong> ${attempts.toLocaleString()}<br>
                    <strong>Time:</strong> ${elapsed.toFixed(2)} seconds<br>
                    <strong>Hashrate:</strong> ${Math.floor(attempts / elapsed).toLocaleString()} H/s<br><br>
                    This demonstrates the probabilistic nature of mining and why difficulty adjustments are necessary.
                `;
            } else {
                message = `
                    <strong>‚õèÔ∏è Valid Proof of Work Generated</strong><br>
                    <strong>Winning Nonce:</strong> ${nonce}<br>
                    <strong>Block Hash:</strong> ${hash}<br>
                    <strong>Total Attempts:</strong> ${attempts.toLocaleString()}<br>
                    <strong>Search Time:</strong> ${elapsed.toFixed(2)}s<br>
                    <strong>Effective Hashrate:</strong> ${Math.floor(attempts / elapsed).toLocaleString()} H/s<br><br>
                    <small>Real Bitcoin network: ~400 EH/s (400,000,000,000,000,000,000 H/s) with difficulty requiring ~19-20 leading zeros.</small>
                `;
            }

            miningResultDiv.innerHTML = `
                <div style="background: rgba(40, 167, 80, 0.2); border: 2px solid var(--accent-green); border-radius: 12px; padding: 1.5rem; margin-top: 1rem;">
                    ${message}
                </div>
            `;
        }

        console.log(`üß© Computational Puzzles Demo Level: ${currentLevel}`);
    </script>

    <!-- Animated Icon Library -->
    <script src="/js/icon-library.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            if (window.IconLibrary) {
                document.querySelectorAll('[data-icon]').forEach(function(element) {
                    var iconName = element.getAttribute('data-icon');
                    if (iconName) {
                        var iconHTML = IconLibrary.get(iconName, 20, true);
                        var span = document.createElement('span');
                        span.innerHTML = iconHTML;
                        span.className = 'icon-inline';
                        span.style.marginRight = '0.5rem';
                        span.style.display = 'inline-block';
                        span.style.verticalAlign = 'middle';
                        element.insertBefore(span, element.firstChild);
                    }
                });
            }
        });
    </script>
</body>
</html>
