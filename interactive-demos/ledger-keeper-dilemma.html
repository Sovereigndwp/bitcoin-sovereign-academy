<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Ledger Keeper's Dilemma - Bitcoin Sovereign Academy</title>
    <link rel="stylesheet" href="/css/brand.css">
    <style>
        :root {
            --primary-orange: #f7931a;
            --primary-dark: #1a1a1a;
            --secondary-dark: #2d2d2d;
            --text-light: #e0e0e0;
            --text-dim: #999;
            --accent-purple: #4f46e5;
            --accent-green: #28a745;
            --accent-red: #dc3545;
            --accent-blue: #2196f3;
            --accent-yellow: #ffc107;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--primary-dark);
            color: var(--text-light);
            min-height: 100vh;
            padding: 1.5rem;
            overflow-x: hidden;
        }

        /* Multi-Level Support */
        body.level-beginner .advanced-only { display: none; }
        body.level-beginner .intermediate-only { display: none; }
        body.level-intermediate .advanced-only { display: none; }
        body.level-intermediate .beginner-only { display: none; }
        body.level-advanced .beginner-only { display: none; }
        body.level-advanced .intermediate-only { display: none; }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        /* Animated Header */
        .header {
            text-align: center;
            margin-bottom: 2rem;
            position: relative;
        }

        .header h1 {
            color: var(--primary-orange);
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            animation: glow 2s ease-in-out infinite alternate;
        }

        @keyframes glow {
            from { text-shadow: 0 0 10px rgba(247, 147, 26, 0.5); }
            to { text-shadow: 0 0 20px rgba(247, 147, 26, 0.8); }
        }

        .header p {
            color: var(--text-dim);
            font-size: 1.1rem;
        }

        /* Floating particles background effect */
        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
            opacity: 0.1;
        }

        .particle {
            position: absolute;
            width: 3px;
            height: 3px;
            background: var(--primary-orange);
            border-radius: 50%;
            animation: float 20s infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0) translateX(0); }
            25% { transform: translateY(-100vh) translateX(50px); }
            50% { transform: translateY(-200vh) translateX(-50px); }
            75% { transform: translateY(-300vh) translateX(100px); }
        }

        /* Content wrapper */
        .content {
            position: relative;
            z-index: 1;
        }

        /* Enhanced Level Switcher */
        .level-switcher {
            background: linear-gradient(135deg, rgba(45, 45, 45, 0.95), rgba(35, 35, 35, 0.95));
            border: 2px solid var(--primary-orange);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            box-shadow: 0 8px 32px rgba(247, 147, 26, 0.2);
            backdrop-filter: blur(10px);
        }

        .level-info {
            text-align: center;
            margin-bottom: 1rem;
        }

        .level-label {
            color: var(--text-dim);
            font-size: 0.9rem;
        }

        .level-current {
            color: var(--primary-orange);
            font-weight: bold;
            font-size: 1.2rem;
            margin-left: 0.5rem;
            display: inline-block;
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .level-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        .level-btn {
            padding: 0.8rem 1.5rem;
            background: rgba(247, 147, 26, 0.1);
            border: 2px solid rgba(247, 147, 26, 0.3);
            border-radius: 12px;
            color: var(--text-light);
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            font-size: 1rem;
            position: relative;
            overflow: hidden;
        }

        .level-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(247, 147, 26, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .level-btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .level-btn:hover {
            background: rgba(247, 147, 26, 0.2);
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(247, 147, 26, 0.3);
        }

        .level-btn.active {
            background: var(--primary-orange);
            border-color: var(--primary-orange);
            color: white;
            box-shadow: 0 6px 20px rgba(247, 147, 26, 0.4);
        }

        .level-btn span {
            position: relative;
            z-index: 1;
        }

        /* Story Intro Box */
        .intro-box {
            background: linear-gradient(135deg, rgba(79, 70, 229, 0.15), rgba(79, 70, 229, 0.05));
            border-left: 5px solid var(--accent-purple);
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 20px rgba(79, 70, 229, 0.2);
            animation: slideInLeft 0.6s ease-out;
        }

        @keyframes slideInLeft {
            from {
                opacity: 0;
                transform: translateX(-50px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .intro-box h3 {
            color: var(--accent-purple);
            margin-bottom: 1rem;
            font-size: 1.4rem;
        }

        .intro-box p {
            line-height: 1.8;
            font-size: 1.05rem;
        }

        /* Interactive Scenario */
        .keeper-scenario {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.08), rgba(255, 255, 255, 0.03));
            border-radius: 20px;
            padding: 2.5rem;
            margin: 2rem 0;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            animation: fadeInUp 0.8s ease-out;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .keeper-scenario h4 {
            color: var(--primary-orange);
            margin-bottom: 1.5rem;
            font-size: 1.6rem;
            text-align: center;
        }

        .scenario-prompt {
            text-align: center;
            font-size: 1.1rem;
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 12px;
            border: 1px solid rgba(247, 147, 26, 0.2);
        }

        /* Enhanced Keeper Options Grid */
        .keeper-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .keeper-option {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
            border: 3px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 2rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            color: white;
            position: relative;
            overflow: hidden;
        }

        .keeper-option::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, transparent, rgba(255, 255, 255, 0.1));
            opacity: 0;
            transition: opacity 0.4s;
        }

        .keeper-option:hover::before {
            opacity: 1;
        }

        .keeper-option:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 15px 40px rgba(79, 70, 229, 0.4);
        }

        .keeper-option.selected {
            border-color: var(--primary-orange);
            background: linear-gradient(135deg, rgba(247, 147, 26, 0.2), rgba(247, 147, 26, 0.1));
            box-shadow: 0 10px 30px rgba(247, 147, 26, 0.4);
            animation: selectPulse 0.5s ease-out;
        }

        @keyframes selectPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .keeper-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
            display: block;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .keeper-option:hover .keeper-icon {
            animation: spin 0.6s ease-in-out;
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .keeper-title {
            font-weight: bold;
            margin-bottom: 0.75rem;
            color: var(--accent-purple);
            font-size: 1.3rem;
        }

        .keeper-desc {
            font-size: 0.95rem;
            opacity: 0.9;
            line-height: 1.5;
        }

        /* Animated Result Box */
        .result-box {
            background: linear-gradient(135deg, rgba(79, 70, 229, 0.15), rgba(79, 70, 229, 0.05));
            border: 3px solid var(--accent-purple);
            border-radius: 16px;
            padding: 2rem;
            margin-top: 2rem;
            animation: slideInRight 0.6s ease-out;
            box-shadow: 0 8px 32px rgba(79, 70, 229, 0.3);
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(50px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .result-box h4 {
            color: var(--accent-purple);
            margin-bottom: 1.5rem;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .trust-score {
            font-size: 2rem;
            margin-bottom: 1.5rem;
            text-align: center;
            padding: 1rem;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 12px;
        }

        .trust-stars {
            display: inline-block;
            animation: twinkle 1.5s infinite;
        }

        @keyframes twinkle {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }

        .risks-section, .benefits-section {
            margin-bottom: 2rem;
            padding: 1.5rem;
            border-radius: 12px;
            transition: all 0.3s;
        }

        .risks-section {
            background: rgba(220, 53, 69, 0.1);
            border-left: 4px solid var(--accent-red);
        }

        .risks-section:hover {
            background: rgba(220, 53, 69, 0.15);
        }

        .benefits-section {
            background: rgba(40, 167, 80, 0.1);
            border-left: 4px solid var(--accent-green);
        }

        .benefits-section:hover {
            background: rgba(40, 167, 80, 0.15);
        }

        .risks-section strong {
            color: var(--accent-red);
            font-size: 1.2rem;
        }

        .benefits-section strong {
            color: var(--accent-green);
            font-size: 1.2rem;
        }

        .risks-section ul, .benefits-section ul {
            margin-left: 1.5rem;
            margin-top: 1rem;
        }

        .risks-section li, .benefits-section li {
            margin-bottom: 0.75rem;
            line-height: 1.6;
            position: relative;
            padding-left: 0.5rem;
        }

        .risks-section li::before {
            content: '⚠️';
            position: absolute;
            left: -1.5rem;
        }

        .benefits-section li::before {
            content: '✅';
            position: absolute;
            left: -1.5rem;
        }

        .real-example {
            background: rgba(0, 0, 0, 0.4);
            padding: 1.5rem;
            border-radius: 12px;
            margin-top: 1.5rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            line-height: 1.7;
        }

        .real-example strong {
            color: var(--primary-orange);
        }

        /* Interactive Timeline */
        .trust-failure-timeline {
            background: linear-gradient(135deg, rgba(220, 53, 69, 0.15), rgba(220, 53, 69, 0.05));
            border-radius: 20px;
            padding: 2.5rem;
            border: 2px solid rgba(220, 53, 69, 0.3);
            margin-top: 3rem;
            box-shadow: 0 8px 32px rgba(220, 53, 69, 0.2);
        }

        .trust-failure-timeline h4 {
            color: var(--accent-red);
            margin-bottom: 2rem;
            font-size: 1.6rem;
            text-align: center;
        }

        .failure-examples {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .failure-card {
            background: linear-gradient(135deg, rgba(220, 53, 69, 0.15), rgba(220, 53, 69, 0.05));
            border: 3px solid rgba(220, 53, 69, 0.3);
            border-radius: 16px;
            padding: 1.5rem;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .failure-card::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(220, 53, 69, 0.2);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .failure-card:hover::before {
            width: 400px;
            height: 400px;
        }

        .failure-card:hover {
            transform: translateY(-8px) rotate(-2deg);
            box-shadow: 0 12px 30px rgba(220, 53, 69, 0.5);
            border-color: var(--accent-red);
        }

        .failure-card.active {
            border-color: var(--primary-orange);
            background: linear-gradient(135deg, rgba(247, 147, 26, 0.2), rgba(247, 147, 26, 0.1));
        }

        .failure-year {
            font-size: 1rem;
            color: var(--accent-red);
            font-weight: bold;
            margin-bottom: 0.75rem;
            position: relative;
            z-index: 1;
        }

        .failure-title {
            font-size: 1.1rem;
            margin-bottom: 0.75rem;
            font-weight: bold;
            position: relative;
            z-index: 1;
        }

        .failure-impact {
            font-size: 0.9rem;
            opacity: 0.8;
            position: relative;
            z-index: 1;
        }

        /* Solution Box with gradient */
        .solution-box {
            background: linear-gradient(135deg, rgba(40, 167, 80, 0.15), rgba(40, 167, 80, 0.05));
            border-left: 6px solid var(--accent-green);
            border-radius: 12px;
            padding: 2rem;
            margin-top: 3rem;
            box-shadow: 0 8px 32px rgba(40, 167, 80, 0.2);
            animation: fadeInUp 1s ease-out;
        }

        .solution-box h4 {
            color: var(--accent-green);
            margin-bottom: 1.5rem;
            font-size: 1.5rem;
        }

        .solution-box p {
            line-height: 1.8;
            font-size: 1.05rem;
        }

        /* Educational Tip */
        .educational-tip {
            background: linear-gradient(135deg, rgba(33, 150, 243, 0.15), rgba(33, 150, 243, 0.05));
            border-left: 5px solid var(--accent-blue);
            padding: 1.5rem;
            border-radius: 12px;
            margin-top: 2rem;
            font-size: 1rem;
            line-height: 1.7;
            box-shadow: 0 4px 20px rgba(33, 150, 243, 0.2);
        }

        .educational-tip strong {
            color: var(--accent-blue);
            font-size: 1.1rem;
        }

        /* Progress Bar */
        .interaction-progress {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 1rem;
            margin-bottom: 2rem;
            text-align: center;
        }

        .progress-bar {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            overflow: hidden;
            margin-top: 0.5rem;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-orange), var(--accent-purple));
            width: 0%;
            transition: width 0.6s ease-out;
            border-radius: 10px;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }

            .keeper-options {
                grid-template-columns: 1fr;
            }

            .failure-examples {
                grid-template-columns: 1fr 1fr;
            }

            .keeper-scenario {
                padding: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <!-- Animated Background -->
    <div class="particles" id="particles"></div>

    <div class="content">
        <div class="container">
            <div class="header">
                <h1>🏛️ The Ledger Keeper's Dilemma</h1>
                <p>Who should you trust to maintain the global financial ledger?</p>
            </div>

            <!-- Progress Tracker -->
            <div class="interaction-progress">
                <div style="font-size: 0.9rem; color: var(--text-dim);">
                    Your Exploration Progress
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill"></div>
                </div>
            </div>

            <!-- Level Switcher -->
            <div class="level-switcher">
                <div class="level-info">
                    <span class="level-label">Difficulty:</span>
                    <span class="level-current" id="current-level-name">Beginner Mode</span>
                </div>
                <div class="level-buttons">
                    <button class="level-btn active" data-level="beginner"><span>🌱 Beginner</span></button>
                    <button class="level-btn" data-level="intermediate"><span>⚡ Intermediate</span></button>
                    <button class="level-btn" data-level="advanced"><span>🔧 Advanced</span></button>
                </div>
            </div>

            <!-- Introduction -->
            <div class="intro-box">
                <h3>💭 The Trust Problem</h3>
                <p class="beginner-only">
                    Every digital payment system needs someone to keep track of who owns what. This is called a "ledger."
                    But who can you trust to maintain it honestly? Let's explore the options and their trade-offs.
                </p>
                <p class="intermediate-only">
                    Digital currency requires a trusted ledger keeper to prevent double-spending and maintain balances.
                    Throughout history, different entities have played this role, each with unique incentive structures and vulnerabilities.
                </p>
                <p class="advanced-only">
                    The ledger keeper problem is fundamental to understanding Bitcoin's innovation. All previous digital currency
                    attempts required a trusted third party, creating single points of failure and censorship vectors.
                    Bitcoin's breakthrough was eliminating this trust requirement through proof-of-work consensus.
                </p>
            </div>

            <!-- Main Interactive Demo -->
            <div class="keeper-scenario">
                <h4>🎯 Scenario: Choose Your Ledger Keeper</h4>
                <div class="scenario-prompt">
                    <span class="beginner-only">You have $1 million in the system. Who do you trust to manage everyone's balances?</span>
                    <span class="intermediate-only">You need to store wealth digitally. Which ledger keeper best aligns with your sovereignty goals?</span>
                    <span class="advanced-only">Analyze each option's game-theoretic incentives, attack vectors, and historical precedents.</span>
                </div>

                <div class="keeper-options">
                    <button type="button" class="keeper-option" data-keeper="centralBank">
                        <div class="keeper-icon">🏛️</div>
                        <div class="keeper-title">Central Bank</div>
                        <div class="keeper-desc">Government controlled, regulated</div>
                    </button>

                    <button type="button" class="keeper-option" data-keeper="techCompany">
                        <div class="keeper-icon">🏢</div>
                        <div class="keeper-title">Tech Company</div>
                        <div class="keeper-desc">Profit-motivated, innovative</div>
                    </button>

                    <button type="button" class="keeper-option" data-keeper="cooperative">
                        <div class="keeper-icon">🤝</div>
                        <div class="keeper-title">Cooperative</div>
                        <div class="keeper-desc">Member-owned, democratic</div>
                    </button>

                    <button type="button" class="keeper-option" data-keeper="algorithm">
                        <div class="keeper-icon">⚡</div>
                        <div class="keeper-title">Algorithm</div>
                        <div class="keeper-desc">Code-based, no human control</div>
                    </button>
                </div>

                <div id="keeper-result"></div>
            </div>

            <!-- Real World Trust Failures -->
            <div class="trust-failure-timeline">
                <h4>📜 Real Trust Failures in Digital Payments</h4>
                <p style="margin-bottom: 2rem; opacity: 0.9; text-align: center; font-size: 1.05rem;">
                    <span class="beginner-only">These are real examples of what can go wrong when you trust others with your money:</span>
                    <span class="intermediate-only">Historical examples demonstrating systemic risks of centralized payment systems:</span>
                    <span class="advanced-only">Case studies illustrating the principal-agent problem and sovereign risk in financial infrastructure:</span>
                </p>

                <div class="failure-examples">
                    <div class="failure-card" data-failure="paypal">
                        <div class="failure-year">2010</div>
                        <div class="failure-title">PayPal WikiLeaks</div>
                        <div class="failure-impact">💰 Froze $60K+ donations</div>
                    </div>
                    <div class="failure-card" data-failure="canada">
                        <div class="failure-year">2022</div>
                        <div class="failure-title">Canadian Truckers</div>
                        <div class="failure-impact">🚫 200+ accounts frozen</div>
                    </div>
                    <div class="failure-card" data-failure="russia">
                        <div class="failure-year">2022</div>
                        <div class="failure-title">Russian SWIFT Ban</div>
                        <div class="failure-impact">🌍 145M people cut off</div>
                    </div>
                    <div class="failure-card" data-failure="mtgox">
                        <div class="failure-year">2014</div>
                        <div class="failure-title">Mt. Gox Hack</div>
                        <div class="failure-impact">₿ Lost 850K BTC</div>
                    </div>
                </div>

                <div id="trust-failure-result"></div>
            </div>

            <!-- Solution Box -->
            <div class="solution-box beginner-only">
                <h4>💡 The Revolutionary Insight</h4>
                <p>
                    What if we didn't need to trust anyone at all? What if the ledger could be maintained
                    by thousands of independent computers, none of which you need to trust individually?
                </p>
                <p style="margin-top: 1rem;">
                    If they all have to agree before anything changes, then no single party can cheat you.
                    This is Bitcoin's breakthrough innovation!
                </p>
            </div>

            <div class="solution-box intermediate-only">
                <h4>🔑 Bitcoin's Solution: Trustless Consensus</h4>
                <p>
                    Bitcoin eliminates the trusted third party by distributing the ledger across thousands of nodes.
                    Through proof-of-work mining, these nodes reach consensus on transaction validity without central coordination.
                </p>
                <p style="margin-top: 1rem;">
                    <strong>Key Insight:</strong> By making it economically expensive to attack the network (51% attack requires
                    controlling majority of global hashpower), Bitcoin aligns incentives so that honest behavior is more profitable
                    than cheating.
                </p>
            </div>

            <div class="solution-box advanced-only">
                <h4>⚡ Byzantine Fault Tolerance Through Economic Incentives</h4>
                <p>
                    Bitcoin solves the Byzantine Generals Problem in an open, permissionless network by combining cryptographic
                    proof-of-work with economic game theory. The Nakamoto consensus mechanism creates a Schelling point where
                    rational actors converge on the longest valid chain.
                </p>
                <p style="margin-top: 1rem;">
                    <strong>Attack Cost Analysis:</strong> At ~400 EH/s network hashrate, a 51% attack requires ~$20B in ASIC
                    hardware plus ongoing electricity costs of ~$1M/hour. Even if successful, the attack would likely crash
                    Bitcoin's price, making the hardware investment worthless. This creates an unforgeable costliness that
                    traditional trusted systems cannot replicate.
                </p>
            </div>

            <div class="educational-tip beginner-only">
                💡 <strong>Key Takeaway:</strong> Every centralized system has a single point of failure. Bitcoin's decentralized
                design means there's no one to freeze your account, inflate your savings, or shut down the network.
            </div>
        </div>
    </div>

    <script>
        // Create floating particles
        function createParticles() {
            const particles = document.getElementById('particles');
            for (let i = 0; i < 30; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.top = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 20 + 's';
                particle.style.animationDuration = (15 + Math.random() * 10) + 's';
                particles.appendChild(particle);
            }
        }
        createParticles();

        // Multi-level support
        const urlParams = new URLSearchParams(window.location.search);
        const currentLevel = urlParams.get('level') || 'beginner';
        const currentPath = urlParams.get('path') || 'unknown';

        document.body.classList.add(`level-${currentLevel}`);

        const LEVEL_CONFIG = {
            beginner: { name: "🌱 Beginner Mode" },
            intermediate: { name: "⚡ Intermediate Mode" },
            advanced: { name: "🔧 Advanced Mode" }
        };

        document.getElementById('current-level-name').textContent = LEVEL_CONFIG[currentLevel].name;

        // Set initial active button
        document.querySelectorAll('.level-btn').forEach(btn => {
            if (btn.dataset.level === currentLevel) {
                btn.classList.add('active');
            } else {
                btn.classList.remove('active');
            }
        });

        // Level switcher
        document.querySelectorAll('.level-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                const newLevel = e.currentTarget.dataset.level;
                const newUrl = new URL(window.location);
                newUrl.searchParams.set('level', newLevel);
                window.location.href = newUrl.toString();
            });
        });

        // Track interaction progress
        let interactionsCompleted = 0;
        const totalInteractions = 5; // 4 keepers + 1 trust failure

        function updateProgress() {
            const percentage = (interactionsCompleted / totalInteractions) * 100;
            document.getElementById('progress-fill').style.width = percentage + '%';
        }

        // Ledger Keeper Data
        const ledgerKeeperData = {
            centralBank: {
                title: "🏛️ Central Bank Ledger",
                risks: [
                    "Can freeze your account for political reasons",
                    "May devalue currency through money printing",
                    "Subject to government pressure and corruption",
                    "Capital controls can prevent withdrawals"
                ],
                benefits: [
                    "Regulated and supervised by law",
                    "Deposit insurance up to limits (FDIC: $250K)",
                    "Established legal framework for disputes",
                    "Generally stable in peacetime"
                ],
                realExample: "The Federal Reserve created over $4 trillion dollars during 2020-2021, devaluing existing savings by ~20% through inflation. Central banks worldwide have similar monetary expansion powers.",
                trustScore: 2,
                advancedInsight: "Cantillon Effect: Those closest to money creation (governments, banks) benefit first, while average citizens experience purchasing power erosion last. Historical inflation rates: Venezuela (1,000,000%+), Zimbabwe (79.6B%), Argentina (300%+)."
            },
            techCompany: {
                title: "🏢 Tech Company Ledger",
                risks: [
                    "Profit motive may conflict with user interests",
                    "Can change terms of service unilaterally",
                    "Single point of failure if company fails",
                    "Subject to government pressure for censorship"
                ],
                benefits: [
                    "Innovation and user experience focused",
                    "Technical expertise and infrastructure",
                    "Market competition drives improvement",
                    "Fast iteration and feature development"
                ],
                realExample: "PayPal froze WikiLeaks donations in 2010 after political pressure. Venmo has frozen accounts suspected of crypto transactions. Facebook banned crypto ads in 2018. Tech companies routinely censor payments.",
                trustScore: 2,
                advancedInsight: "Tech companies operate under surveillance capitalism model—user data is the product. Payment processors like Visa/Mastercard control 90%+ of digital transactions and can deplatform anyone. Regulatory capture ensures incumbents maintain monopoly power."
            },
            cooperative: {
                title: "🤝 Democratic Cooperative",
                risks: [
                    "Slow decision making through consensus",
                    "Susceptible to majority tyranny (51% can change rules)",
                    "May lack technical expertise",
                    "Still subject to government regulations"
                ],
                benefits: [
                    "Member-owned and democratically controlled",
                    "Aligned incentives with users",
                    "Transparent governance processes",
                    "Community-driven decisions"
                ],
                realExample: "Credit unions operate this way with 130M+ US members, but still face regulatory constraints. They couldn't prevent 2008 financial crisis contagion and are subject to same banking regulations as traditional banks.",
                trustScore: 3,
                advancedInsight: "Cooperative governance suffers from tragedy of the commons—diffuse benefits, concentrated costs lead to rational ignorance. Voter turnout in credit union elections: <5%. Democratic systems without skin-in-the-game degrade to plutocracy or mob rule."
            },
            algorithm: {
                title: "⚡ Algorithmic System (Bitcoin)",
                risks: [
                    "Code bugs could cause permanent losses (immutable)",
                    "Difficult to upgrade without consensus",
                    "No customer service or human recourse",
                    "Requires technical knowledge to self-custody safely"
                ],
                benefits: [
                    "No human bias, corruption, or coercion possible",
                    "Transparent and predictable rules (21M cap)",
                    "Cannot be censored or confiscated (if self-custodied)",
                    "Operates 24/7 globally without permission"
                ],
                realExample: "Bitcoin has operated for 16+ years with 99.98% uptime, processed $10+ trillion in transactions, and has never been successfully attacked at the protocol level. No trusted third party has ever frozen a self-custodied Bitcoin wallet.",
                trustScore: 5,
                advancedInsight: "Bitcoin achieves unforgeable costliness through proof-of-work—attacking requires ~$20B in ASICs + $1M/hour electricity. Lindy Effect: each day Bitcoin survives, expected remaining lifespan increases. Game theory: attacking Bitcoin is economically irrational as it destroys the value you're trying to steal. Thermodynamic security: energy → security conversion is one-way function."
            }
        };

        // Trust Failure Data
        const trustFailures = {
            paypal: {
                title: "PayPal WikiLeaks Freeze (2010)",
                description: "PayPal permanently froze WikiLeaks' donation account containing $60K+ after US government pressure, despite no court order or legal finding of wrongdoing. WikiLeaks was never charged with any crime.",
                impact: "Prevented public from donating to journalism organization, demonstrating how payment processors can be weaponized for political censorship. Led WikiLeaks to adopt Bitcoin as primary donation method.",
                advancedAnalysis: "Principal-agent problem: PayPal's incentive was regulatory compliance, not user service. Cost of defying government >> benefit of one customer. This asymmetric power dynamic exists in all centralized payment systems."
            },
            canada: {
                title: "Canadian Trucker Convoy (2022)",
                description: "Canadian government invoked Emergencies Act to freeze bank accounts of Freedom Convoy protesters and donors without court orders. Over 200 accounts frozen, including supporters who donated as little as $50.",
                impact: "Showed how governments can instantly cut off citizens from financial system for political dissent. Many frozen accounts belonged to ordinary citizens with no criminal charges filed. Several convoy organizers switched to Bitcoin to avoid seizure.",
                advancedAnalysis: "Demonstrates time-value of censorship resistance. Traditional finance: permissioned by default, freeze-first-ask-later. Bitcoin: permissionless by default, seizure requires private key access. Constitutional protections meaningless if government controls money flow."
            },
            russia: {
                title: "Russian SWIFT Exclusion (2022)",
                description: "Western nations excluded major Russian banks from SWIFT payment network after Ukraine invasion. Cut off 70% of Russian banking sector from international transactions, affecting 145M civilians.",
                impact: "Demonstrated how global payment infrastructure can be weaponized geopolitically, trapping ordinary citizens regardless of government actions. Russian citizens couldn't receive international payments or access foreign-held funds. Led to surge in Bitcoin adoption in Russia (+120% trading volume).",
                advancedAnalysis: "Reveals payment systems as sovereignty violation vector—US Treasury can exclude any nation from dollar-denominated trade. SWIFT censorship affects innocent civilians most (oligarchs have offshore alternatives). Bitcoin trading at 20-30% premium in Russia during sanctions peak. Neutral money is national security imperative for non-aligned nations."
            },
            mtgox: {
                title: "Mt. Gox Exchange Collapse (2014)",
                description: "World's largest Bitcoin exchange (70% of global BTC volume) lost 850,000 bitcoins (~7% of all Bitcoin) due to years of hacking and mismanagement. CEO Mark Karpeles was arrested but most funds never recovered.",
                impact: "Users lost $450M+ worth of Bitcoin permanently (worth $40B+ at 2024 prices). Showed risks of trusting centralized Bitcoin custodians—even within Bitcoin ecosystem, trusted third parties are security holes. Recovery process took 10+ years, still ongoing.",
                advancedAnalysis: "Ironically demonstrates Bitcoin's key insight: 'Not your keys, not your coins.' Exchange custody reintroduces trusted third party vulnerability Bitcoin was designed to eliminate. Self-custody requires technical competence but removes counterparty risk entirely. Modern solutions: multisig, hardware wallets, timelock recovery schemes."
            }
        };

        // Track selected items
        const selectedKeepers = new Set();
        const selectedFailures = new Set();

        // Keeper Selection
        document.querySelectorAll('.keeper-option').forEach(option => {
            option.addEventListener('click', (e) => {
                const keeperType = e.currentTarget.dataset.keeper;

                // Mark as selected
                e.currentTarget.classList.add('selected');

                if (!selectedKeepers.has(keeperType)) {
                    selectedKeepers.add(keeperType);
                    if (interactionsCompleted < 4) interactionsCompleted++;
                    updateProgress();
                }

                selectKeeper(keeperType);
            });
        });

        function selectKeeper(keeperType) {
            const data = ledgerKeeperData[keeperType];
            const result = document.getElementById('keeper-result');

            if (result && data) {
                const trustStars = '⭐'.repeat(data.trustScore) + '☆'.repeat(5 - data.trustScore);

                let html = `
                    <div class="result-box">
                        <h4>${data.title}</h4>
                        <div class="trust-score">
                            <strong>Trust Score: <span class="trust-stars">${trustStars}</span></strong>
                        </div>

                        <div class="risks-section">
                            <strong>⚠️ Risks:</strong>
                            <ul>
                                ${data.risks.map(risk => `<li>${risk}</li>`).join('')}
                            </ul>
                        </div>

                        <div class="benefits-section">
                            <strong>✅ Benefits:</strong>
                            <ul>
                                ${data.benefits.map(benefit => `<li>${benefit}</li>`).join('')}
                            </ul>
                        </div>

                        <div class="real-example">
                            <strong>📖 Real World Example:</strong><br>
                            ${data.realExample}
                        </div>
                `;

                if (currentLevel === 'advanced' && data.advancedInsight) {
                    html += `
                        <div class="real-example" style="margin-top: 1rem; border-left: 3px solid var(--accent-purple);">
                            <strong style="color: var(--accent-purple);">🎓 Advanced Analysis:</strong><br>
                            ${data.advancedInsight}
                        </div>
                    `;
                }

                html += `</div>`;
                result.innerHTML = html;

                // Scroll to result
                result.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            }
        }

        // Trust Failure Selection
        document.querySelectorAll('.failure-card').forEach(card => {
            card.addEventListener('click', (e) => {
                const failureType = e.currentTarget.dataset.failure;

                // Remove active from all
                document.querySelectorAll('.failure-card').forEach(c => c.classList.remove('active'));

                // Add active to clicked
                e.currentTarget.classList.add('active');

                if (!selectedFailures.has(failureType)) {
                    selectedFailures.add(failureType);
                    if (interactionsCompleted < totalInteractions) {
                        interactionsCompleted++;
                        updateProgress();
                    }
                }

                showTrustFailure(failureType);
            });
        });

        function showTrustFailure(failureType) {
            const failure = trustFailures[failureType];
            const result = document.getElementById('trust-failure-result');

            if (result && failure) {
                let html = `
                    <div class="result-box" style="border-color: var(--accent-red); background: linear-gradient(135deg, rgba(220, 53, 69, 0.15), rgba(220, 53, 69, 0.05));">
                        <h4 style="color: var(--accent-red);">${failure.title}</h4>
                        <p style="margin-bottom: 1rem; line-height: 1.7;"><strong>What Happened:</strong> ${failure.description}</p>
                        <p style="line-height: 1.7;"><strong>Impact:</strong> ${failure.impact}</p>
                `;

                if (currentLevel === 'advanced' && failure.advancedAnalysis) {
                    html += `
                        <div class="real-example" style="margin-top: 1rem; border-left: 3px solid var(--accent-purple);">
                            <strong style="color: var(--accent-purple);">🎓 Deep Dive:</strong><br>
                            ${failure.advancedAnalysis}
                        </div>
                    `;
                }

                html += `</div>`;
                result.innerHTML = html;

                // Scroll to result
                result.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            }
        }

        console.log(`🏛️ Ledger Keeper's Dilemma Level: ${currentLevel} (${LEVEL_CONFIG[currentLevel].name})`);
        console.log(`📊 Path: ${currentPath}`);
    </script>
</body>
</html>
