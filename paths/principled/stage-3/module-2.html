<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Ledger as Civilization's Memory | Stage 3 Module 2 | Principled Path</title>
    <style>
        :root {
            --primary-orange: #f7931a;
            --primary-dark: #1a1a1a;
            --secondary-dark: #2d2d2d;
            --accent-bronze: #8B6F47;
            --accent-bronze-light: #A0826D;
            --text-light: #e0e0e0;
            --text-dim: #999;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--primary-dark);
            color: var(--text-light);
            line-height: 1.6;
            padding: 2rem;
        }
        .container { max-width: 900px; margin: 0 auto; }
        .back-btn {
            display: inline-block;
            background: var(--primary-orange);
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 25px;
            text-decoration: none;
            font-weight: bold;
            margin-bottom: 2rem;
            transition: all 0.3s ease;
        }
        .back-btn:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(247, 147, 26, 0.4); }
        .module-header {
            text-align: center;
            margin-bottom: 3rem;
            padding: 2rem;
            background: linear-gradient(135deg, rgba(139, 111, 71, 0.2), rgba(139, 111, 71, 0.05));
            border-radius: 12px;
            border: 2px solid var(--accent-bronze);
        }
        .module-icon { font-size: 4rem; margin-bottom: 1rem; }
        h1 {
            font-size: 2.5rem;
            background: linear-gradient(45deg, #8B6F47, #A0826D);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 1rem;
        }
        .module-subtitle { font-size: 1.2rem; color: var(--text-dim); max-width: 700px; margin: 0 auto; }
        .content-section {
            background: var(--secondary-dark);
            border-radius: 12px;
            padding: 2.5rem;
            margin-bottom: 2rem;
            border: 2px solid rgba(139, 111, 71, 0.2);
        }
        .content-section h2 {
            color: var(--accent-bronze);
            font-size: 1.8rem;
            margin-bottom: 1.5rem;
        }
        .content-section h3 {
            color: var(--accent-bronze-light);
            font-size: 1.3rem;
            margin: 2rem 0 1rem;
        }
        .content-section p {
            color: var(--text-dim);
            margin-bottom: 1rem;
            line-height: 1.8;
        }
        .content-section ul {
            list-style: none;
            padding-left: 0;
        }
        .content-section li {
            padding: 0.75rem 0 0.75rem 2rem;
            position: relative;
            color: var(--text-light);
            line-height: 1.8;
        }
        .content-section li:before {
            content: "→";
            position: absolute;
            left: 0;
            color: var(--accent-bronze);
            font-weight: bold;
        }
        .highlight-box {
            background: rgba(139, 111, 71, 0.1);
            border-left: 4px solid var(--accent-bronze);
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 0.5rem;
        }
        .highlight-box strong {
            color: var(--accent-bronze);
            display: block;
            margin-bottom: 0.5rem;
        }
        .demo-container {
            background: var(--primary-dark);
            border: 2px solid rgba(139, 111, 71, 0.3);
            border-radius: 12px;
            padding: 2rem;
            margin: 2rem 0;
        }
        .demo-tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }
        .demo-tab {
            background: var(--secondary-dark);
            color: var(--text-dim);
            border: 2px solid rgba(139, 111, 71, 0.2);
            padding: 0.75rem 1.5rem;
            border-radius: 2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }
        .demo-tab:hover {
            border-color: var(--accent-bronze);
            color: var(--text-light);
        }
        .demo-tab.active {
            background: linear-gradient(45deg, #8B6F47, #A0826D);
            color: var(--primary-dark);
            border-color: var(--accent-bronze);
        }
        .demo-panel {
            display: none;
        }
        .demo-panel.active {
            display: block;
        }
        .timeline {
            position: relative;
            padding-left: 3rem;
            margin: 2rem 0;
        }
        .timeline::before {
            content: '';
            position: absolute;
            left: 1rem;
            top: 0;
            bottom: 0;
            width: 2px;
            background: linear-gradient(180deg, var(--accent-bronze), var(--accent-bronze-light));
        }
        .timeline-item {
            position: relative;
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: var(--secondary-dark);
            border-radius: 8px;
            border: 2px solid rgba(139, 111, 71, 0.2);
        }
        .timeline-item::before {
            content: '';
            position: absolute;
            left: -2.5rem;
            top: 1.5rem;
            width: 1rem;
            height: 1rem;
            background: var(--accent-bronze);
            border-radius: 50%;
            border: 3px solid var(--primary-dark);
        }
        .timeline-era {
            color: var(--accent-bronze);
            font-weight: bold;
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
        }
        .timeline-title {
            color: var(--text-light);
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }
        .timeline-description {
            color: var(--text-dim);
            line-height: 1.6;
        }
        .ledger-comparison {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }
        .ledger-card {
            background: var(--secondary-dark);
            padding: 1.5rem;
            border-radius: 8px;
            border: 2px solid rgba(139, 111, 71, 0.2);
            text-align: center;
            transition: all 0.3s ease;
        }
        .ledger-card:hover {
            transform: translateY(-4px);
            border-color: var(--accent-bronze);
        }
        .ledger-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }
        .ledger-name {
            color: var(--accent-bronze);
            font-weight: 600;
            margin-bottom: 0.5rem;
        }
        .ledger-trust {
            color: var(--text-dim);
            font-size: 0.9rem;
        }
        .interactive-ledger {
            background: var(--secondary-dark);
            padding: 2rem;
            border-radius: 8px;
            margin: 2rem 0;
        }
        .ledger-entry {
            display: flex;
            justify-content: space-between;
            padding: 1rem;
            margin: 0.5rem 0;
            background: var(--primary-dark);
            border-radius: 6px;
            border-left: 4px solid var(--accent-bronze);
        }
        .ledger-entry.corrupted {
            border-left-color: #e74c3c;
            opacity: 0.7;
        }
        .ledger-controls {
            display: flex;
            gap: 1rem;
            margin-top: 1.5rem;
            flex-wrap: wrap;
        }
        button {
            background: linear-gradient(45deg, #8B6F47, #A0826D);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 2rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(139, 111, 71, 0.4);
        }
        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        input[type="text"], input[type="number"] {
            background: var(--secondary-dark);
            border: 2px solid rgba(139, 111, 71, 0.3);
            color: var(--text-light);
            padding: 0.75rem;
            border-radius: 8px;
            font-size: 1rem;
            width: 100%;
            margin: 0.5rem 0;
        }
        input:focus {
            outline: none;
            border-color: var(--accent-bronze);
        }
        .reflection-section {
            background: linear-gradient(135deg, rgba(139, 111, 71, 0.1), rgba(139, 111, 71, 0.05));
            border: 2px solid rgba(139, 111, 71, 0.3);
            border-radius: 12px;
            padding: 2.5rem;
            margin: 3rem 0;
        }
        .reflection-section h2 {
            color: var(--accent-bronze);
            margin-bottom: 2rem;
            text-align: center;
        }
        .question-box {
            background: var(--secondary-dark);
            padding: 2rem;
            border-radius: 8px;
            margin-bottom: 2rem;
            border: 2px solid rgba(139, 111, 71, 0.2);
        }
        .question-box h3 {
            color: var(--accent-bronze-light);
            margin-bottom: 1rem;
        }
        textarea {
            width: 100%;
            min-height: 120px;
            background: var(--primary-dark);
            border: 2px solid rgba(139, 111, 71, 0.3);
            color: var(--text-light);
            padding: 1rem;
            border-radius: 8px;
            font-family: inherit;
            font-size: 1rem;
            line-height: 1.6;
            resize: vertical;
        }
        textarea:focus {
            outline: none;
            border-color: var(--accent-bronze);
        }
        .next-module {
            text-align: center;
            margin-top: 3rem;
        }
        .next-module a {
            display: inline-block;
            background: linear-gradient(135deg, var(--accent-bronze), var(--accent-bronze-light));
            color: white;
            padding: 1.25rem 2.5rem;
            border-radius: 2rem;
            text-decoration: none;
            font-weight: 700;
            font-size: 1.1rem;
            transition: all 0.3s ease;
        }
        .next-module a:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(139, 111, 71, 0.5);
        }
        @media (max-width: 768px) {
            .module-header h1 { font-size: 2rem; }
            .ledger-comparison { grid-template-columns: 1fr; }
            .demo-tabs { flex-direction: column; }
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="/paths/principled/stage-3/" class="back-btn">← Back to Stage 3</a>

        <div class="module-header">
            <div class="module-icon">📖</div>
            <h1>The Ledger as Civilization's Memory</h1>
            <p class="module-subtitle">
                Societies evolve by improving their record-keeping systems. Bitcoin is the latest upgrade
                in humanity's quest for truth.
            </p>
        </div>

        <!-- Introduction -->
        <div class="content-section">
            <h2>Why Ledgers Matter</h2>
            <p>
                Every civilization has faced the same fundamental problem: <strong>How do we remember who owns what?</strong>
            </p>
            <p>
                Without reliable memory, societies cannot function. You can't have property rights, contracts,
                or trade if there's no trusted record of ownership. The ledger—civilization's collective memory—
                is the foundation of every economy.
            </p>

            <div class="highlight-box">
                <strong>Key Insight:</strong>
                Human progress can be measured by the quality of our ledgers. From clay tablets to blockchain,
                each upgrade in record-keeping enabled new forms of cooperation and commerce.
            </div>

            <p>
                Throughout history, societies have continuously upgraded their ledger technology:
            </p>
            <ul>
                <li><strong>Clay tablets (3000 BCE)</strong> – First written records of debts and ownership</li>
                <li><strong>Paper ledgers (1494)</strong> – Double-entry bookkeeping revolutionizes accounting</li>
                <li><strong>Digital databases (1960s)</strong> – Computers enable instant record updates</li>
                <li><strong>Blockchain (2009)</strong> – Decentralized, immutable, transparent ledger</li>
            </ul>

            <p>
                Each upgrade solved specific problems but introduced new ones. Bitcoin represents a fundamental
                breakthrough: a ledger that requires no trusted authority to maintain.
            </p>
        </div>

        <!-- Historical Evolution -->
        <div class="content-section">
            <h2>The Evolution of Record-Keeping</h2>
            <p>
                Let's trace how humanity's ledgers evolved—and why each system eventually needed replacement.
            </p>

            <div class="timeline">
                <div class="timeline-item">
                    <div class="timeline-era">3000 BCE – ANCIENT MESOPOTAMIA</div>
                    <div class="timeline-title">Clay Tablets</div>
                    <div class="timeline-description">
                        Scribes carved records into wet clay. Problem: Tablets were fragile, localized,
                        and required trusting the scribe. But for the first time, agreements outlived human memory.
                    </div>
                </div>

                <div class="timeline-item">
                    <div class="timeline-era">1494 CE – RENAISSANCE ITALY</div>
                    <div class="timeline-title">Double-Entry Bookkeeping</div>
                    <div class="timeline-description">
                        Luca Pacioli formalized accounting with debits and credits. Problem: Books could be
                        altered, burned, or kept secret. But this system enabled modern banking and global trade.
                    </div>
                </div>

                <div class="timeline-item">
                    <div class="timeline-era">1971 CE – DIGITAL AGE</div>
                    <div class="timeline-title">Electronic Databases</div>
                    <div class="timeline-description">
                        Computers allowed instant updates and global synchronization. Problem: Databases are
                        centralized, hackable, and controlled by authorities. One administrator can alter history.
                    </div>
                </div>

                <div class="timeline-item">
                    <div class="timeline-era">2009 CE – BITCOIN ERA</div>
                    <div class="timeline-title">Blockchain Ledger</div>
                    <div class="timeline-description">
                        A distributed ledger maintained by thousands of computers worldwide. Problem solved:
                        No single authority can alter the record. History becomes permanent and verifiable.
                    </div>
                </div>
            </div>

            <div class="highlight-box">
                <strong>Pattern Recognition:</strong>
                Each ledger upgrade increased <em>scale</em> and <em>speed</em>, but decreased <em>decentralization</em>.
                Bitcoin reverses this trend—it's the first ledger that scales globally without sacrificing decentralization.
            </div>
        </div>

        <!-- Trust Comparison -->
        <div class="content-section">
            <h2>Who Do You Trust?</h2>
            <p>
                Every ledger system requires trust in someone or something. The question is: who holds the power
                to alter the record?
            </p>

            <div class="ledger-comparison">
                <div class="ledger-card">
                    <div class="ledger-icon">📜</div>
                    <div class="ledger-name">Clay Tablets</div>
                    <div class="ledger-trust">Trust: Scribes & priests</div>
                </div>
                <div class="ledger-card">
                    <div class="ledger-icon">📕</div>
                    <div class="ledger-name">Paper Ledgers</div>
                    <div class="ledger-trust">Trust: Accountants & banks</div>
                </div>
                <div class="ledger-card">
                    <div class="ledger-icon">💾</div>
                    <div class="ledger-name">Digital Databases</div>
                    <div class="ledger-trust">Trust: Tech companies & governments</div>
                </div>
                <div class="ledger-card">
                    <div class="ledger-icon">⛓️</div>
                    <div class="ledger-name">Bitcoin Blockchain</div>
                    <div class="ledger-trust">Trust: Mathematics & energy</div>
                </div>
            </div>

            <p>
                Bitcoin is the first ledger that replaces human trust with mathematical proof. You don't need
                to trust miners, developers, or validators—you can verify the entire history yourself.
            </p>
        </div>

        <!-- Interactive Demo -->
        <div class="content-section">
            <h2>Interactive Demonstrations</h2>
            <p>
                Experience the difference between centralized and decentralized ledgers.
            </p>

            <div class="demo-container">
                <div class="demo-tabs">
                    <button class="demo-tab active" onclick="switchTab('centralized')">Centralized Ledger</button>
                    <button class="demo-tab" onclick="switchTab('distributed')">Distributed Ledger</button>
                    <button class="demo-tab" onclick="switchTab('evolution')">Evolution Simulator</button>
                </div>

                <!-- Centralized Ledger Demo -->
                <div id="centralized-panel" class="demo-panel active">
                    <h3 style="color: var(--accent-bronze-light); margin-bottom: 1rem;">Centralized Ledger</h3>
                    <p style="color: var(--text-dim); margin-bottom: 1.5rem;">
                        One authority controls the record. Watch what happens when they have incentive to cheat.
                    </p>

                    <div class="interactive-ledger">
                        <h4 style="color: var(--accent-bronze); margin-bottom: 1rem;">Bank's Internal Ledger</h4>
                        <div id="centralizedEntries"></div>

                        <div class="ledger-controls">
                            <button onclick="addCentralizedEntry()">Add Legitimate Entry</button>
                            <button onclick="corruptCentralizedEntry()" style="background: linear-gradient(45deg, #e74c3c, #c0392b);">
                                Corrupt Entry (Admin Override)
                            </button>
                            <button onclick="resetCentralized()">Reset</button>
                        </div>

                        <div id="centralizedLog" style="margin-top: 1rem; padding: 1rem; background: var(--primary-dark); border-radius: 6px; color: var(--text-dim); font-size: 0.9rem;"></div>
                    </div>

                    <div class="highlight-box" style="margin-top: 1.5rem;">
                        <strong>What You Learned:</strong>
                        With centralized control, records can be altered with no evidence. Trust becomes mandatory,
                        verification becomes impossible.
                    </div>
                </div>

                <!-- Distributed Ledger Demo -->
                <div id="distributed-panel" class="demo-panel">
                    <h3 style="color: var(--accent-bronze-light); margin-bottom: 1rem;">Distributed Ledger</h3>
                    <p style="color: var(--text-dim); margin-bottom: 1.5rem;">
                        Multiple copies exist. Changing one copy doesn't change consensus.
                    </p>

                    <div class="interactive-ledger">
                        <h4 style="color: var(--accent-bronze); margin-bottom: 1rem;">Network Consensus (5 Nodes)</h4>
                        <div id="distributedNodes" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1rem; margin-bottom: 1.5rem;"></div>

                        <div class="ledger-controls">
                            <button onclick="addDistributedEntry()">Add Network Entry</button>
                            <button onclick="attackDistributedNode()" style="background: linear-gradient(45deg, #e74c3c, #c0392b);">
                                Attack Random Node
                            </button>
                            <button onclick="resetDistributed()">Reset</button>
                        </div>

                        <div id="distributedLog" style="margin-top: 1rem; padding: 1rem; background: var(--primary-dark); border-radius: 6px; color: var(--text-dim); font-size: 0.9rem;"></div>
                    </div>

                    <div class="highlight-box" style="margin-top: 1.5rem;">
                        <strong>What You Learned:</strong>
                        In a distributed system, tampering with one copy is obvious. The majority consensus
                        preserves truth even when some nodes are compromised.
                    </div>
                </div>

                <!-- Evolution Simulator -->
                <div id="evolution-panel" class="demo-panel">
                    <h3 style="color: var(--accent-bronze-light); margin-bottom: 1rem;">Ledger Evolution Simulator</h3>
                    <p style="color: var(--text-dim); margin-bottom: 1.5rem;">
                        See how different ledger systems handle the same transactions over time.
                    </p>

                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 1.5rem;">
                        <div style="text-align: center;">
                            <div style="font-size: 2rem; margin-bottom: 0.5rem;">📜</div>
                            <div style="color: var(--accent-bronze); font-weight: 600;">Clay Tablets</div>
                            <div id="claySpeed" style="color: var(--text-dim); font-size: 0.9rem;">Speed: 1 day/tx</div>
                            <div id="clayCost" style="color: var(--text-dim); font-size: 0.9rem;">Cost: High</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 2rem; margin-bottom: 0.5rem;">📕</div>
                            <div style="color: var(--accent-bronze); font-weight: 600;">Paper Ledger</div>
                            <div id="paperSpeed" style="color: var(--text-dim); font-size: 0.9rem;">Speed: 1 hour/tx</div>
                            <div id="paperCost" style="color: var(--text-dim); font-size: 0.9rem;">Cost: Medium</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 2rem; margin-bottom: 0.5rem;">💾</div>
                            <div style="color: var(--accent-bronze); font-weight: 600;">Database</div>
                            <div id="dbSpeed" style="color: var(--text-dim); font-size: 0.9rem;">Speed: Instant</div>
                            <div id="dbCost" style="color: var(--text-dim); font-size: 0.9rem;">Cost: Low</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 2rem; margin-bottom: 0.5rem;">⛓️</div>
                            <div style="color: var(--accent-bronze); font-weight: 600;">Bitcoin</div>
                            <div id="btcSpeed" style="color: var(--text-dim); font-size: 0.9rem;">Speed: ~10 min/block</div>
                            <div id="btcCost" style="color: var(--text-dim); font-size: 0.9rem;">Cost: Energy</div>
                        </div>
                    </div>

                    <div style="text-align: center; margin: 2rem 0;">
                        <div style="color: var(--text-light); font-size: 1.5rem; font-weight: 600; margin-bottom: 1rem;">
                            Transactions Processed: <span id="txCount">0</span>
                        </div>
                        <div style="color: var(--text-dim); margin-bottom: 1rem;">
                            Integrity Status: <span id="integrityStatus" style="color: #2ecc71; font-weight: 600;">All Systems Operational</span>
                        </div>
                    </div>

                    <div class="ledger-controls">
                        <button onclick="simulateEvolution()">Process 100 Transactions</button>
                        <button onclick="testIntegrity()" style="background: linear-gradient(45deg, #e74c3c, #c0392b);">
                            Test Integrity (Random Attack)
                        </button>
                        <button onclick="resetEvolution()">Reset</button>
                    </div>

                    <div id="evolutionLog" style="margin-top: 1rem; padding: 1rem; background: var(--primary-dark); border-radius: 6px; color: var(--text-dim); font-size: 0.9rem; max-height: 150px; overflow-y: auto;"></div>
                </div>
            </div>
        </div>

        <!-- Key Takeaways -->
        <div class="content-section">
            <h2>Why Bitcoin's Ledger Is Different</h2>
            <p>
                Bitcoin solves problems that have plagued ledgers for 5,000 years:
            </p>

            <h3>1. No Trusted Authority</h3>
            <p>
                Previous ledgers required trusting someone—a scribe, accountant, bank, or government.
                Bitcoin replaces this trust with mathematical proof and energy expenditure.
            </p>

            <h3>2. Global Consensus Without Coordination</h3>
            <p>
                Thousands of independent computers worldwide maintain identical copies of Bitcoin's ledger.
                They agree on the state of the ledger without any central coordinator.
            </p>

            <h3>3. Append-Only History</h3>
            <p>
                Once a transaction is recorded in Bitcoin's ledger and buried under enough proof-of-work,
                altering it becomes physically impossible. History solidifies like geological layers.
            </p>

            <h3>4. Open Verification</h3>
            <p>
                Anyone can download the entire ledger and verify every transaction back to the genesis block.
                You don't need permission to audit the system.
            </p>

            <div class="highlight-box">
                <strong>The Breakthrough:</strong>
                Bitcoin is the first ledger in human history where verification is easier than corruption.
                This inverts the traditional power structure—truth becomes stronger than authority.
            </div>
        </div>

        <!-- Socratic Reflection -->
        <div class="reflection-section">
            <h2>💭 Reflect on What You've Learned</h2>
            <p style="text-align: center; color: var(--text-dim); margin-bottom: 2rem;">
                Take a moment to think deeply about ledgers, trust, and civilization.
                Your reflections are saved automatically.
            </p>

            <div class="question-box">
                <h3>Question 1: Historical Pattern</h3>
                <p style="color: var(--text-dim); margin-bottom: 1rem;">
                    Throughout history, ledger upgrades increased speed and scale but decreased decentralization.
                    Why do you think centralization happened? What incentives drove it?
                </p>
                <textarea id="question1" placeholder="Type your reflection here..."></textarea>
            </div>

            <div class="question-box">
                <h3>Question 2: Trust Layers</h3>
                <p style="color: var(--text-dim); margin-bottom: 1rem;">
                    In a centralized database, you must trust the database administrator, the company, the government,
                    and the laws protecting your rights. How many layers of trust do you need with Bitcoin? Why is this significant?
                </p>
                <textarea id="question2" placeholder="Type your reflection here..."></textarea>
            </div>

            <div class="question-box">
                <h3>Question 3: Civilization's Memory</h3>
                <p style="color: var(--text-dim); margin-bottom: 1rem;">
                    If a civilization's ledger can be altered or erased, what happens to property rights, contracts,
                    and history itself? Why is immutability valuable even if it means mistakes can't be undone?
                </p>
                <textarea id="question3" placeholder="Type your reflection here..."></textarea>
            </div>
        </div>

        <!-- Next Module -->
        <div class="next-module">
            <h2 style="color: var(--accent-bronze); margin-bottom: 1rem;">Ready to Continue?</h2>
            <p style="color: var(--text-dim); margin-bottom: 2rem;">
                Next, discover why truth requires energy—and why that's actually a good thing.
            </p>
            <a href="/paths/principled/stage-3/?completed=true&module=2">
                Continue to Module 3: The Cost of Truth →
            </a>
        </div>
    </div>

    <script>
        // ===== Centralized Ledger Demo =====
        let centralizedLedger = [];
        let centralizedCounter = 0;

        function addCentralizedEntry() {
            const entry = {
                id: centralizedCounter++,
                from: 'Alice',
                to: 'Bob',
                amount: Math.floor(Math.random() * 100) + 1,
                corrupted: false
            };
            centralizedLedger.push(entry);
            updateCentralizedDisplay();
            logCentralized(`✓ Added: ${entry.from} → ${entry.to}: $${entry.amount}`);
        }

        function corruptCentralizedEntry() {
            if (centralizedLedger.length === 0) {
                logCentralized('⚠️ No entries to corrupt');
                return;
            }
            const index = Math.floor(Math.random() * centralizedLedger.length);
            const entry = centralizedLedger[index];
            const oldAmount = entry.amount;
            entry.amount = Math.floor(Math.random() * 1000) + 100;
            entry.corrupted = true;
            updateCentralizedDisplay();
            logCentralized(`⚠️ ADMIN OVERRIDE: Entry #${entry.id} changed from $${oldAmount} to $${entry.amount}. No audit trail.`);
        }

        function resetCentralized() {
            centralizedLedger = [];
            centralizedCounter = 0;
            updateCentralizedDisplay();
            logCentralized('🔄 Ledger reset');
        }

        function updateCentralizedDisplay() {
            const container = document.getElementById('centralizedEntries');
            if (centralizedLedger.length === 0) {
                container.innerHTML = '<div style="color: var(--text-dim); text-align: center; padding: 2rem;">No entries yet</div>';
                return;
            }
            container.innerHTML = centralizedLedger.map(entry => `
                <div class="ledger-entry ${entry.corrupted ? 'corrupted' : ''}">
                    <div>
                        <div style="font-weight: 600; color: var(--text-light);">#${entry.id}: ${entry.from} → ${entry.to}</div>
                        <div style="font-size: 0.9rem; color: var(--text-dim);">Amount: $${entry.amount}</div>
                    </div>
                    ${entry.corrupted ? '<div style="color: #e74c3c; font-weight: 600;">⚠️ ALTERED</div>' : '<div style="color: #2ecc71;">✓</div>'}
                </div>
            `).join('');
        }

        function logCentralized(message) {
            const log = document.getElementById('centralizedLog');
            log.innerHTML = `<div>${new Date().toLocaleTimeString()}: ${message}</div>` + log.innerHTML;
        }

        // ===== Distributed Ledger Demo =====
        let distributedLedger = [];
        let distributedCounter = 0;
        const nodeCount = 5;

        function addDistributedEntry() {
            const entry = {
                id: distributedCounter++,
                from: 'Alice',
                to: 'Bob',
                amount: Math.floor(Math.random() * 100) + 1
            };
            distributedLedger.push(entry);
            updateDistributedDisplay();
            logDistributed(`✓ Consensus reached: ${entry.from} → ${entry.to}: $${entry.amount} (${nodeCount}/${nodeCount} nodes agree)`);
        }

        function attackDistributedNode() {
            if (distributedLedger.length === 0) {
                logDistributed('⚠️ No entries to attack');
                return;
            }
            const nodeNum = Math.floor(Math.random() * nodeCount) + 1;
            logDistributed(`⚠️ Node ${nodeNum} compromised! Altered local copy...`);
            setTimeout(() => {
                logDistributed(`✓ Other nodes rejected Node ${nodeNum}'s invalid state. Consensus maintained (${nodeCount-1}/${nodeCount} agree).`);
                logDistributed(`🔄 Node ${nodeNum} re-synchronized with network consensus.`);
            }, 1500);
        }

        function resetDistributed() {
            distributedLedger = [];
            distributedCounter = 0;
            updateDistributedDisplay();
            logDistributed('🔄 Network reset');
        }

        function updateDistributedDisplay() {
            const container = document.getElementById('distributedNodes');
            container.innerHTML = Array.from({length: nodeCount}, (_, i) => `
                <div style="background: var(--secondary-dark); padding: 1rem; border-radius: 6px; border: 2px solid rgba(139, 111, 71, 0.2);">
                    <div style="color: var(--accent-bronze); font-weight: 600; margin-bottom: 0.5rem;">Node ${i+1}</div>
                    <div style="color: var(--text-dim); font-size: 0.85rem;">
                        ${distributedLedger.length} entries<br/>
                        Status: <span style="color: #2ecc71;">✓ Synced</span>
                    </div>
                </div>
            `).join('');
        }

        function logDistributed(message) {
            const log = document.getElementById('distributedLog');
            log.innerHTML = `<div>${new Date().toLocaleTimeString()}: ${message}</div>` + log.innerHTML;
        }

        // ===== Evolution Simulator =====
        let txCount = 0;
        let systemIntegrity = {
            clay: true,
            paper: true,
            database: true,
            bitcoin: true
        };

        function simulateEvolution() {
            txCount += 100;
            document.getElementById('txCount').textContent = txCount;
            logEvolution(`✓ Processed 100 transactions across all ledger types`);
            logEvolution(`📜 Clay tablets: 100 days elapsed`);
            logEvolution(`📕 Paper ledger: ~4 days elapsed`);
            logEvolution(`💾 Database: Instant processing`);
            logEvolution(`⛓️ Bitcoin: ~16 hours (100 blocks)`);
        }

        function testIntegrity() {
            const systems = ['clay', 'paper', 'database', 'bitcoin'];
            const target = systems[Math.floor(Math.random() * systems.length)];
            const names = {clay: 'Clay Tablets', paper: 'Paper Ledger', database: 'Database', bitcoin: 'Bitcoin'};

            logEvolution(`⚠️ Attack targeting ${names[target]}...`);

            setTimeout(() => {
                if (target === 'bitcoin') {
                    logEvolution(`✓ Bitcoin attack failed: Would require 51% of global hashpower + rewriting all subsequent blocks`);
                } else {
                    systemIntegrity[target] = false;
                    logEvolution(`⚠️ ${names[target]} compromised: Administrator altered historical records`);
                    updateIntegrityStatus();
                }
            }, 1000);
        }

        function updateIntegrityStatus() {
            const failed = Object.entries(systemIntegrity).filter(([k,v]) => !v).length;
            const status = document.getElementById('integrityStatus');
            if (failed === 0) {
                status.textContent = 'All Systems Operational';
                status.style.color = '#2ecc71';
            } else {
                status.textContent = `${failed} System${failed > 1 ? 's' : ''} Compromised (Bitcoin: ✓ Secure)`;
                status.style.color = '#e74c3c';
            }
        }

        function resetEvolution() {
            txCount = 0;
            systemIntegrity = {clay: true, paper: true, database: true, bitcoin: true};
            document.getElementById('txCount').textContent = '0';
            updateIntegrityStatus();
            document.getElementById('evolutionLog').innerHTML = '';
            logEvolution('🔄 Simulation reset');
        }

        function logEvolution(message) {
            const log = document.getElementById('evolutionLog');
            log.innerHTML = `<div>${new Date().toLocaleTimeString()}: ${message}</div>` + log.innerHTML;
        }

        // ===== Tab Switching =====
        function switchTab(tab) {
            document.querySelectorAll('.demo-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.demo-panel').forEach(p => p.classList.remove('active'));

            event.target.classList.add('active');
            document.getElementById(`${tab}-panel`).classList.add('active');
        }

        // ===== Reflection Questions with localStorage =====
        const STORAGE_KEY = 'principled-stage3-module2-reflections';

        function saveReflection(questionNum, value) {
            const reflections = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}');
            reflections[`question${questionNum}`] = value;
            localStorage.setItem(STORAGE_KEY, JSON.stringify(reflections));
        }

        function loadReflections() {
            const reflections = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}');
            for (let i = 1; i <= 3; i++) {
                const textarea = document.getElementById(`question${i}`);
                if (textarea && reflections[`question${i}`]) {
                    textarea.value = reflections[`question${i}`];
                }
            }
        }

        // Initialize on load
        window.addEventListener('DOMContentLoaded', () => {
            loadReflections();
            updateCentralizedDisplay();
            updateDistributedDisplay();

            // Auto-save reflections
            ['question1', 'question2', 'question3'].forEach((id, index) => {
                const textarea = document.getElementById(id);
                if (textarea) {
                    textarea.addEventListener('input', (e) => {
                        saveReflection(index + 1, e.target.value);
                    });
                }
            });
        });
    </script>
</body>
</html>
