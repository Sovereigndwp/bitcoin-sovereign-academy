<!DOCTYPE html><html lang="en"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Module 3.1: The Building Blocks of Digital Trust | Principled Path</title>
    <link rel="stylesheet" href="/css/brand.css">
    <style>
        :root {
            --accent-bronze: #8B6F47;
            --accent-bronze-light: #A0826D;
            --primary-dark: #1a1a1a;
            --secondary-dark: #2d2d2d;
            --text-light: #e0e0e0;
            --text-dim: #b3b3b3;
            --danger-red: #e74c3c;
            --success-green: #2ecc71;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--primary-dark);
            color: var(--text-light);
            line-height: 1.6;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* Navigation */
        .breadcrumb {
            
            margin-bottom: 2rem;
            font-size: 0.9rem;
        }

        .breadcrumb a {
            color: var(--accent-bronze);
            text-decoration: none;
        }

        .breadcrumb a:hover {
            text-decoration: underline;
        }

        .breadcrumb ol {
            list-style: none;
            padding: 0;
            margin: 0;
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .breadcrumb li {
            display: inline;
            color: var(--text-dim);
        }

        .breadcrumb li:not(:last-child)::after {
            content: "‚Üí";
            margin-left: 0.5rem;
        }


        /* Module Header */
        .module-header {
            text-align: center;
            margin-bottom: 3rem;
            padding: 2rem;
            background: var(--secondary-dark);
            border-radius: 12px;
            border: 2px solid var(--accent-bronze);
        }

        .stage-indicator {
            font-size: 0.9rem;
            color: var(--accent-bronze);
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        h1 {
            font-size: 2.5rem;
            background: linear-gradient(45deg, #8B6F47, #A0826D);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 1rem;
        }

        .module-subtitle {
            font-size: 1.2rem;
            color: var(--text-dim);
        }

        /* Content Sections */
        .content-section {
            background: var(--secondary-dark);
            border-radius: 12px;
            padding: 2.5rem;
            margin-bottom: 2rem;
            border: 2px solid rgba(139, 111, 71, 0.2);
        }

        .content-section h2 {
            color: var(--accent-bronze);
            font-size: 1.8rem;
            margin-bottom: 1.5rem;
        }

        .content-section h3 {
            color: var(--accent-bronze-light);
            font-size: 1.3rem;
            margin: 2rem 0 1rem;
        }

        .content-section p {
            color: var(--text-dim);
            margin-bottom: 1rem;
            line-height: 1.8;
        }

        .key-insight {
            background: rgba(247, 147, 26, 0.1);
            border-left: 4px solid var(--accent-bronze);
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 8px;
        }

        .key-insight p {
            color: var(--text-light);
            font-weight: 500;
        }

        /* Building Blocks Grid */
        .blocks-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .block-card {
            background: var(--primary-dark);
            border: 2px solid rgba(139, 111, 71, 0.3);
            border-radius: 12px;
            padding: 2rem;
            transition: all 0.3s ease;
        }

        .block-card:hover {
            border-color: var(--accent-bronze);
            transform: translateY(-4px);
            box-shadow: 0 8px 24px rgba(139, 111, 71, 0.3);
        }

        .block-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .block-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--accent-bronze);
            margin-bottom: 1rem;
        }

        .block-description {
            color: var(--text-dim);
            font-size: 0.95rem;
            line-height: 1.6;
        }

        /* Interactive Demo */
        .demo-container {
            background: var(--primary-dark);
            border-radius: 12px;
            padding: 2rem;
            margin: 2rem 0;
        }

        .demo-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .demo-header h3 {
            color: var(--accent-bronze);
            margin-bottom: 0.5rem;
        }

        .demo-tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            border-bottom: 2px solid rgba(139, 111, 71, 0.2);
        }

        .demo-tab {
            padding: 1rem 1.5rem;
            background: transparent;
            border: none;
            color: var(--text-dim);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
        }

        .demo-tab.active {
            color: var(--accent-bronze);
            border-bottom-color: var(--accent-bronze);
        }

        .demo-tab:hover {
            color: var(--accent-bronze-light);
        }

        .demo-panel {
            display: none;
        }

        .demo-panel.active {
            display: block;
        }

        .demo-input-group {
            margin-bottom: 1.5rem;
        }

        .demo-input-group label {
            display: block;
            color: var(--accent-bronze);
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        .demo-input {
            width: 100%;
            padding: 1rem;
            background: var(--secondary-dark);
            border: 2px solid rgba(139, 111, 71, 0.3);
            border-radius: 8px;
            color: var(--text-light);
            font-family: 'Courier New', monospace;
            font-size: 0.95rem;
        }

        .demo-input:focus {
            outline: none;
            border-color: var(--accent-bronze);
        }

        .demo-button {
            padding: 1rem 2rem;
            background: linear-gradient(135deg, var(--accent-bronze), var(--accent-bronze-light));
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .demo-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(139, 111, 71, 0.4);
        }

        .demo-output {
            background: var(--secondary-dark);
            border: 2px solid rgba(139, 111, 71, 0.3);
            border-radius: 8px;
            padding: 1.5rem;
            margin-top: 1.5rem;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            color: var(--text-light);
            word-break: break-all;
        }

        .output-label {
            color: var(--accent-bronze);
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        /* Key Properties Box */
        .properties-box {
            background: rgba(139, 111, 71, 0.1);
            border: 2px solid rgba(139, 111, 71, 0.3);
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
        }

        .properties-box h4 {
            color: var(--accent-bronze);
            margin-bottom: 1rem;
        }

        .properties-box ul {
            list-style: none;
            padding: 0;
        }

        .properties-box li {
            padding: 0.5rem 0 0.5rem 2rem;
            position: relative;
            color: var(--text-dim);
        }

        .properties-box li:before {
            content: "‚úì";
            position: absolute;
            left: 0;
            color: var(--success-green);
            font-weight: bold;
        }

        /* Interactive Reflection System */
        .question-section {
            background: var(--secondary-dark);
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 1.5rem;
            border: 2px solid rgba(139, 111, 71, 0.2);
        }

        .question-section h4 {
            color: var(--accent-bronze);
            margin-bottom: 1rem;
            font-size: 1.2rem;
        }

        .reflection-tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            border-bottom: 2px solid rgba(139, 111, 71, 0.2);
            padding-bottom: 0.5rem;
        }

        .reflection-tab {
            background: transparent;
            border: none;
            color: var(--text-dim);
            padding: 0.5rem 1rem;
            border-radius: 6px 6px 0 0;
            cursor: pointer;
            font-size: 0.95rem;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .reflection-tab:hover {
            color: var(--accent-bronze-light);
            background: rgba(139, 111, 71, 0.1);
        }

        .reflection-tab.active {
            color: var(--accent-bronze);
            background: rgba(139, 111, 71, 0.15);
        }

        .reflection-panel {
            display: none;
        }

        .reflection-panel.active {
            display: block;
        }

        .question-section textarea {
            width: 100%;
            min-height: 100px;
            background: var(--primary-dark);
            border: 2px solid rgba(139, 111, 71, 0.3);
            border-radius: 8px;
            padding: 1rem;
            color: var(--text-light);
            font-family: inherit;
            font-size: 1rem;
            resize: vertical;
            margin-bottom: 0.75rem;
        }

        .question-section textarea:focus {
            outline: none;
            border-color: var(--accent-bronze);
        }

        .char-counter {
            text-align: right;
            color: var(--text-dim);
            font-size: 0.85rem;
            margin-bottom: 0.75rem;
        }

        .choice-select {
            width: 100%;
            background: var(--primary-dark);
            border: 2px solid rgba(139, 111, 71, 0.3);
            border-radius: 8px;
            padding: 0.75rem;
            color: var(--text-light);
            font-size: 1rem;
            cursor: pointer;
        }

        .choice-select:focus {
            outline: none;
            border-color: var(--accent-bronze);
        }

        .feedback-btn {
            background: linear-gradient(135deg, var(--accent-bronze), var(--accent-bronze-light));
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .feedback-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(139, 111, 71, 0.4);
        }

        .feedback-box {
            background: rgba(45, 45, 45, 0.8);
            border-left: 4px solid var(--accent-bronze);
            border-radius: 8px;
            padding: 1.5rem;
            margin-top: 1rem;
        }

        .feedback-box.positive {
            border-left-color: var(--success-green);
        }

        .feedback-box.hint {
            border-left-color: #f39c12;
        }

        .feedback-box h5 {
            color: var(--accent-bronze);
            margin: 0 0 0.75rem 0;
            font-size: 1.05rem;
        }

        .feedback-box.positive h5 {
            color: var(--success-green);
        }

        .feedback-box.hint h5 {
            color: #f39c12;
        }

        .checklist-reflection {
            background: rgba(26, 26, 26, 0.6);
            padding: 1.5rem;
            border-radius: 8px;
            border: 2px solid rgba(139, 111, 71, 0.2);
        }

        .checkbox-label {
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
            padding: 0.75rem;
            margin-bottom: 0.5rem;
            cursor: pointer;
            border-radius: 6px;
            transition: background 0.2s ease;
        }

        .checkbox-label:hover {
            background: rgba(139, 111, 71, 0.1);
        }

        .checkbox-label input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
            margin-top: 0.15rem;
        }

        .save-indicator {
            font-size: 0.9rem;
            color: var(--text-dim);
            margin-top: 0.5rem;
            font-style: italic;
        }

        /* Mobile Responsive Adjustments */
        
        /* ===== ACCESSIBILITY ENHANCEMENTS (WCAG 2.1 AA) ===== */

        /* WCAG 2.5.5: Touch Target Size */
        button, a, [role="button"], .nav-btn, .nav-link, .back-button, .demo-button, .feedback-btn, .check-answer-btn {
            min-height: 44px;
            min-width: 44px;
        }

        p a, li a {
            min-height: auto;
            min-width: auto;
            padding: 0.25rem 0;
        }

        /* WCAG 2.4.7: Focus Visible */
        *:focus-visible {
            outline: 3px solid var(--accent-bronze, #8B6F47);
            outline-offset: 2px;
        }

        button:focus-visible, a:focus-visible, [role="button"]:focus-visible {
            outline: 3px solid var(--accent-bronze, #8B6F47);
            outline-offset: 4px;
            box-shadow: 0 0 0 4px rgba(139, 111, 71, 0.2);
        }

        /* WCAG 2.3.3: Animation from Interactions */
        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
                scroll-behavior: auto !important;
            }
        }

        /* WCAG 1.4.10: Reflow */
        @media (max-width: 360px) {
            body {
                overflow-x: hidden;
            }

            .container {
                padding: 0 1rem;
            }
        }


        @media (max-width: 480px) {
            .reflection-tabs {
                flex-direction: column;
                gap: 0.25rem;
            }

            .reflection-tab {
                width: 100%;
                text-align: center;
                border-radius: 6px;
            }

            .question-section {
                padding: 1.5rem;
            }

            .feedback-box {
                padding: 1rem;
            }
        }

        /* Navigation Buttons */
        .module-navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 3rem;
            gap: 1rem;
        }

        .nav-btn {
            padding: 1rem 2rem;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            display: inline-block;
        }

        .nav-btn-primary {
            background: linear-gradient(45deg, #8B6F47, #A0826D);
            color: var(--primary-dark);
        }

        .nav-btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(139, 111, 71, 0.4);
        }

        .nav-btn-secondary {
            background: var(--secondary-dark);
            color: var(--accent-bronze);
            border: 2px solid var(--accent-bronze);
        }

        .nav-btn-secondary:hover {
            background: var(--accent-bronze);
            color: var(--primary-dark);
        }

        @media (max-width: 768px) {
            .container { padding: 1rem; }
            h1 { font-size: 2rem; }
            .blocks-grid { grid-template-columns: 1fr; }
            .demo-tabs { flex-direction: column; gap: 0.5rem; }
            .module-navigation { flex-direction: column; }
        }
    </style>
    <script src="/js/config.js"></script>
    <script src="/js/subdomain-access-control.js"></script>
    <script src="/js/module-gate-subdomain.js"></script>
    <script src="/js/module-progress.js"></script>
    <link rel="stylesheet" href="/css/icons.css">
<meta name="description" content="Learn about module 1 at Bitcoin Sovereign Academy. Interactive Bitcoin education with hands-on exercises and expert guidance."><link rel="canonical" href="https://bitcoinsovereign.academy/module-1.html"><meta property="og:title" content="Module 1 - Bitcoin Sovereign Academy"><meta property="og:description" content="Learn about module 1 at Bitcoin Sovereign Academy. Interactive Bitcoin education with hands-on exercises and expert guidance."><meta property="og:image" content="https://bitcoinsovereign.academy/assets/og-image.jpg"><meta property="og:url" content="https://bitcoinsovereign.academy/module-1.html"><meta property="og:type" content="website"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "EducationalOrganization",
  "name": "Bitcoin Sovereign Academy",
  "description": "Master Bitcoin through interactive experiences, AI-powered learning, and real-world simulations. Your journey from monetary curiosity to financial sovereignty starts here.",
  "url": "https://bitcoinsovereign.academy",
  "logo": "https://bitcoinsovereign.academy/assets/og-image.jpg",
  "sameAs": [
    "https://github.com/Sovereigndwp/bitcoin-sovereign-academy"
  ],
  "educationalLevel": "Beginner to Advanced",
  "teaches": [
    "Bitcoin Fundamentals",
    "Cryptocurrency Technology",
    "Financial Sovereignty",
    "Digital Asset Security"
  ],
  "audience": {
    "@type": "Audience",
    "audienceType": "Students interested in Bitcoin and cryptocurrency"
  }
}</script></head>
<body>
    <a href="#main-content" class="skip-link">Skip to main content</a>
    <main id="main-content" class="container">
        <!-- Breadcrumb Navigation -->
        <nav class="breadcrumb">
            <a href="/">Home</a> ‚Üí
            <a href="/paths/principled/">Principled Path</a> ‚Üí
            <a href="/paths/principled/stage-3/">Stage 3</a> ‚Üí
            <span>Module 1</span>
        </nav>

        <!-- Module Header -->
        <header class="module-header">
            <div class="stage-indicator">STAGE 3 ¬∑ MODULE 1</div>
            <h1>The Building Blocks of Digital Trust</h1>
            <p class="module-subtitle">The three inventions that made Bitcoin possible</p>
        </header>

        <!-- The Dramatic Reveal -->
        <section class="content-section">
            <h2>The Solution Nobody Thought Possible</h2>
            <p>
                For decades, computer scientists tried to create digital money. Every attempt failed. The problem wasn't technology. It was physics and game theory.
            </p>
            <p>
                Remember the Prisoner's Dilemma from Stage 2? Any digital money system faces the same coordination problem: how do you prevent cheating when participants can't trust each other? How do you stop double-spending without a central authority?
            </p>
            <p>
                In 2008, someone calling themselves Satoshi Nakamoto published a solution. Not by inventing new technology. By combining three existing inventions in a way nobody had seen before. The result: <strong>Bitcoin</strong>.
            </p>

            <div class="key-insight">
                <div class="key-insight-title">Why Bitcoin Works</div>
                <p>
                    Bitcoin doesn't fight the problems from Stages 1-2. It uses them. It harnesses entropy through proof-of-work. It aligns incentives so cooperation is profitable. It enforces rules with code, not discretion. It eliminates the Cantillon Effect through fixed supply.
                </p>
                <p style="margin-top: 1rem;">
                    This module reveals the three building blocks that make this possible.
                </p>
            </div>
        </section>

        <!-- The Three Building Blocks -->
        <section class="content-section">
            <h2>The Three Inventions Bitcoin Combines</h2>

            <div class="blocks-grid">
                <div class="block-card">
                    <div class="block-icon"><span data-icon="lock"></span> </div>
                    <div class="block-title">1. Public-Key Cryptography</div>
                    <div class="block-description">
                        Prove you own something without revealing your secret. Like a lock that anyone can verify,
                        but only you can open. Invented in the 1970s, it powers digital signatures.
                    </div>
                </div>

                <div class="block-card">
                    <div class="block-icon">üî¢</div>
                    <div class="block-title">2. Hash Functions</div>
                    <div class="block-description">
                        Turn any data into a unique fingerprint. Change even one letter, and the entire fingerprint
                        changes. Impossible to reverse. The foundation of data integrity.
                    </div>
                </div>

                <div class="block-card">
                    <div class="block-icon"><span data-icon="lightning"></span> </div>
                    <div class="block-title">3. Proof-of-Work</div>
                    <div class="block-description">
                        Prove you spent real energy without trusting you. Makes lying expensive and truth cheap.
                        Anchors digital records in physical reality through computational work.
                    </div>
                </div>
            </div>
        </section>

        <!-- Deep Dive: Public-Key Cryptography -->
        <section class="content-section">
            <h2>Building Block 1: Public-Key Cryptography</h2>

            <h3>The Magic of Asymmetric Keys</h3>
            <p>
                Traditional encryption requires sharing a secret key. But how do you share that key securely?
                Public-key cryptography solved this with a mathematical miracle: two keys that work together,
                but one can be shared publicly.
            </p>

            <div class="properties-box">
                <h4>Key Properties:</h4>
                <ul>
                    <li><strong>Private Key:</strong> A secret number only you know. Like your password, but impossible to guess.</li>
                    <li><strong>Public Key:</strong> Derived from your private key. Can be shared with anyone safely.</li>
                    <li><strong>One-Way Function:</strong> Easy to create public key from private, impossible to reverse.</li>
                    <li><strong>Digital Signatures:</strong> Prove you approved a message without revealing your private key.</li>
                </ul>
            </div>

            <p>
                In Bitcoin, your private key controls your bitcoin. Your public key (hashed into an address)
                is where others send you bitcoin. Anyone can verify your signature, but only you can create it.
            </p>

            <div class="key-insight">
                <p>
                    <strong>Bitcoin's Use:</strong> Every bitcoin transaction is signed with a private key.
                    The network verifies the signature using the public key. No trust required; math proves ownership.
                </p>
            </div>
        </section>

        <!-- Deep Dive: Hash Functions -->
        <section class="content-section">
            <h2>Building Block 2: Hash Functions</h2>

            <h3>Digital Fingerprints</h3>
            <p>
                A hash function takes any input: a word, a book, an entire database, and produces a fixed-length
                "fingerprint" (hash). Change even one bit of the input, and the hash becomes completely different.
            </p>

            <div class="properties-box">
                <h4>Key Properties:</h4>
                <ul>
                    <li><strong>Deterministic:</strong> Same input always produces same hash</li>
                    <li><strong>One-Way:</strong> Can't reverse a hash to find the original data</li>
                    <li><strong>Avalanche Effect:</strong> Tiny change in input completely changes output</li>
                    <li><strong>Collision Resistant:</strong> Practically impossible to find two inputs with same hash</li>
                    <li><strong>Fixed Output:</strong> Always produces same-length result (e.g., SHA-256 = 256 bits)</li>
                </ul>
            </div>

            <p>
                Bitcoin uses SHA-256 (Secure Hash Algorithm, 256-bit). Every block references the previous block's
                hash, creating an unbreakable chain. Change any past transaction, and all subsequent hashes break.
            </p>

            <div class="key-insight">
                <p>
                    <strong>Bitcoin's Use:</strong> Blocks are chained together by hash. Each block's hash depends
                    on all previous blocks, making history immutable. The "blockchain" is literally a chain of hashes.
                </p>
            </div>
        </section>

        <!-- Deep Dive: Proof-of-Work -->
        <section class="content-section">
            <h2>Building Block 3: Proof-of-Work</h2>

            <h3>Making Lies Expensive</h3>
            <p>
                Proof-of-work anchors digital information in physical reality. To add a block to Bitcoin's ledger,
                miners must find a hash below a target value; which requires trillions of guesses. This consumes
                real energy, making attacks prohibitively expensive.
            </p>

            <div class="properties-box">
                <h4>Key Properties:</h4>
                <ul>
                    <li><strong>Difficult to Produce:</strong> Requires massive computational work (energy)</li>
                    <li><strong>Easy to Verify:</strong> Anyone can instantly check if work was done</li>
                    <li><strong>Probability-Based:</strong> Can't cheat; only way is to do the work</li>
                    <li><strong>Objective Cost:</strong> Ties digital security to real-world energy expenditure</li>
                    <li><strong>Difficulty Adjustment:</strong> Network adjusts difficulty to maintain 10-minute blocks</li>
                </ul>
            </div>

            <p>
                Imagine finding a combination lock by trying every possibility. Easy for others to verify the
                correct combination, but you had to try billions of wrong answers first. Proof-of-work is similar:
                miners search for a "nonce" that produces a hash below the target.
            </p>

            <div class="key-insight">
                <p>
                    <strong>Bitcoin's Use:</strong> To rewrite Bitcoin's history, an attacker would need to redo
                    all the proof-of-work for every block since the change. This gets exponentially more expensive
                    with each new block, making Bitcoin's past practically immutable.
                </p>
            </div>
        </section>

        <!-- Interactive Demo -->
        <section class="content-section">
            <h2>Interactive Demo: See the Building Blocks in Action</h2>

            <div class="demo-container">
                <div class="demo-header">
                    <h3>Experiment with Cryptographic Primitives</h3>
                    <p style="color: var(--text-dim);">See how these building blocks work in real-time</p>
                </div>

                <div class="demo-tabs">
                    <button class="demo-tab active" onclick="switchTab('hash')">Hash Function</button>
                    <button class="demo-tab" onclick="switchTab('pow')">Proof-of-Work</button>
                    <button class="demo-tab" onclick="switchTab('chain')">Blockchain</button>
                </div>

                <!-- Hash Function Demo -->
                <div id="hash-panel" class="demo-panel active">
                    <div class="demo-input-group">
                        <label>Enter any message:</label>
                        <input type="text" id="hashInput" class="demo-input" placeholder="Type something..." value="Hello, Bitcoin!" oninput="updateHash()">
                    </div>
                    <div class="demo-output">
                        <div class="output-label">SHA-256 Hash:</div>
                        <div id="hashOutput"></div>
                    </div>
                    <p style="color: var(--text-dim); margin-top: 1rem; font-size: 0.9rem;">
                        <strong>Try it:</strong> Change even one character and watch the entire hash change completely.
                        This is the "avalanche effect": a fundamental property that makes blockchains tamper-proof.
                    </p>
                </div>

                <!-- Proof-of-Work Demo -->
                <div id="pow-panel" class="demo-panel">
                    <div class="demo-input-group">
                        <label>Message to mine:</label>
                        <input type="text" id="powInput" class="demo-input" placeholder="Enter message" value="Bitcoin Block">
                    </div>
                    <div class="demo-input-group">
                        <label>Difficulty (leading zeros required):</label>
                        <input type="number" id="powDifficulty" class="demo-input" min="1" max="6" value="4">
                    </div>
                    <button class="demo-button" onclick="mineBlock()">‚õèÔ∏è Mine Block</button>
                    <div class="demo-output" id="powOutput" style="display: none;">
                        <div class="output-label">Mining Result:</div>
                        <div id="powResult"></div>
                    </div>
                </div>

                <!-- Blockchain Demo -->
                <div id="chain-panel" class="demo-panel">
                    <div id="blockchainDisplay"></div>
                    <button class="demo-button" onclick="addBlockToChain()" style="margin-top: 1rem;">
                        + Add New Block
                    </button>
                    <p style="color: var(--text-dim); margin-top: 1rem; font-size: 0.9rem;">
                        <strong>Notice:</strong> Each block's hash includes the previous block's hash,
                        creating an unbreakable chain. Change any block, and all future blocks become invalid.
                    </p>
                </div>
            </div>
        </section>

        <!-- Bitcoin's Innovation -->
        <section class="content-section">
            <h2>Bitcoin's Innovation: Combining the Blocks</h2>
            <p>
                These three building blocks existed independently for decades. Bitcoin's genius was combining them
                into a single system:
            </p>

            <ul style="color: var(--text-dim); margin-left: 2rem; line-height: 2;">
                <li><strong>Public-key crypto</strong> lets you own bitcoin without trusting anyone</li>
                <li><strong>Hash functions</strong> chain blocks together into immutable history</li>
                <li><strong>Proof-of-work</strong> makes rewriting history prohibitively expensive</li>
            </ul>

            <div class="key-insight" style="margin-top: 2rem;">
                <p>
                    <strong>The Result:</strong> A monetary system with no central authority, no trusted third parties,
                    and no way to change the past. Mathematical trust replaces institutional trust. This is why Bitcoin
                    works and why it's revolutionary.
                </p>
            </div>
        </section>

        <!-- Interactive Reflection -->
        <section class="content-section">
            <h2>ü§î Test Your Understanding</h2>
            <p style="color: var(--text-dim); margin-bottom: 2rem;">
                Answer at your own depth: quick thoughts or deep analysis. Get instant feedback on your grasp of the concepts.
            </p>

            <!-- Question 1: Trust Without Authority -->
            <div class="question-section">
                <h4>Question 1: Trust Without Authority</h4>
                <p style="color: var(--text-dim); margin-bottom: 1rem;">
                    Before Bitcoin, digital trust always required a trusted third party (banks, payment processors, etc.).
                    How do these three building blocks eliminate that requirement?
                </p>

                <div class="reflection-tabs">
                    <button class="reflection-tab active" onclick="switchReflectionTab(1, 'quick', event)" role="tab" aria-selected="true" aria-controls="q1-quick"><span data-icon="lightning"></span> Quick (1-2 min)</button>
                    <button class="reflection-tab" onclick="switchReflectionTab(1, 'deep', event)" role="tab" aria-selected="false" aria-controls="q1-deep"><span data-icon="target"></span> Deep (5 min)</button>
                </div>

                <div id="q1-quick" class="reflection-panel active">
                    <textarea id="question1-quick" placeholder="In 2-3 sentences: Which building block matters most for removing third parties?" maxlength="300"></textarea>
                    <div class="char-counter"><span id="q1-quick-count">0</span>/300 characters</div>
                    <button class="feedback-btn" onclick="checkReflection(1, 'quick')">Get Feedback</button>
                    <div id="feedback1-quick" class="feedback-box" style="display: none;"></div>
                </div>

                <div id="q1-deep" class="reflection-panel">
                    <textarea id="question1-deep" placeholder="Deeper analysis: Explain how all three blocks work together. What makes mathematical trust stronger than institutional trust?" style="min-height: 150px;"></textarea>
                    <button class="feedback-btn" onclick="checkReflection(1, 'deep')">Get Feedback</button>
                    <div id="feedback1-deep" class="feedback-box" style="display: none;"></div>
                </div>
                <div class="save-indicator">‚úì Auto-saved locally</div>
            </div>

            <!-- Question 2: The Energy Connection -->
            <div class="question-section">
                <h4>Question 2: The Energy Connection</h4>
                <p style="color: var(--text-dim); margin-bottom: 1rem;">
                    Proof-of-work ties digital security to physical energy. Why is this important?
                </p>

                <div class="reflection-tabs">
                    <button class="reflection-tab active" onclick="switchReflectionTab(2, 'quick', event)" role="tab" aria-selected="true" aria-controls="q2-quick"><span data-icon="lightning"></span> Quick (1-2 min)</button>
                    <button class="reflection-tab" onclick="switchReflectionTab(2, 'deep', event)" role="tab" aria-selected="false" aria-controls="q2-deep"><span data-icon="target"></span> Deep (5 min)</button>
                </div>

                <div id="q2-quick" class="reflection-panel active">
                    <div style="margin-bottom: 1rem;">
                        <label style="display: block; margin-bottom: 0.5rem; color: var(--text-dim);">
                            What would happen if Bitcoin's ledger could be updated without energy expenditure?
                        </label>
                        <select id="question2-choice" class="choice-select">
                            <option value="">Select your answer...</option>
                            <option value="a">Anyone could spam fake transactions</option>
                            <option value="b">History could be rewritten infinitely</option>
                            <option value="c">The network would be more efficient</option>
                            <option value="d">Both A and B</option>
                        </select>
                    </div>
                    <button class="feedback-btn" onclick="checkReflection(2, 'quick')">Check Answer</button>
                    <div id="feedback2-quick" class="feedback-box" style="display: none;"></div>
                </div>

                <div id="q2-deep" class="reflection-panel">
                    <textarea id="question2-deep" placeholder="Connect energy to security: Why does Bitcoin's need for energy actually strengthen the system? Reference Stage 4.1 concepts if you've explored them." style="min-height: 150px;"></textarea>
                    <button class="feedback-btn" onclick="checkReflection(2, 'deep')">Get Feedback</button>
                    <div id="feedback2-deep" class="feedback-box" style="display: none;"></div>
                </div>
                <div class="save-indicator">‚úì Auto-saved locally</div>
            </div>

            <!-- Question 3: Real-World Application -->
            <div class="question-section">
                <h4>Question 3: Apply It</h4>
                <p style="color: var(--text-dim); margin-bottom: 1rem;">
                    Beyond money, where else could these building blocks eliminate the need for trusted third parties?
                </p>

                <div class="checklist-reflection">
                    <p style="color: var(--text-dim); font-size: 0.95rem; margin-bottom: 1rem;">Select scenarios where this applies:</p>
                    <label class="checkbox-label">
                        <input type="checkbox" id="app-voting" onchange="updateApplicationFeedback()">
                        Voting systems (verify votes without trusting election officials)
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="app-property" onchange="updateApplicationFeedback()">
                        Property records (ownership without government registries)
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="app-identity" onchange="updateApplicationFeedback()">
                        Digital identity (prove who you are without Facebook/Google)
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="app-supply" onchange="updateApplicationFeedback()">
                        Supply chains (track products without middlemen)
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="app-social" onchange="updateApplicationFeedback()">
                        Social media (none; platforms inherently need curation)
                    </label>
                </div>
                <div id="feedback3" class="feedback-box" style="display: none; margin-top: 1rem;"></div>
                <div class="save-indicator">‚úì Auto-saved locally</div>
            </div>
        </section>

        <!-- Module Navigation -->
        <nav class="module-navigation">
            <a href="/paths/principled/stage-3/" class="nav-btn nav-btn-secondary">
                ‚Üê Back to Stage 3
            </a>
            <a href="/paths/principled/stage-3/?completed=true&amp;module=1" class="nav-btn nav-btn-primary">
                Complete Module 1 ‚Üí
            </a>
        </nav>
    </div>

    <script>
        // Simple hash function for demo (not cryptographically secure)
        async function simpleHash(str) {
            const encoder = new TextEncoder();
            const data = encoder.encode(str);
            const hashBuffer = await crypto.subtle.digest('SHA-256', data);
            const hashArray = Array.from(new Uint8Array(hashBuffer));
            return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
        }

        // Update hash output
        async function updateHash() {
            const input = document.getElementById('hashInput').value;
            const hash = await simpleHash(input);
            document.getElementById('hashOutput').textContent = hash;
        }

        // Mine a block
        let mining = false;
        async function mineBlock() {
            if (mining) return;
            mining = true;

            const message = document.getElementById('powInput').value;
            const difficulty = parseInt(document.getElementById('powDifficulty').value);
            const target = '0'.repeat(difficulty);

            const outputDiv = document.getElementById('powOutput');
            const resultDiv = document.getElementById('powResult');
            outputDiv.style.display = 'block';
            resultDiv.innerHTML = '<div style="color: var(--accent-bronze);">‚õèÔ∏è Mining... (trying different nonces)</div>';

            let nonce = 0;
            const startTime = Date.now();

            // Use setTimeout to avoid blocking UI
            const mine = async () => {
                for (let i = 0; i < 10000; i++) {
                    const data = message + nonce;
                    const hash = await simpleHash(data);

                    if (hash.startsWith(target)) {
                        const elapsed = ((Date.now() - startTime) / 1000).toFixed(2);
                        resultDiv.innerHTML = `
                            <div style="color: var(--success-green); margin-bottom: 0.5rem;">‚úì Block mined!</div>
                            <div><strong>Nonce:</strong> ${nonce}</div>
                            <div><strong>Hash:</strong> ${hash}</div>
                            <div><strong>Attempts:</strong> ${nonce + 1}</div>
                            <div><strong>Time:</strong> ${elapsed}s</div>
                            <div style="margin-top: 0.5rem; color: var(--text-dim); font-size: 0.85rem;">
                                The hash starts with ${difficulty} zeros, meeting the difficulty requirement!
                            </div>
                        `;
                        mining = false;
                        return;
                    }
                    nonce++;
                }

                // Continue mining
                setTimeout(mine, 0);
            };

            mine();
        }

        // Blockchain demo
        let blockchain = [];
        let blockCounter = 0;

        async function addBlockToChain() {
            const prevHash = blockchain.length > 0 ? blockchain[blockchain.length - 1].hash : '0'.repeat(64);
            const data = `Block ${blockCounter} Data`;
            const timestamp = Date.now();
            const blockData = `${prevHash}${data}${timestamp}`;
            const hash = await simpleHash(blockData);

            blockchain.push({ number: blockCounter, data, prevHash, hash, timestamp });
            blockCounter++;

            displayBlockchain();
        }

        function displayBlockchain() {
            const display = document.getElementById('blockchainDisplay');
            display.innerHTML = blockchain.map((block, index) => `
                <div style="background: var(--secondary-dark); border: 2px solid rgba(139, 111, 71, 0.3);
                            border-radius: 8px; padding: 1rem; margin-bottom: 1rem;">
                    <div style="color: var(--accent-bronze); font-weight: 600; margin-bottom: 0.5rem;">
                        Block #${block.number}
                    </div>
                    <div style="font-family: 'Courier New', monospace; font-size: 0.85rem; color: var(--text-dim);">
                        <div><strong>Data:</strong> ${block.data}</div>
                        <div><strong>Prev Hash:</strong> ${block.prevHash.substring(0, 16)}...</div>
                        <div><strong>This Hash:</strong> ${block.hash.substring(0, 16)}...</div>
                    </div>
                    ${index === blockchain.length - 1 ?
                        '<div style="color: var(--success-green); margin-top: 0.5rem; font-size: 0.85rem;">‚Üê Latest Block</div>' :
                        ''}
                </div>
            `).join('');
        }

        // Tab switching
        function switchTab(tab) {
            document.querySelectorAll('.demo-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.demo-panel').forEach(p => p.classList.remove('active'));

            event.target.classList.add('active');
            document.getElementById(`${tab}-panel`).classList.add('active');
        }

        // Interactive Reflection System with Feedback
        const STORAGE_KEY = 'principled-stage3-module1-reflections';

        function switchReflectionTab(questionNum, level, event) {
            // Hide all panels for this question
            document.querySelectorAll(`#q${questionNum}-quick, #q${questionNum}-deep`).forEach(panel => {
                panel.classList.remove('active');
                panel.setAttribute('aria-hidden', 'true');
            });
            // Remove active from all tabs for this question
            event.target.parentElement.querySelectorAll('.reflection-tab').forEach(tab => {
                tab.classList.remove('active');
                tab.setAttribute('aria-selected', 'false');
            });
            // Show selected panel
            const panel = document.getElementById(`q${questionNum}-${level}`);
            panel.classList.add('active');
            panel.setAttribute('aria-hidden', 'false');
            // Add active to clicked tab
            event.target.classList.add('active');
            event.target.setAttribute('aria-selected', 'true');
        }

        function checkReflection(questionNum, level) {
            const feedbackDiv = document.getElementById(`feedback${questionNum}-${level}`);

            if (questionNum === 1 && level === 'quick') {
                const text = document.getElementById('question1-quick').value.toLowerCase();
                let feedback = '';

                if (text.length < 30) {
                    feedback = `<h5><span data-icon="lightbulb"></span> Hint</h5><p>Try writing 2-3 sentences. Which building block lets you own bitcoin without a bank?</p>`;
                    feedbackDiv.className = 'feedback-box hint';
                } else if (text.length < 50) {
                    feedback = `<h5>Good start!</h5><p>You're thinking about this. Can you explain <em>why</em> that building block removes the need for intermediaries?</p>`;
                    feedbackDiv.className = 'feedback-box hint';
                } else if (text.includes('public') || text.includes('crypto') || text.includes('key')) {
                    feedback = `<h5>‚úì Great Start!</h5><p>You identified public-key cryptography‚Äîthat's key! It lets you own bitcoin without asking permission. Want to explore how it works with the other building blocks? Try the Deep reflection.</p>`;
                    feedbackDiv.className = 'feedback-box positive';
                } else if (text.includes('proof') || text.includes('work') || text.includes('energy')) {
                    feedback = `<h5>‚úì Good Insight!</h5><p>Proof-of-work is important for security, but think about <em>ownership</em> first. How do you control your bitcoin without a bank holding it for you? Hint: public-key cryptography.</p>`;
                    feedbackDiv.className = 'feedback-box hint';
                } else {
                    feedback = `<h5>Think About...</h5><p>Consider: How does Bitcoin let you <em>own</em> money without a bank account? Which cryptographic tool enables that?</p>`;
                    feedbackDiv.className = 'feedback-box hint';
                }

                feedbackDiv.innerHTML = feedback;
                feedbackDiv.style.display = 'block';
            }

            if (questionNum === 1 && level === 'deep') {
                const text = document.getElementById('question1-deep').value.toLowerCase();
                let feedback = '';

                if (text.length < 100) {
                    feedback = `<h5><span data-icon="lightbulb"></span> Go Deeper</h5><p>You're on the right track! Try explaining: (1) How public-key crypto enables ownership, (2) How hash functions create immutability, and (3) How proof-of-work prevents rewriting history.</p>`;
                    feedbackDiv.className = 'feedback-box hint';
                } else {
                    const hasOwnership = text.match(/\b(own|control|private.?key|custody|custodial|self.?custody|sign|authority|permission|non.?custodial)\b/);
                    const hasImmutability = text.match(/\b(immut|chain|hash|tamper|alter|chang|rewrite|modify)\b/);
                    const hasEnergy = text.match(/\b(energy|proof|cost|work|expensive|difficult|computation)\b/);
                    const score = [hasOwnership, hasImmutability, hasEnergy].filter(Boolean).length;

                    if (score === 3) {
                        feedback = `<h5>‚úì Excellent Analysis!</h5><p>You've connected all three building blocks! You understand that mathematical trust (crypto + hashing + energy) removes the need for institutional trust. This is the foundation of Bitcoin's revolution.</p><p style="margin-top: 0.75rem; padding-top: 0.75rem; border-top: 1px solid rgba(139, 111, 71, 0.3);"><strong>Next:</strong> Module 2 explores how this ledger evolved from clay tablets to blockchain.</p>`;
                        feedbackDiv.className = 'feedback-box positive';
                    } else if (score === 2) {
                        feedback = `<h5>‚úì Solid Understanding!</h5><p>You've covered ${score} of 3 key concepts. ${!hasOwnership ? 'Add: How private keys enable ownership without permission. ' : ''}${!hasImmutability ? 'Add: How hash chains prevent tampering. ' : ''}${!hasEnergy ? 'Add: Why energy expenditure matters.' : ''}</p>`;
                        feedbackDiv.className = 'feedback-box positive';
                    } else {
                        feedback = `<h5>Keep Developing</h5><p>Try addressing: How does each building block contribute? Public-key crypto (ownership), Hash functions (immutability), Proof-of-work (security via energy).</p>`;
                        feedbackDiv.className = 'feedback-box hint';
                    }
                }

                feedbackDiv.innerHTML = feedback;
                feedbackDiv.style.display = 'block';
            }

            if (questionNum === 2 && level === 'quick') {
                const choice = document.getElementById('question2-choice').value;
                let feedback = '';

                if (!choice) {
                    feedback = `<h5>Select an Answer</h5><p>Choose what you think would happen if Bitcoin didn't require energy for updates.</p>`;
                    feedbackDiv.className = 'feedback-box hint';
                } else if (choice === 'd') {
                    feedback = `<h5>‚úì Correct!</h5><p>Both A and B are true. Without energy costs: (1) Anyone could spam millions of fake transactions for free, and (2) Attackers could rewrite history endlessly with no consequences. Energy makes lying expensive and honesty cheap.</p><p style="margin-top: 0.75rem; padding-top: 0.75rem; border-top: 1px solid rgba(139, 111, 71, 0.3);"><strong>Deep Dive:</strong> Stage 4.1 (Physics of Proof) explains the thermodynamics behind this.</p>`;
                    feedbackDiv.className = 'feedback-box positive';
                } else if (choice === 'c') {
                    feedback = `<h5>‚ùå Not Quite</h5><p>While it might <em>seem</em> more efficient, removing energy requirements would actually make Bitcoin insecure. Without energy costs, attackers could spam fake transactions AND rewrite history infinitely at zero cost. The answer is <strong>D (Both A and B)</strong>.</p>`;
                    feedbackDiv.className = 'feedback-box hint';
                } else if (choice === 'a') {
                    feedback = `<h5>‚úì Partially Correct</h5><p>You're right‚Äîtransaction spam would be a problem! Anyone could flood the network for free. But what about <em>rewriting history</em>? Without energy costs, attackers could also alter past transactions infinitely. The complete answer is <strong>D (Both A and B)</strong>.</p>`;
                    feedbackDiv.className = 'feedback-box hint';
                } else if (choice === 'b') {
                    feedback = `<h5>‚úì Partially Correct</h5><p>You're right‚Äîhistory could be rewritten endlessly! Attackers could alter past transactions at zero cost. But what about <em>transaction spam</em>? Without energy requirements, anyone could also flood the network with fake transactions. The complete answer is <strong>D (Both A and B)</strong>.</p>`;
                    feedbackDiv.className = 'feedback-box hint';
                }

                feedbackDiv.innerHTML = feedback;
                feedbackDiv.style.display = 'block';

                // Save choice
                saveReflection('q2-choice', choice);
            }

            if (questionNum === 2 && level === 'deep') {
                const text = document.getElementById('question2-deep').value;
                let feedback = '';

                if (text.length < 100) {
                    feedback = `<h5><span data-icon="lightbulb"></span> Expand Your Thinking</h5><p>Consider: Why does tying digital security to physical energy matter? What does energy expenditure prove? How does it connect to the real world?</p>`;
                    feedbackDiv.className = 'feedback-box hint';
                } else {
                    const hasThermodynamics = text.toLowerCase().includes('thermo') || text.toLowerCase().includes('physics') || text.toLowerCase().includes('law');
                    const hasCost = text.toLowerCase().includes('cost') || text.toLowerCase().includes('expensive') || text.toLowerCase().includes('expensive');
                    const hasAnchor = text.toLowerCase().includes('anchor') || text.toLowerCase().includes('physical') || text.toLowerCase().includes('real world');

                    if (hasThermodynamics) {
                        feedback = `<h5>‚úì Advanced Understanding!</h5><p>You referenced thermodynamics‚Äîexcellent! Energy creates an unforgeable link between the digital and physical worlds. You can't cheat the laws of physics, so you can't cheat Bitcoin's proof-of-work.</p><p style="margin-top: 0.75rem; padding-top: 0.75rem; border-top: 1px solid rgba(139, 111, 71, 0.3);"><strong>Recommended:</strong> Stage 4.1 deep-dives into entropy, Landauer's principle, and the physics of proof.</p>`;
                        feedbackDiv.className = 'feedback-box positive';
                    } else if (hasCost || hasAnchor) {
                        feedback = `<h5>‚úì Good Connection!</h5><p>You understand that energy creates costs and anchors Bitcoin to reality. To go deeper: explore how thermodynamics (the second law, entropy, and Landauer's principle) makes energy expenditure irreversible.</p>`;
                        feedbackDiv.className = 'feedback-box positive';
                    } else {
                        feedback = `<h5>Keep Going</h5><p>Think about: Energy expenditure is <em>irreversible</em> (you can't un-burn electricity). This creates a physical record that can't be faked. Digital bits alone can be copied infinitely‚Äîenergy can't.</p>`;
                        feedbackDiv.className = 'feedback-box hint';
                    }
                }

                feedbackDiv.innerHTML = feedback;
                feedbackDiv.style.display = 'block';
            }

            // Save all reflections
            saveReflection(`q${questionNum}-${level}`,
                level === 'quick' && questionNum === 2 ?
                document.getElementById('question2-choice').value :
                document.getElementById(`question${questionNum}-${level}`).value
            );
        }

        function updateApplicationFeedback() {
            const voting = document.getElementById('app-voting').checked;
            const property = document.getElementById('app-property').checked;
            const identity = document.getElementById('app-identity').checked;
            const supply = document.getElementById('app-supply').checked;
            const social = document.getElementById('app-social').checked;

            const feedbackDiv = document.getElementById('feedback3');
            let feedback = '';
            let score = 0;

            if (voting) score++;
            if (property) score++;
            if (identity) score++;
            if (supply) score++;

            if (social) {
                feedback = `<h5>‚ö†Ô∏è Think Again</h5><p>Social media <strong>does</strong> need moderation and curation‚Äîspam filters, content moderation, and recommendation algorithms require centralized decision-making. Not everything benefits from decentralization!</p>`;
                feedbackDiv.className = 'feedback-box hint';
            } else if (score === 4) {
                feedback = `<h5>‚úì Perfect!</h5><p>You identified all four valid applications! These building blocks eliminate trusted intermediaries anywhere <strong>record-keeping</strong> matters: voting (ballots), property (deeds), identity (credentials), and supply chains (provenance).</p><p style="margin-top: 0.75rem; padding-top: 0.75rem; border-top: 1px solid rgba(139, 111, 71, 0.3);"><strong>Explore More:</strong> Stage 5.3 (Future of Human Coordination) deep-dives into these applications.</p>`;
                feedbackDiv.className = 'feedback-box positive';
            } else if (score >= 2) {
                feedback = `<h5>‚úì Good Start!</h5><p>You've identified ${score} applications. The pattern: anywhere you need <strong>unforgeable records</strong> without trusted authorities, these building blocks apply. ${!voting ? 'Voting systems could use cryptographic proofs. ' : ''}${!property ? 'Property records could be blockchain-based. ' : ''}${!identity ? 'Digital identity could be self-sovereign. ' : ''}${!supply ? 'Supply chains could track goods cryptographically.' : ''}</p>`;
                feedbackDiv.className = 'feedback-box hint';
            } else if (score > 0) {
                feedback = `<h5>Keep Thinking</h5><p>You're on the right track with ${score} selection${score > 1 ? 's' : ''}. Ask: Where else do we currently rely on trusted third parties to maintain records?</p>`;
                feedbackDiv.className = 'feedback-box hint';
            }

            if (score > 0 || social) {
                feedbackDiv.innerHTML = feedback;
                feedbackDiv.style.display = 'block';
            }

            // Save selections
            saveReflection('q3-apps', JSON.stringify({voting, property, identity, supply, social}));
        }

        function saveReflection(key, value) {
            const reflections = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}');
            reflections[key] = value;
            localStorage.setItem(STORAGE_KEY, JSON.stringify(reflections));
        }

        function loadReflections() {
            const reflections = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}');

            // Load text inputs
            ['question1-quick', 'question1-deep', 'question2-deep'].forEach(id => {
                const elem = document.getElementById(id);
                if (elem && reflections[id]) {
                    elem.value = reflections[id];
                }
            });

            // Load choice
            if (reflections['q2-choice']) {
                const select = document.getElementById('question2-choice');
                if (select) select.value = reflections['q2-choice'];
            }

            // Load checkboxes
            if (reflections['q3-apps']) {
                const apps = JSON.parse(reflections['q3-apps']);
                document.getElementById('app-voting').checked = apps.voting || false;
                document.getElementById('app-property').checked = apps.property || false;
                document.getElementById('app-identity').checked = apps.identity || false;
                document.getElementById('app-supply').checked = apps.supply || false;
                document.getElementById('app-social').checked = apps.social || false;
            }
        }

        // Character counter for quick reflection
        const quickInput = document.getElementById('question1-quick');
        if (quickInput) {
            quickInput.addEventListener('input', (e) => {
                document.getElementById('q1-quick-count').textContent = e.target.value.length;
                saveReflection('question1-quick', e.target.value);
            });
        }

        // Auto-save all textareas
        ['question1-quick', 'question1-deep', 'question2-deep'].forEach(id => {
            const elem = document.getElementById(id);
            if (elem) {
                elem.addEventListener('input', (e) => {
                    saveReflection(id, e.target.value);
                });
            }
        });

        // Initialize
        loadReflections();

        // Initialize character counter after loading
        if (quickInput) {
            document.getElementById('q1-quick-count').textContent = quickInput.value.length;
        }

        // Show Q3 feedback if selections were previously saved
        updateApplicationFeedback();

        updateHash();
        addBlockToChain(); // Add genesis block
    </script>

    <!-- Animated Icon Library -->
    <script src="/js/icon-library.js"></script>
    <script>
        // Inject icons after DOM loads
        document.addEventListener('DOMContentLoaded', function() {
            if (window.IconLibrary) {
                document.querySelectorAll('[data-icon]').forEach(function(element) {
                    var iconName = element.getAttribute('data-icon');
                    if (iconName) {
                        var iconHTML = IconLibrary.get(iconName, 20, true);
                        var span = document.createElement('span');
                        span.innerHTML = iconHTML;
                        span.className = 'icon-inline';
                        span.style.marginRight = '0.5rem';
                        span.style.display = 'inline-block';
                        span.style.verticalAlign = 'middle';
                        element.insertBefore(span, element.firstChild);
                    }
                });
            }
        });
    </script>


    <!-- Navigation Context (return-to-path functionality) -->
    <script src="/js/navigation-context.js"></script>
<script src="/js/membership-gate.js"></script>
</body></html>