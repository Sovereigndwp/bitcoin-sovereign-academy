<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Module 2.2: The Corruption Curve | The Principled Path</title>
    <meta name="description" content="How monetary systems degrade as trust layers increase.">

    <style>
        :root {
            --accent-bronze: #8B6F47;
            --accent-bronze-light: #A0826D;
            --primary-dark: #1a1a1a;
            --secondary-dark: #2d2d2d;
            --accent-bronze: #8B6F47;
            --accent-bronze-light: #A0826D;
            --accent-bronze-light: #A0826D;
            --text-light: #e0e0e0;
            --text-dim: #999;
            --border-color: rgba(139, 111, 71, 0.2);
            --accent-green: #4caf50;
            --accent-red: #ef4444;
            --accent-purple: #9c27b0;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 50%, #0f0f0f 100%);
            color: var(--text-light);
            line-height: 1.6;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* Navigation */
        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-bottom: 2rem;
        }

        .back-button {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.25rem;
            background: rgba(139, 111, 71, 0.1);
            border: 2px solid var(--accent-bronze);
            border-radius: 0.5rem;
            color: var(--accent-bronze);
            text-decoration: none;
            font-weight: 600;
            transition: all 0.2s ease;
        }

        .back-button:hover {
            background: rgba(139, 111, 71, 0.2);
            transform: translateX(-3px);
        }

        /* Module Header */
        .module-header {
            text-align: center;
            padding: 3rem 2rem;
            background: radial-gradient(circle at center, rgba(139, 111, 71, 0.15) 0%, transparent 70%);
            border-radius: 1.5rem;
            margin-bottom: 3rem;
        }

        .module-number {
            font-size: 1.2rem;
            color: var(--accent-bronze);
            opacity: 0.7;
            margin-bottom: 0.5rem;
        }

        .module-header h1 {
            font-size: 2.5rem;
            color: var(--accent-bronze);
            margin-bottom: 1rem;
        }

        .module-subtitle {
            font-size: 1.3rem;
            color: var(--text-dim);
            font-style: italic;
        }

        /* Content Sections */
        .content-section {
            background: var(--secondary-dark);
            border: 2px solid var(--border-color);
            border-radius: 1rem;
            padding: 2.5rem;
            margin: 2rem 0;
        }

        .content-section h2 {
            color: var(--accent-bronze);
            font-size: 1.8rem;
            margin-bottom: 1.5rem;
        }

        .content-section p {
            font-size: 1.1rem;
            line-height: 1.8;
            margin-bottom: 1.5rem;
        }

        .key-insight {
            background: rgba(139, 111, 71, 0.1);
            border-left: 4px solid var(--accent-bronze);
            padding: 1.5rem;
            margin: 2rem 0;
            border-radius: 0.5rem;
        }

        .key-insight-title {
            color: var(--accent-bronze);
            font-weight: 700;
            margin-bottom: 0.75rem;
            font-size: 1.1rem;
        }

        /* Interactive Demo */
        .demo-section {
            background: var(--secondary-dark);
            border: 3px solid var(--accent-bronze);
            border-radius: 1rem;
            padding: 2.5rem;
            margin: 3rem 0;
        }

        .demo-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .demo-header h3 {
            color: var(--accent-bronze);
            font-size: 1.8rem;
            margin-bottom: 0.5rem;
        }

        .demo-description {
            color: var(--text-dim);
            font-size: 1.05rem;
        }

        .demo-canvas {
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid var(--border-color);
            border-radius: 0.75rem;
            padding: 2rem;
            margin: 2rem 0;
        }

        .economy-layers {
            display: grid;
            gap: 1rem;
            margin: 2rem 0;
        }

        .layer-card {
            background: rgba(0, 0, 0, 0.5);
            border: 2px solid var(--border-color);
            border-radius: 0.75rem;
            padding: 1.5rem;
            display: grid;
            grid-template-columns: auto 1fr auto;
            gap: 1.5rem;
            align-items: center;
            transition: all 0.3s ease;
        }

        .layer-card.first-receivers {
            border-color: var(--accent-green);
            background: rgba(76, 175, 80, 0.1);
        }

        .layer-card.middle-class {
            border-color: #ffaa00;
            background: rgba(255, 170, 0, 0.1);
        }

        .layer-card.last-receivers {
            border-color: var(--accent-red);
            background: rgba(239, 68, 68, 0.1);
        }

        .layer-number {
            font-size: 2rem;
            font-weight: 700;
            color: var(--accent-bronze);
            width: 3rem;
            text-align: center;
        }

        .layer-info h4 {
            color: var(--accent-bronze);
            margin-bottom: 0.5rem;
        }

        .layer-description {
            color: var(--text-dim);
            font-size: 0.95rem;
        }

        .purchasing-power {
            text-align: center;
        }

        .pp-value {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.25rem;
        }

        .pp-value.gain {
            color: var(--accent-green);
        }

        .pp-value.neutral {
            color: #ffaa00;
        }

        .pp-value.loss {
            color: var(--accent-red);
        }

        .pp-label {
            font-size: 0.8rem;
            color: var(--text-dim);
        }

        .money-flow {
            background: rgba(0, 0, 0, 0.5);
            border: 2px solid var(--border-color);
            border-radius: 0.75rem;
            padding: 1.5rem;
            margin: 2rem 0;
        }

        .flow-step {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin: 1rem 0;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 0.5rem;
        }

        .flow-arrow {
            font-size: 2rem;
            color: var(--accent-bronze);
        }

        .flow-text {
            flex: 1;
        }

        .demo-controls {
            display: grid;
            gap: 1rem;
            margin: 2rem 0;
        }

        .demo-button {
            padding: 1rem 2rem;
            background: linear-gradient(135deg, var(--accent-bronze), var(--accent-bronze));
            color: white;
            border: none;
            border-radius: 0.5rem;
            font-weight: 700;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .demo-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(139, 111, 71, 0.4);
        }

        .demo-button.danger {
            background: linear-gradient(135deg, #ef4444, #dc2626);
        }

        .demo-button.secondary {
            background: rgba(139, 111, 71, 0.2);
            border: 2px solid var(--accent-bronze);
            color: var(--accent-bronze);
        }

        .demo-output {
            background: rgba(0, 0, 0, 0.5);
            border: 2px solid var(--border-color);
            border-radius: 0.5rem;
            padding: 1.5rem;
            margin: 1.5rem 0;
            min-height: 80px;
        }

        .output-message {
            color: var(--text-light);
            font-size: 1.05rem;
            margin: 0.5rem 0;
        }

        /* Socratic Questions */
        .socratic-section {
            background: linear-gradient(135deg, rgba(139, 111, 71, 0.1), rgba(139, 111, 71, 0.1));
            border: 2px solid var(--accent-bronze);
            border-radius: 1rem;
            padding: 2.5rem;
            margin: 3rem 0;
        }

        .socratic-section h3 {
            color: var(--accent-bronze);
            font-size: 1.6rem;
            margin-bottom: 2rem;
            text-align: center;
        }

        .question-card {
            background: var(--secondary-dark);
            border: 1px solid var(--border-color);
            border-radius: 0.75rem;
            padding: 1.5rem;
            margin: 1.5rem 0;
        }

        .question-number {
            color: var(--accent-bronze);
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .question-text {
            font-size: 1.1rem;
            color: var(--text-light);
            margin-bottom: 1rem;
            line-height: 1.7;
        }

        .reflection-area {
            width: 100%;
            min-height: 100px;
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid var(--border-color);
            border-radius: 0.5rem;
            padding: 1rem;
            color: var(--text-light);
            font-family: inherit;
            font-size: 1rem;
            resize: vertical;
        }

        .reflection-area:focus {
            outline: none;
            border-color: var(--accent-bronze);
        }

        /* Navigation Footer */
        .module-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 3rem 0;
            padding: 2rem;
            background: var(--secondary-dark);
            border-radius: 1rem;
        }

        .nav-link {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            background: linear-gradient(135deg, var(--accent-bronze), var(--accent-bronze));
            color: white;
            border-radius: 0.5rem;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .nav-link:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(139, 111, 71, 0.4);
        }

        .progress-indicator {
            text-align: center;
            color: var(--text-dim);
        }

        /* Interactive Reflection System */
        .reflection-tabs { display: flex; gap: 0.5rem; margin-bottom: 1.5rem; border-bottom: 2px solid rgba(139, 111, 71, 0.2); padding-bottom: 0.5rem; }
        .reflection-tab { background: transparent; color: var(--text-dim); border: 2px solid rgba(139, 111, 71, 0.3); padding: 0.5rem 1.25rem; border-radius: 8px 8px 0 0; font-weight: 600; font-size: 0.95rem; cursor: pointer; transition: all 0.3s ease; }
        .reflection-tab.active { background: linear-gradient(135deg, rgba(139, 111, 71, 0.2), rgba(139, 111, 71, 0.1)); color: var(--accent-bronze); border-color: var(--accent-bronze); }
        .reflection-panel { display: none; padding: 1.5rem; background: rgba(26, 26, 26, 0.8); border-radius: 0 8px 8px 8px; border: 2px solid rgba(139, 111, 71, 0.2); }
        .reflection-panel.active { display: block; }
        .choice-select { width: 100%; padding: 1rem; background: rgba(0, 0, 0, 0.3); border: 2px solid var(--border-color); border-radius: 0.5rem; color: var(--text-light); font-size: 1rem; cursor: pointer; }
        .choice-select:focus { outline: none; border-color: var(--accent-bronze); }
        .feedback-box { margin-top: 1.5rem; padding: 1.5rem; border-radius: 0.5rem; border: 2px solid; display: none; }
        .feedback-box.positive { background: rgba(76, 175, 80, 0.1); border-color: #4caf50; color: var(--text-light); }
        .feedback-box.hint { background: rgba(255, 152, 0, 0.1); border-color: #8B6F47; color: var(--text-light); }
        .feedback-box h5 { margin-top: 0; margin-bottom: 0.5rem; color: inherit; }
        .checklist-reflection { display: flex; flex-direction: column; gap: 0.75rem; }
        .checkbox-label { display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem; background: rgba(0, 0, 0, 0.3); border-radius: 0.5rem; cursor: pointer; transition: background 0.2s ease; }
        .checkbox-label:hover { background: rgba(0, 0, 0, 0.5); }
        .checkbox-label input[type="checkbox"] { width: 1.25rem; height: 1.25rem; cursor: pointer; }

        /* Responsive */
        @media (max-width: 768px) {
            .layer-card {
                grid-template-columns: 1fr;
                text-align: center;
            }

            .module-header h1 {
                font-size: 2rem;
            }

            .module-nav {
                flex-direction: column;
                gap: 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Navigation -->
        <div class="nav-buttons">
            <a href="/paths/principled/stage-2/" class="back-button">
                ← Back to Stage 2
            </a>
        </div>

        <!-- Module Header -->
        <header class="module-header">
            <div class="module-number">Stage 2 • Module 2</div>
            <h1>The Corruption Curve</h1>
            <p class="module-subtitle">Monetary systems degrade as trust layers increase</p>
        </header>

        <!-- Introduction -->
        <section class="content-section">
            <h2>The Cantillon Effect</h2>
            <p>
                In 1730, economist Richard Cantillon observed something critical: <strong>when new money enters the economy,
                it doesn't affect everyone equally</strong>. Those who receive it first can spend it before prices rise.
                Those who receive it last — or never — pay higher prices without increased income.
            </p>
            <p>
                This isn't a side effect of money printing. It's <strong>wealth transfer disguised as monetary policy</strong>.
                The closer you are to the money printer, the more you benefit. The farther away, the more you lose.
            </p>

            <div class="key-insight">
                <div class="key-insight-title">💰 Core Principle</div>
                <p>
                    Inflation isn't just rising prices — it's systematic theft from the poor and middle class to benefit
                    those with first access to new money. Banks, governments, and financial elites spend newly created
                    currency before prices adjust. By the time it reaches workers and savers, purchasing power has already eroded.
                </p>
            </div>
        </section>

        <!-- The Problem -->
        <section class="content-section">
            <h2>Who Wins, Who Loses</h2>
            <p>
                Imagine the central bank prints $1 trillion. This money flows through the economy in layers:
            </p>
            <p>
                <strong>Layer 1 - Banks & Governments:</strong> Receive the money first at 0% interest. Prices haven't risen yet.
                They buy assets (stocks, real estate) at pre-inflation prices. Massive gain.<br><br>

                <strong>Layer 2 - Corporations & Wealthy:</strong> Borrow cheaply from banks. Buy appreciating assets before
                prices fully adjust. Moderate gain.<br><br>

                <strong>Layer 3 - Workers & Savers:</strong> Receive salary increases last, if at all. By now, prices have risen.
                Their wages buy less. Savings lose value. <strong>Net loss.</strong>
            </p>

            <div class="key-insight">
                <div class="key-insight-title">📉 The Hidden Tax</div>
                <p>
                    Inflation is sold as "economic stimulus" or "quantitative easing." In reality, it's a transfer of wealth
                    from those who hold currency (workers, retirees, savers) to those who receive new money first (banks, governments,
                    asset holders). The corruption curve ensures the wealthy get wealthier while the middle class erodes.
                </p>
            </div>
        </section>

        <!-- Interactive Demo -->
        <section class="demo-section">
            <div class="demo-header">
                <h3>🎮 Interactive Lab: Cantillon Effect Visualizer</h3>
                <p class="demo-description">
                    Print new money and watch how it flows through the economy. See who benefits and who loses
                    based on their distance from the money printer.
                </p>
            </div>

            <div class="demo-canvas">
                <div class="economy-layers">
                    <!-- Layer 1: First Receivers -->
                    <div class="layer-card first-receivers">
                        <div class="layer-number">1</div>
                        <div class="layer-info">
                            <h4>Banks & Governments</h4>
                            <p class="layer-description">Receive new money first, spend before prices rise</p>
                        </div>
                        <div class="purchasing-power">
                            <div class="pp-value gain" id="layer1PP">+15%</div>
                            <div class="pp-label">Purchasing Power</div>
                        </div>
                    </div>

                    <!-- Layer 2: Middle Receivers -->
                    <div class="layer-card middle-class">
                        <div class="layer-number">2</div>
                        <div class="layer-info">
                            <h4>Corporations & Wealthy</h4>
                            <p class="layer-description">Borrow cheap money, buy assets before full price adjustment</p>
                        </div>
                        <div class="purchasing-power">
                            <div class="pp-value neutral" id="layer2PP">+3%</div>
                            <div class="pp-label">Purchasing Power</div>
                        </div>
                    </div>

                    <!-- Layer 3: Last Receivers -->
                    <div class="layer-card last-receivers">
                        <div class="layer-number">3</div>
                        <div class="layer-info">
                            <h4>Workers & Savers</h4>
                            <p class="layer-description">Wages rise slowly, prices already inflated, savings eroded</p>
                        </div>
                        <div class="purchasing-power">
                            <div class="pp-value loss" id="layer3PP">-12%</div>
                            <div class="pp-label">Purchasing Power</div>
                        </div>
                    </div>
                </div>

                <div class="money-flow">
                    <h4 style="color: var(--accent-bronze); margin-bottom: 1rem;">Money Flow Timeline</h4>
                    <div class="flow-step">
                        <div class="flow-arrow">➊</div>
                        <div class="flow-text" id="flow1">
                            <strong>Month 0:</strong> Central bank prints $1 trillion, lends to banks at 0%
                        </div>
                    </div>
                    <div class="flow-step">
                        <div class="flow-arrow">➋</div>
                        <div class="flow-text" id="flow2">
                            <strong>Month 3:</strong> Banks lend to corporations and wealthy at 2%
                        </div>
                    </div>
                    <div class="flow-step">
                        <div class="flow-arrow">➌</div>
                        <div class="flow-text" id="flow3">
                            <strong>Month 12:</strong> Workers get 3% raise, but prices already up 10%
                        </div>
                    </div>
                </div>

                <div class="demo-controls">
                    <button class="demo-button danger" onclick="printMoney()">
                        🖨️ Print $1 Trillion
                    </button>
                    <button class="demo-button secondary" onclick="resetDemo()">
                        🔄 Reset Economy
                    </button>
                </div>

                <div class="demo-output" id="demoOutput">
                    <div class="output-message">Click "Print $1 Trillion" to see the Cantillon Effect in action...</div>
                </div>
            </div>

            <div class="key-insight">
                <div class="key-insight-title">💡 What You're Seeing</div>
                <p>
                    The wealthy gain purchasing power because they receive new money before prices adjust.
                    Workers and savers lose purchasing power because prices rise before their wages.
                    This isn't accidental — it's how fiat monetary systems extract wealth from the many to benefit the few.
                </p>
            </div>
        </section>

        <!-- Bitcoin's Solution -->
        <section class="content-section">
            <h2>Bitcoin: No Cantillon Effect</h2>
            <p>
                Bitcoin's fixed supply of 21 million coins eliminates the Cantillon Effect entirely. <strong>No one can print new bitcoin.</strong>
                No central bank can inflate supply. No government can debase the currency to benefit insiders.
            </p>
            <p>
                New bitcoin enters circulation through mining — a competitive, permissionless process. Anyone can mine.
                The schedule is predictable and decreasing (halving every 4 years). By 2140, no new bitcoin will ever be created.
            </p>
            <p>
                This means <strong>purchasing power isn't systematically stolen</strong> from late receivers. If you hold bitcoin,
                your share of the total supply never decreases. Contrast this with fiat, where your share shrinks every time
                the money printer runs.
            </p>

            <div class="key-insight">
                <div class="key-insight-title">₿ Bitcoin's Elegant Solution</div>
                <p>
                    Bitcoin replaces discretionary money printing with algorithmic scarcity. There is no "first receiver"
                    because supply increases predictably for everyone. Miners earn new bitcoin by securing the network,
                    not by political privilege. The corruption curve is flattened to zero — no one can game the system
                    through proximity to power.
                </p>
            </div>
        </section>

        <!-- Socratic Questions -->
        <section class="socratic-section">
            <h3>💬 Reflect on What You've Learned</h3>
            <p style="text-align: center; color: var(--text-dim); margin-bottom: 2rem;">
                Test your understanding with interactive reflections.
            </p>

            <!-- Q1: Inflation Narrative (Multiple Choice) -->
            <div class="question-card">
                <div class="question-number">Question 1</div>
                <div class="question-text">
                    Why is inflation presented as beneficial despite transferring wealth from workers to money printers?
                </div>

                <select class="choice-select" id="narrative-choice" onchange="checkNarrative()" style="margin-top: 1rem;">
                    <option value="">— Select One —</option>
                    <option value="beneficiaries">Those who benefit (govt, banks) control the narrative</option>
                    <option value="complexity">Economic complexity hides the wealth transfer</option>
                    <option value="keynes">Keynesian economics legitimizes inflation as "stimulus"</option>
                    <option value="all">All of the above</option>
                </select>
                <div id="narrative-feedback" class="feedback-box"></div>
            </div>

            <!-- Q2: Cantillon Examples (Checklist) -->
            <div class="question-card">
                <div class="question-number">Question 2</div>
                <div class="question-text">
                    Who receives new money FIRST in your society (Cantillon winners)?
                </div>
                <p style="font-size: 0.95rem; color: var(--text-dim); margin: 1rem 0;">Select the early receivers:</p>

                <div class="checklist-reflection">
                    <label class="checkbox-label">
                        <input type="checkbox" id="cant-govt" onchange="updateCantillonFeedback()">
                        <span><strong>Government</strong> - Spends newly created money first</span>
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="cant-banks" onchange="updateCantillonFeedback()">
                        <span><strong>Banks/Financial institutions</strong> - Receive Fed loans at low rates</span>
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="cant-corp" onchange="updateCantillonFeedback()">
                        <span><strong>Large corporations</strong> - Access to cheap credit</span>
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="cant-workers" onchange="updateCantillonFeedback()">
                        <span><strong>Workers/Savers</strong> - Receive money last (through wages)</span>
                    </label>
                </div>
                <div id="cantillon-feedback" class="feedback-box"></div>
            </div>

            <!-- Q3: Bitcoin's Solution (Multiple Choice) -->
            <div class="question-card">
                <div class="question-number">Question 3</div>
                <div class="question-text">
                    How does Bitcoin's fixed 21M supply eliminate Cantillon Effect?
                </div>

                <select class="choice-select" id="bitcoin-cantillon-choice" onchange="checkBitcoinCantillon()" style="margin-top: 1rem;">
                    <option value="">— Select One —</option>
                    <option value="no-new">No new money created, so no early receivers</option>
                    <option value="mining">Mining distributes new coins to workers (miners), not banks</option>
                    <option value="predictable">Predictable supply schedule, no surprises</option>
                    <option value="all">All of the above</option>
                </select>
                <div id="bitcoin-cantillon-feedback" class="feedback-box"></div>
            </div>
        </section>

        <!-- Module Navigation -->
        <nav class="module-nav">
            <a href="/paths/principled/stage-2/module-1.html" class="nav-link">
                ← Previous: Coordination Problem
            </a>
            <div class="progress-indicator">
                Module 2 of 3 • Stage 2 of 5
            </div>
            <a href="/paths/principled/stage-2/module-3.html" class="nav-link">
                Next: Trust & Accountability →
            </a>
        </nav>
    </div>

    <script>
        // Demo State
        let demoState = {
            printCount: 0,
            layer1PP: 0,
            layer2PP: 0,
            layer3PP: 0
        };

        function printMoney() {
            demoState.printCount++;

            // Calculate cumulative purchasing power changes
            demoState.layer1PP += 15;
            demoState.layer2PP += 3;
            demoState.layer3PP -= 12;

            updateDisplay();
            analyzeImpact();
        }

        function updateDisplay() {
            // Update purchasing power displays
            document.getElementById('layer1PP').textContent = (demoState.layer1PP > 0 ? '+' : '') + demoState.layer1PP + '%';
            document.getElementById('layer2PP').textContent = (demoState.layer2PP > 0 ? '+' : '') + demoState.layer2PP + '%';
            document.getElementById('layer3PP').textContent = (demoState.layer3PP > 0 ? '+' : '') + demoState.layer3PP + '%';

            // Update flow descriptions
            const months = demoState.printCount * 12;
            document.getElementById('flow1').innerHTML = `
                <strong>Month 0:</strong> Central bank prints $${demoState.printCount} trillion, lends to banks at 0%
            `;
            document.getElementById('flow2').innerHTML = `
                <strong>Month ${Math.min(3 * demoState.printCount, months)}:</strong> Banks lend to corporations and wealthy at 2%
            `;
            document.getElementById('flow3').innerHTML = `
                <strong>Month ${Math.min(12 * demoState.printCount, months)}:</strong> Workers get ${3 * demoState.printCount}% raise, but prices already up ${10 * demoState.printCount}%
            `;
        }

        function analyzeImpact() {
            const output = document.getElementById('demoOutput');

            const wealthTransfer = Math.abs(demoState.layer3PP);
            const eliteGain = demoState.layer1PP;

            let message = `
                <div class="output-message" style="color: var(--accent-red); font-weight: 700;">
                    🚨 Wealth Transfer in Progress
                </div>
                <div class="output-message">
                    <strong>Round ${demoState.printCount}:</strong> Printed $${demoState.printCount} trillion total
                </div>
                <div class="output-message">
                    <strong>Banks & Governments:</strong> Gained ${eliteGain}% purchasing power
                </div>
                <div class="output-message">
                    <strong>Workers & Savers:</strong> Lost ${wealthTransfer}% purchasing power
                </div>
                <div class="output-message" style="margin-top: 1rem; color: var(--text-dim);">
                    This is the Cantillon Effect: those closest to the money printer extract wealth
                    from those farthest away. It's not a bug — it's the system working as designed.
                </div>
            `;

            if (demoState.printCount >= 3) {
                message += `
                    <div class="output-message" style="margin-top: 1rem; color: #ffaa00; font-weight: 600;">
                        ⚠️ After ${demoState.printCount} rounds of printing, the middle class purchasing power has collapsed by ${Math.abs(demoState.layer3PP)}%.
                        Meanwhile, the financial elite have gained ${demoState.layer1PP}%. This is systematic wealth extraction.
                    </div>
                `;
            }

            output.innerHTML = message;
        }

        function resetDemo() {
            demoState = {
                printCount: 0,
                layer1PP: 0,
                layer2PP: 0,
                layer3PP: 0
            };

            document.getElementById('layer1PP').textContent = '+0%';
            document.getElementById('layer2PP').textContent = '+0%';
            document.getElementById('layer3PP').textContent = '-0%';

            document.getElementById('flow1').innerHTML = `
                <strong>Month 0:</strong> Central bank prints $1 trillion, lends to banks at 0%
            `;
            document.getElementById('flow2').innerHTML = `
                <strong>Month 3:</strong> Banks lend to corporations and wealthy at 2%
            `;
            document.getElementById('flow3').innerHTML = `
                <strong>Month 12:</strong> Workers get 3% raise, but prices already up 10%
            `;

            document.getElementById('demoOutput').innerHTML = `
                <div class="output-message">Click "Print $1 Trillion" to see the Cantillon Effect in action...</div>
            `;
        }

        // Interactive Reflection System
        const STORAGE_KEY = 'principled_stage2_module2_reflections';

        function checkNarrative() {
            const choice = document.getElementById('narrative-choice').value;
            const feedbackDiv = document.getElementById('narrative-feedback');
            if (!choice) { feedbackDiv.style.display = 'none'; return; }

            let feedback = '';
            if (choice === 'all') {
                feedback = `<h5>✓ All Three Factors!</h5><p><strong>1. Beneficiaries control narrative:</strong> Central banks, governments, and financial institutions benefit—they also fund economics departments, think tanks, and media.<br><strong>2. Complexity hides transfer:</strong> Average person doesn't understand money creation or Cantillon Effect.<br><strong>3. Keynesian legitimization:</strong> "Stimulus," "quantitative easing," "managing aggregate demand"—euphemisms for wealth transfer.<br><br>Bitcoin exposes this: fixed supply makes the scam impossible.</p>`;
                feedbackDiv.className = 'feedback-box positive';
            } else {
                feedback = `<h5>💡 True, but all three apply</h5><p>Inflation narrative persists because beneficiaries control messaging, complexity hides harm, and Keynesian economics provides intellectual cover. Bitcoin cuts through all three.</p>`;
                feedbackDiv.className = 'feedback-box hint';
            }
            feedbackDiv.innerHTML = feedback;
            feedbackDiv.style.display = 'block';
            saveReflection('q1', choice);
        }

        function updateCantillonFeedback() {
            const govt = document.getElementById('cant-govt').checked;
            const banks = document.getElementById('cant-banks').checked;
            const corp = document.getElementById('cant-corp').checked;
            const workers = document.getElementById('cant-workers').checked;
            const feedbackDiv = document.getElementById('cantillon-feedback');

            if (workers) {
                feedbackDiv.innerHTML = `<h5>⚠️ Workers Are LAST!</h5><p>Workers/savers are the <strong>losers</strong> of Cantillon Effect—they receive new money last (through wages), after prices have already risen. They're not early receivers. Try again by selecting govt/banks/corps.</p>`;
                feedbackDiv.className = 'feedback-box hint';
                feedbackDiv.style.display = 'block';
                return;
            }

            const count = [govt, banks, corp].filter(Boolean).length;
            if (count === 0) { feedbackDiv.style.display = 'none'; return; }

            let feedback = '';
            if (count === 3) {
                feedback = `<h5>✓ Perfect—The Cantillon Winners!</h5><p><strong>1. Government:</strong> Creates/spends money first<br><strong>2. Banks:</strong> Receive Fed loans at 0% before inflation<br><strong>3. Corporations:</strong> Cheap credit before prices rise<br><br><em>Workers/savers get money last</em> through wages—after prices increase. This is systematic wealth extraction from the many to the few.</p>`;
                feedbackDiv.className = 'feedback-box positive';
            } else {
                feedback = `<h5>💡 Partial (${count}/3)</h5><p>All three (govt, banks, corps) receive new money first. Workers are last—that's why they lose purchasing power.</p>`;
                feedbackDiv.className = 'feedback-box hint';
            }
            feedbackDiv.innerHTML = feedback;
            feedbackDiv.style.display = 'block';
            saveCheckboxes();
        }

        function checkBitcoinCantillon() {
            const choice = document.getElementById('bitcoin-cantillon-choice').value;
            const feedbackDiv = document.getElementById('bitcoin-cantillon-feedback');
            if (!choice) { feedbackDiv.style.display = 'none'; return; }

            let feedback = '';
            if (choice === 'all') {
                feedback = `<h5>✓ Correct—All Three!</h5><p><strong>1. No new money:</strong> After 21M mined, zero inflation. No early receivers.<br><strong>2. Mining distributes to workers:</strong> New coins go to miners (workers with energy), not banks.<br><strong>3. Predictable schedule:</strong> Everyone knows the supply curve. No surprises, no hidden printing.<br><br><em>Result:</em> No Cantillon Effect. Wealth can't be extracted through monetary manipulation. Savings gain value over time.</p>`;
                feedbackDiv.className = 'feedback-box positive';
            } else {
                feedback = `<h5>💡 True, but all three matter</h5><p>Bitcoin eliminates Cantillon Effect through: (1) fixed supply, (2) miner distribution, (3) predictable schedule. Together these prevent monetary wealth extraction.</p>`;
                feedbackDiv.className = 'feedback-box hint';
            }
            feedbackDiv.innerHTML = feedback;
            feedbackDiv.style.display = 'block';
            saveReflection('q3', choice);
        }

        function saveCheckboxes() {
            const reflections = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}');
            reflections['cant-govt'] = document.getElementById('cant-govt').checked;
            reflections['cant-banks'] = document.getElementById('cant-banks').checked;
            reflections['cant-corp'] = document.getElementById('cant-corp').checked;
            reflections['cant-workers'] = document.getElementById('cant-workers').checked;
            localStorage.setItem(STORAGE_KEY, JSON.stringify(reflections));
        }

        function saveReflection(key, value) {
            const reflections = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}');
            reflections[key] = value;
            localStorage.setItem(STORAGE_KEY, JSON.stringify(reflections));
        }

        function loadReflections() {
            const saved = localStorage.getItem(STORAGE_KEY);
            if (saved) {
                const reflections = JSON.parse(saved);
                if (reflections['cant-govt']) document.getElementById('cant-govt').checked = true;
                if (reflections['cant-banks']) document.getElementById('cant-banks').checked = true;
                if (reflections['cant-corp']) document.getElementById('cant-corp').checked = true;
                if (reflections['cant-workers']) document.getElementById('cant-workers').checked = true;
                if (reflections['q1']) document.getElementById('narrative-choice').value = reflections['q1'];
                if (reflections['q3']) document.getElementById('bitcoin-cantillon-choice').value = reflections['q3'];
                updateCantillonFeedback();
                if (reflections['q1']) checkNarrative();
                if (reflections['q3']) checkBitcoinCantillon();
            }
        }

        window.addEventListener('DOMContentLoaded', () => {
            loadReflections();
            let progress = JSON.parse(localStorage.getItem('principled_stage2_progress') || '[]');
            if (!progress.includes('module-2')) {
                progress.push('module-2');
                localStorage.setItem('principled_stage2_progress', JSON.stringify(progress));
            }
        });
    </script>
</body>
</html>
