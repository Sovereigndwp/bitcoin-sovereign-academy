<!DOCTYPE html><html lang="en"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bitcoin as a Living Organism | Stage 4 Module 3 | Principled Path</title>
    <style>
        :root {
            --accent-bronze: #8B6F47;
            --accent-bronze-light: #A0826D;
            --primary-dark: #1a1a1a;
            --secondary-dark: #2d2d2d;
            --text-light: #e0e0e0;
            --text-dim: #b3b3b3;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--primary-dark);
            color: var(--text-light);
            line-height: 1.6;
            padding: 2rem;
        }
        .container { max-width: 900px; margin: 0 auto; }
        .back-btn {
            display: inline-block;
            background: var(--accent-bronze);
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 25px;
            text-decoration: none;
            font-weight: bold;
            margin-bottom: 2rem;
            transition: all 0.3s ease;
        }
        .back-btn:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(247, 147, 26, 0.4); }
        .module-header {
            text-align: center;
            margin-bottom: 3rem;
            padding: 2rem;
            background: linear-gradient(135deg, rgba(139, 111, 71, 0.2), rgba(139, 111, 71, 0.05));
            border-radius: 12px;
            border: 2px solid var(--accent-bronze);
        }
        .module-icon { font-size: 4rem; margin-bottom: 1rem; }
        h1 {
            font-size: 2.5rem;
            background: linear-gradient(45deg, #8B6F47, #A0826D);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 1rem;
        }
        .module-subtitle { font-size: 1.2rem; color: var(--text-dim); max-width: 700px; margin: 0 auto; }
        .content-section {
            background: var(--secondary-dark);
            border-radius: 12px;
            padding: 2.5rem;
            margin-bottom: 2rem;
            border: 2px solid rgba(139, 111, 71, 0.2);
        }
        .content-section h2 {
            color: var(--accent-bronze);
            font-size: 1.8rem;
            margin-bottom: 1.5rem;
        }
        .content-section h3 {
            color: var(--accent-bronze-light);
            font-size: 1.3rem;
            margin: 2rem 0 1rem;
        }
        .content-section p {
            color: var(--text-dim);
            margin-bottom: 1rem;
            line-height: 1.8;
        }
        .content-section ul {
            list-style: none;
            padding-left: 0;
        }
        .content-section li {
            padding: 0.75rem 0 0.75rem 2rem;
            position: relative;
            color: var(--text-light);
            line-height: 1.8;
        }
        .content-section li:before {
            content: "‚Üí";
            position: absolute;
            left: 0;
            color: var(--accent-bronze);
            font-weight: bold;
        }
        .highlight-box {
            background: rgba(139, 111, 71, 0.1);
            border-left: 4px solid var(--accent-bronze);
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 0.5rem;
        }
        .highlight-box strong {
            color: var(--accent-bronze);
            display: block;
            margin-bottom: 0.5rem;
        }
        .organism-traits {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }
        .trait-card {
            background: rgba(139, 111, 71, 0.1);
            border: 2px solid rgba(139, 111, 71, 0.2);
            border-radius: 8px;
            padding: 1.5rem;
            transition: all 0.3s ease;
        }
        .trait-card:hover {
            border-color: var(--accent-bronze);
            transform: translateY(-4px);
        }
        .trait-icon {
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }
        .trait-title {
            color: var(--accent-bronze);
            font-weight: 600;
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
        }
        .trait-description {
            color: var(--text-dim);
            font-size: 0.9rem;
            line-height: 1.6;
        }
        .demo-container {
            background: var(--primary-dark);
            border: 2px solid rgba(139, 111, 71, 0.3);
            border-radius: 12px;
            padding: 2rem;
            margin: 2rem 0;
        }
        .demo-tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }
        .demo-tab {
            background: var(--secondary-dark);
            color: var(--text-dim);
            border: 2px solid rgba(139, 111, 71, 0.2);
            padding: 0.75rem 1.5rem;
            border-radius: 2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }
        .demo-tab:hover {
            border-color: var(--accent-bronze);
            color: var(--text-light);
        }
        .demo-tab.active {
            background: linear-gradient(45deg, #8B6F47, #A0826D);
            color: var(--primary-dark);
            border-color: var(--accent-bronze);
        }
        .demo-panel {
            display: none;
        }
        .demo-panel.active {
            display: block;
        }
        .ecosystem-viz {
            background: var(--secondary-dark);
            padding: 2rem;
            border-radius: 8px;
            margin: 2rem 0;
        }
        .organism-layer {
            margin: 1.5rem 0;
            padding: 1.5rem;
            background: rgba(139, 111, 71, 0.05);
            border-left: 4px solid var(--accent-bronze);
            border-radius: 6px;
        }
        .layer-title {
            color: var(--accent-bronze);
            font-weight: 600;
            margin-bottom: 0.5rem;
        }
        .layer-components {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
            margin-top: 1rem;
        }
        .component-chip {
            background: var(--primary-dark);
            padding: 0.5rem 1rem;
            border-radius: 1rem;
            font-size: 0.85rem;
            color: var(--text-light);
            border: 1px solid rgba(139, 111, 71, 0.3);
        }
        button {
            background: linear-gradient(45deg, #8B6F47, #A0826D);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 2rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(139, 111, 71, 0.4);
        }
        .health-meter {
            margin: 2rem 0;
        }
        .health-bar {
            height: 30px;
            background: var(--secondary-dark);
            border-radius: 15px;
            overflow: hidden;
            position: relative;
        }
        .health-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-bronze), var(--accent-bronze-light));
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 1rem;
            color: white;
            font-weight: 600;
        }
        .reflection-section {
            background: linear-gradient(135deg, rgba(139, 111, 71, 0.1), rgba(139, 111, 71, 0.05));
            border: 2px solid rgba(139, 111, 71, 0.3);
            border-radius: 12px;
            padding: 2.5rem;
            margin: 3rem 0;
        }
        .reflection-section h2 {
            color: var(--accent-bronze);
            margin-bottom: 2rem;
            text-align: center;
        }
        .question-box {
            background: var(--secondary-dark);
            padding: 2rem;
            border-radius: 8px;
            margin-bottom: 2rem;
            border: 2px solid rgba(139, 111, 71, 0.2);
        }
        .question-box h3 {
            color: var(--accent-bronze-light);
            margin-bottom: 1rem;
        }
        textarea {
            width: 100%;
            min-height: 120px;
            background: var(--primary-dark);
            border: 2px solid rgba(139, 111, 71, 0.3);
            color: var(--text-light);
            padding: 1rem;
            border-radius: 8px;
            font-family: inherit;
            font-size: 1rem;
            line-height: 1.6;
            resize: vertical;
        }
        textarea:focus {
            outline: none;
            border-color: var(--accent-bronze);
        }
        .next-module {
            text-align: center;
            margin-top: 3rem;
        }
        .next-module a {
            display: inline-block;
            background: linear-gradient(135deg, var(--accent-bronze), var(--accent-bronze-light));
            color: white;
            padding: 1.25rem 2.5rem;
            border-radius: 2rem;
            text-decoration: none;
            font-weight: 700;
            font-size: 1.1rem;
            transition: all 0.3s ease;
        }
        .next-module a:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(139, 111, 71, 0.5);
        }
        /* Interactive Reflection Styles */
        .reflection-tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            border-bottom: 2px solid rgba(139, 111, 71, 0.2);
            padding-bottom: 0.5rem;
        }
        .reflection-tab {
            background: transparent;
            color: var(--text-dim);
            border: 2px solid rgba(139, 111, 71, 0.3);
            padding: 0.5rem 1.25rem;
            border-radius: 8px 8px 0 0;
            font-weight: 600;
            font-size: 0.95rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .reflection-tab:hover {
            color: var(--accent-bronze);
            border-color: var(--accent-bronze);
            transform: translateY(-2px);
        }
        .reflection-tab.active {
            background: linear-gradient(135deg, rgba(139, 111, 71, 0.2), rgba(139, 111, 71, 0.1));
            color: var(--accent-bronze);
            border-color: var(--accent-bronze);
            border-bottom-color: transparent;
        }
        .reflection-panel {
            display: none;
            padding: 1.5rem;
            background: var(--primary-dark);
            border-radius: 0 8px 8px 8px;
            border: 2px solid rgba(139, 111, 71, 0.2);
        }
        .reflection-panel.active {
            display: block;
        }
        .choice-select {
            width: 100%;
            background: var(--secondary-dark);
            border: 2px solid rgba(139, 111, 71, 0.3);
            color: var(--text-light);
            padding: 0.75rem 1rem;
            border-radius: 8px;
            font-size: 1rem;
            margin-bottom: 1rem;
            cursor: pointer;
        }
        .choice-select:focus {
            outline: none;
            border-color: var(--accent-bronze);
        }
        .feedback-btn {
            background: linear-gradient(45deg, #8B6F47, #A0826D);
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 2rem;
            border: none;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 0.5rem;
        }
        .feedback-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(139, 111, 71, 0.4);
        }
        .feedback-box {
            margin-top: 1.5rem;
            padding: 1.5rem;
            border-radius: 8px;
            border-left: 4px solid;
        }
        .feedback-box.positive {
            background: rgba(76, 175, 80, 0.1);
            border-color: #4caf50;
        }
        .feedback-box.positive h5 {
            color: #4caf50;
            margin-bottom: 0.5rem;
        }
        .feedback-box.hint {
            background: rgba(255, 152, 0, 0.1);
            border-color: #8B6F47;
        }
        .feedback-box.hint h5 {
            color: #8B6F47;
            margin-bottom: 0.5rem;
        }
        .feedback-box.neutral {
            background: rgba(139, 111, 71, 0.1);
            border-color: var(--accent-bronze);
        }
        .feedback-box.neutral h5 {
            color: var(--accent-bronze);
            margin-bottom: 0.5rem;
        }
        .checklist-reflection {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        .checkbox-label {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: var(--primary-dark);
            border: 2px solid rgba(139, 111, 71, 0.2);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .checkbox-label:hover {
            border-color: var(--accent-bronze);
        }
        .checkbox-label input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }
        .save-indicator {
            color: var(--text-dim);
            font-size: 0.85rem;
            text-align: right;
            margin-top: 0.5rem;
            opacity: 0.7;
        }
        
        /* ===== ACCESSIBILITY ENHANCEMENTS (WCAG 2.1 AA) ===== */

        /* WCAG 2.5.5: Touch Target Size */
        button, a, [role="button"], .nav-btn, .nav-link, .back-button, .demo-button, .feedback-btn, .check-answer-btn {
            min-height: 44px;
            min-width: 44px;
        }

        p a, li a {
            min-height: auto;
            min-width: auto;
            padding: 0.25rem 0;
        }

        /* WCAG 2.4.7: Focus Visible */
        *:focus-visible {
            outline: 3px solid var(--accent-bronze, #8B6F47);
            outline-offset: 2px;
        }

        button:focus-visible, a:focus-visible, [role="button"]:focus-visible {
            outline: 3px solid var(--accent-bronze, #8B6F47);
            outline-offset: 4px;
            box-shadow: 0 0 0 4px rgba(139, 111, 71, 0.2);
        }

        /* WCAG 2.3.3: Animation from Interactions */
        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
                scroll-behavior: auto !important;
            }
        }

        /* WCAG 1.4.10: Reflow */
        @media (max-width: 360px) {
            body {
                overflow-x: hidden;
            }

            .container {
                padding: 0 1rem;
            }
        }


        @media (max-width: 768px) {
            .module-header h1 { font-size: 2rem; }
            .organism-traits { grid-template-columns: 1fr; }
            .demo-tabs { flex-direction: column; }
        }
        @media (max-width: 480px) {
            .reflection-tabs {
                flex-direction: column;
                gap: 0.25rem;
            }
            .reflection-tab {
                width: 100%;
                text-align: center;
                border-radius: 6px;
            }
        }
    </style>
    <script src="/js/config.js"></script>
    <script src="/js/subdomain-access-control.js"></script>
    <script src="/js/module-gate-subdomain.js"></script>
    <script src="/js/module-progress.js"></script>
    <link rel="stylesheet" href="/css/icons.css">
<meta name="description" content="Learn about module 3 at Bitcoin Sovereign Academy. Interactive Bitcoin education with hands-on exercises and expert guidance."><link rel="canonical" href="https://bitcoinsovereign.academy/module-3.html"><meta property="og:title" content="Module 3 - Bitcoin Sovereign Academy"><meta property="og:description" content="Learn about module 3 at Bitcoin Sovereign Academy. Interactive Bitcoin education with hands-on exercises and expert guidance."><meta property="og:image" content="https://bitcoinsovereign.academy/assets/og-image.jpg"><meta property="og:url" content="https://bitcoinsovereign.academy/module-3.html"><meta property="og:type" content="website"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "EducationalOrganization",
  "name": "Bitcoin Sovereign Academy",
  "description": "Master Bitcoin through interactive experiences, AI-powered learning, and real-world simulations. Your journey from monetary curiosity to financial sovereignty starts here.",
  "url": "https://bitcoinsovereign.academy",
  "logo": "https://bitcoinsovereign.academy/assets/og-image.jpg",
  "sameAs": [
    "https://github.com/Sovereigndwp/bitcoin-sovereign-academy"
  ],
  "educationalLevel": "Beginner to Advanced",
  "teaches": [
    "Bitcoin Fundamentals",
    "Cryptocurrency Technology",
    "Financial Sovereignty",
    "Digital Asset Security"
  ],
  "audience": {
    "@type": "Audience",
    "audienceType": "Students interested in Bitcoin and cryptocurrency"
  }
}</script></head>
<body>
    <a href="#main-content" class="skip-link">Skip to main content</a>
    <main id="main-content" class="container">
        <a href="/paths/principled/stage-4/" class="back-btn">‚Üê Back to Stage 4</a>

        <div class="module-header">
            <div class="module-icon">üå±</div>
            <h1>Bitcoin as a Living Organism</h1>
            <p class="module-subtitle">
                Bitcoin isn't just software. It's an emergent, self-regulating system that adapts,
                heals, and evolves without central control.
            </p>
        </div>

        <!-- Introduction -->
        <div class="content-section">
            <h2>Why Bitcoin Behaves Like Life</h2>
            <p>
                Bitcoin exhibits properties we normally associate with living organisms:
                it responds to its environment, self-regulates, adapts to threats, and grows stronger over time.
            </p>
            <p>
                This isn't a metaphor. It's emergence. When you combine physics (proof-of-work),
                game theory (incentives), and distributed consensus, you get a system that behaves
                like a living entity without anyone designing it to do so.
            </p>

            <div class="highlight-box">
                <strong>Emergence Defined:</strong>
                Complex behaviors and patterns that arise from simple rules interacting at scale.
                No central planner creates these behaviors. They emerge spontaneously from the system's design.
            </div>

            <p>
                Let's explore the characteristics that make Bitcoin a living system:
            </p>
        </div>

        <!-- Organism Traits -->
        <div class="content-section">
            <h2>Traits of a Living System</h2>
            <p>
                Biologists define life by certain characteristics. Bitcoin exhibits nearly all of them:
            </p>

            <div class="organism-traits">
                <div class="trait-card">
                    <div class="trait-icon"><span data-icon="refresh"></span> </div>
                    <div class="trait-title">Homeostasis (Self-Regulation)</div>
                    <div class="trait-description">
                        Difficulty adjustment maintains ~10 minute blocks regardless of total hashpower.
                        The system automatically balances itself.
                    </div>
                </div>

                <div class="trait-card">
                    <div class="trait-icon"><span data-icon="shield"></span> </div>
                    <div class="trait-title">Response to Stimuli</div>
                    <div class="trait-description">
                        When attacked, honest miners coordinate to reject invalid blocks.
                        The network "fights off" threats automatically.
                    </div>
                </div>

                <div class="trait-card">
                    <div class="trait-icon"><span data-icon="trending-up"></span> </div>
                    <div class="trait-title">Growth &amp; Development</div>
                    <div class="trait-description">
                        Network hashrate, user adoption, and value have grown exponentially.
                        Bitcoin "matures" over time.
                    </div>
                </div>

                <div class="trait-card">
                    <div class="trait-icon"><span data-icon="lightning"></span> </div>
                    <div class="trait-title">Metabolism (Energy Processing)</div>
                    <div class="trait-description">
                        Bitcoin consumes electrical energy and converts it into security.
                        Energy flows through the system continuously.
                    </div>
                </div>

                <div class="trait-card">
                    <div class="trait-icon">üß¨</div>
                    <div class="trait-title">Reproduction &amp; Evolution</div>
                    <div class="trait-description">
                        Bitcoin's code can be forked (reproduced). Successful forks survive,
                        failed ones die. Natural selection at work.
                    </div>
                </div>

                <div class="trait-card">
                    <div class="trait-icon"><span data-icon="globe"></span> </div>
                    <div class="trait-title">Adaptation</div>
                    <div class="trait-description">
                        Miners move to cheaper energy sources. Developers improve efficiency.
                        Users adapt behaviors. The ecosystem evolves.
                    </div>
                </div>
            </div>
        </div>

        <!-- Self-Regulation -->
        <div class="content-section">
            <h2>Homeostasis: Bitcoin's Self-Regulation</h2>
            <p>
                Living organisms maintain stable internal conditions despite external changes.
                Bitcoin does the same through its difficulty adjustment mechanism.
            </p>

            <h3>The Difficulty Adjustment Algorithm</h3>
            <p>
                Every 2016 blocks (~2 weeks), Bitcoin measures how fast blocks were mined and adjusts difficulty:
            </p>
            <ul>
                <li><strong>If blocks came too fast:</strong> Increase difficulty (make mining harder)</li>
                <li><strong>If blocks came too slow:</strong> Decrease difficulty (make mining easier)</li>
                <li><strong>Target:</strong> Maintain average 10-minute block time</li>
            </ul>

            <p>
                This creates a negative feedback loop. The system automatically corrects deviations from equilibrium.
            </p>

            <div class="highlight-box">
                <strong>Why This Matters:</strong>
                No matter how much mining power joins or leaves the network, Bitcoin maintains its heartbeat.
                If China banned mining tomorrow and 50% of hashrate disappeared, blocks would slow down briefly,
                then difficulty would adjust and the network would continue normally.
            </div>

            <h3>Other Self-Regulating Mechanisms</h3>
            <ul>
                <li><strong>Mempool pressure:</strong> When demand for block space increases, fees rise automatically</li>
                <li><strong>Hash rate migration:</strong> Miners naturally move to cheapest energy sources</li>
                <li><strong>Node count:</strong> More valuable network ‚Üí more people run nodes ‚Üí stronger validation</li>
                <li><strong>Market price:</strong> Supply and demand reach equilibrium without central planning</li>
            </ul>
        </div>

        <!-- Interactive Demos -->
        <div class="content-section">
            <h2>Interactive Simulations</h2>
            <p>
                Experience Bitcoin's living properties through these demonstrations.
            </p>

            <div class="demo-container">
                <div class="demo-tabs">
                    <button class="demo-tab active" onclick="switchTab('homeostasis')">Homeostasis Simulator</button>
                    <button class="demo-tab" onclick="switchTab('immune')">Immune Response</button>
                    <button class="demo-tab" onclick="switchTab('ecosystem')">Ecosystem Layers</button>
                </div>

                <!-- Homeostasis Simulator -->
                <div id="homeostasis-panel" class="demo-panel active">
                    <h3 style="color: var(--accent-bronze-light); margin-bottom: 1rem;">Difficulty Adjustment Simulation</h3>
                    <p style="color: var(--text-dim); margin-bottom: 1.5rem;">
                        Watch how Bitcoin automatically maintains equilibrium when hashrate changes.
                    </p>

                    <div style="background: var(--secondary-dark); padding: 2rem; border-radius: 8px;">
                        <div style="text-align: center; margin-bottom: 2rem;">
                            <div style="color: var(--text-light); font-size: 1.2rem; margin-bottom: 0.5rem;">
                                Current Block Time: <span id="blockTime" style="color: var(--accent-bronze); font-weight: 600;">10.0 min</span>
                            </div>
                            <div style="color: var(--text-dim); font-size: 0.9rem;">
                                Target: 10 minutes | Difficulty: <span id="difficulty" style="color: var(--accent-bronze); font-weight: 600;">1.00x</span>
                            </div>
                        </div>

                        <div class="health-meter">
                            <div style="color: var(--text-dim); margin-bottom: 0.5rem;">Network Hashrate</div>
                            <div class="health-bar">
                                <div id="hashrateBar" class="health-fill" style="width: 50%;">100 EH/s</div>
                            </div>
                        </div>

                        <div style="display: flex; gap: 1rem; justify-content: center; margin: 2rem 0; flex-wrap: wrap;">
                            <button onclick="adjustHashrate(2)">+100% Hashrate (e.g., new miners join)</button>
                            <button onclick="adjustHashrate(0.5)" style="background: linear-gradient(45deg, #e74c3c, #c0392b);">
                                -50% Hashrate (e.g., China ban)
                            </button>
                            <button onclick="runDifficultyAdjustment()"><span data-icon="timer"></span> Run Difficulty Adjustment</button>
                            <button onclick="resetHomeostasis()">Reset</button>
                        </div>

                        <div id="homeostasisLog" style="margin-top: 1.5rem; padding: 1rem; background: var(--primary-dark); border-radius: 6px; color: var(--text-dim); font-size: 0.9rem; max-height: 200px; overflow-y: auto;"></div>
                    </div>
                </div>

                <!-- Immune Response -->
                <div id="immune-panel" class="demo-panel">
                    <h3 style="color: var(--accent-bronze-light); margin-bottom: 1rem;">Network Immune Response</h3>
                    <p style="color: var(--text-dim); margin-bottom: 1.5rem;">
                        See how Bitcoin "heals" itself when attacked, like an immune system fighting infection.
                    </p>

                    <div style="background: var(--secondary-dark); padding: 2rem; border-radius: 8px;">
                        <div style="text-align: center; margin-bottom: 2rem;">
                            <div style="color: var(--text-light); font-size: 1.2rem; margin-bottom: 0.5rem;">
                                Network Health: <span id="networkHealth" style="color: #2ecc71; font-weight: 600;">100%</span>
                            </div>
                            <div style="color: var(--text-dim); font-size: 0.9rem;">
                                Honest Nodes: <span id="honestNodes" style="color: var(--accent-bronze); font-weight: 600;">95%</span>
                            </div>
                        </div>

                        <div class="health-meter">
                            <div style="color: var(--text-dim); margin-bottom: 0.5rem;">System Integrity</div>
                            <div class="health-bar">
                                <div id="integrityBar" class="health-fill" style="width: 100%;">100%</div>
                            </div>
                        </div>

                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin: 2rem 0;">
                            <button onclick="introduceAttack('spam')">Introduce Spam Attack</button>
                            <button onclick="introduceAttack('invalid')">Broadcast Invalid Blocks</button>
                            <button onclick="introduceAttack('sybil')">Sybil Attack (Fake Nodes)</button>
                            <button onclick="healNetwork()">‚öïÔ∏è Observe Self-Healing</button>
                        </div>

                        <div id="immuneLog" style="margin-top: 1.5rem; padding: 1rem; background: var(--primary-dark); border-radius: 6px; color: var(--text-dim); font-size: 0.9rem; max-height: 200px; overflow-y: auto;"></div>
                    </div>
                </div>

                <!-- Ecosystem Layers -->
                <div id="ecosystem-panel" class="demo-panel">
                    <h3 style="color: var(--accent-bronze-light); margin-bottom: 1rem;">Bitcoin's Layered Ecosystem</h3>
                    <p style="color: var(--text-dim); margin-bottom: 1.5rem;">
                        Like biological ecosystems, Bitcoin has interdependent layers that support each other.
                    </p>

                    <div class="ecosystem-viz">
                        <div class="organism-layer">
                            <div class="layer-title">üî¨ Protocol Layer (DNA)</div>
                            <div style="color: var(--text-dim); font-size: 0.9rem; margin-top: 0.5rem;">
                                The core rules that define Bitcoin. Extremely hard to change, providing stability.
                            </div>
                            <div class="layer-components">
                                <span class="component-chip">21M Supply Cap</span>
                                <span class="component-chip">Proof-of-Work</span>
                                <span class="component-chip">10-Min Blocks</span>
                                <span class="component-chip">Difficulty Adjustment</span>
                            </div>
                        </div>

                        <div class="organism-layer">
                            <div class="layer-title">‚öôÔ∏è Network Layer (Organs)</div>
                            <div style="color: var(--text-dim); font-size: 0.9rem; margin-top: 0.5rem;">
                                The infrastructure that keeps Bitcoin running. Miners, nodes, and mempool.
                            </div>
                            <div class="layer-components">
                                <span class="component-chip">~15,000 Full Nodes</span>
                                <span class="component-chip">Mining Pools</span>
                                <span class="component-chip">Mempool</span>
                                <span class="component-chip">Blockchain State</span>
                            </div>
                        </div>

                        <div class="organism-layer">
                            <div class="layer-title">üíº Application Layer (Behaviors)</div>
                            <div style="color: var(--text-dim); font-size: 0.9rem; margin-top: 0.5rem;">
                                Tools and services built on top. Wallets, exchanges, Lightning Network.
                            </div>
                            <div class="layer-components">
                                <span class="component-chip">Wallets</span>
                                <span class="component-chip">Exchanges</span>
                                <span class="component-chip">Lightning Network</span>
                                <span class="component-chip">Payment Processors</span>
                            </div>
                        </div>

                        <div class="organism-layer">
                            <div class="layer-title"><span data-icon="globe"></span> Social Layer (Ecosystem)</div>
                            <div style="color: var(--text-dim); font-size: 0.9rem; margin-top: 0.5rem;">
                                The community of users, developers, educators, and businesses.
                            </div>
                            <div class="layer-components">
                                <span class="component-chip">Developers</span>
                                <span class="component-chip">Merchants</span>
                                <span class="component-chip">Educators</span>
                                <span class="component-chip">Holders</span>
                            </div>
                        </div>
                    </div>

                    <div style="margin-top: 2rem; padding: 1.5rem; background: rgba(139, 111, 71, 0.1); border-radius: 8px; border-left: 4px solid var(--accent-bronze);">
                        <div style="color: var(--accent-bronze); font-weight: 600; margin-bottom: 0.5rem;">üîó Interdependence</div>
                        <div style="color: var(--text-dim); font-size: 0.9rem; line-height: 1.6;">
                            Each layer depends on the others. The protocol provides rules, the network executes them,
                            applications make Bitcoin useful, and the social layer gives it value. Remove any layer and the system weakens.
                            This is how complex life works. Specialized parts cooperating toward survival.
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Evolution & Adaptation -->
        <div class="content-section">
            <h2>Evolution Through Forking</h2>
            <p>
                Bitcoin evolves like biological species through variation, selection, and reproduction.
            </p>

            <h3>How Bitcoin "Reproduces"</h3>
            <p>
                Anyone can fork Bitcoin's code and create a new cryptocurrency. This is like biological reproduction:
            </p>
            <ul>
                <li><strong>Variation:</strong> Each fork changes some rules (block size, mining algorithm, etc.)</li>
                <li><strong>Competition:</strong> Forks compete for users, miners, and market value</li>
                <li><strong>Selection:</strong> Successful forks survive and grow, failed forks die</li>
                <li><strong>Adaptation:</strong> Survivors prove they solved real problems better than competitors</li>
            </ul>

            <h3>Examples of Natural Selection</h3>
            <ul>
                <li><strong>Bitcoin Cash (2017):</strong> Tried 8MB blocks. Lost 95% of value vs BTC. Market selected against it.</li>
                <li><strong>Bitcoin SV (2018):</strong> Tried 128MB blocks. Even less successful. Evolution in action.</li>
                <li><strong>Litecoin (2011):</strong> Found a niche (faster blocks, different algorithm). Survived by differentiating.</li>
                <li><strong>Original Bitcoin:</strong> Remained dominant because its conservative approach preserved key properties.</li>
            </ul>

            <div class="highlight-box">
                <strong>Survival of the Fittest:</strong>
                Bitcoin's refusal to change quickly isn't a bug. It's a feature. Like DNA mutations,
                most changes are harmful. Bitcoin's conservatism is why it survives while thousands
                of altcoins have died.
            </div>
        </div>

        <!-- Emergent Properties -->
        <div class="content-section">
            <h2>Properties That Emerge Spontaneously</h2>
            <p>
                Bitcoin's most important characteristics weren't explicitly programmed. They emerged
                from simple rules interacting at scale:
            </p>

            <h3>1. Decentralization</h3>
            <p>
                No one designed Bitcoin to be decentralized. It emerged because:
            </p>
            <ul>
                <li>Mining is profitable anywhere with cheap electricity</li>
                <li>Running a node is voluntary but incentivized (verify don't trust)</li>
                <li>No single entity can change the rules without consensus</li>
            </ul>

            <h3>2. Censorship Resistance</h3>
            <p>
                Bitcoin can't be shut down because:
            </p>
            <ul>
                <li>Miners are geographically distributed across 100+ countries</li>
                <li>Nodes are run by volunteers worldwide</li>
                <li>Code is open-source and replicated globally</li>
                <li>Economic incentives keep participants honest</li>
            </ul>

            <h3>3. Antifragility</h3>
            <p>
                Bitcoin gets stronger from attacks:
            </p>
            <ul>
                <li>Government bans ‚Üí Miners relocate, decentralization increases</li>
                <li>Price crashes ‚Üí Weak hands sell, strong holders accumulate</li>
                <li>Technical attacks ‚Üí Developers patch vulnerabilities, system hardens</li>
                <li>Competing forks ‚Üí Market tests ideas, best solutions win</li>
            </ul>

            <div class="highlight-box">
                <strong>Antifragility Defined:</strong>
                Systems that gain from disorder and stress. Bitcoin doesn't just resist attacks.
                It evolves stronger defenses in response to them. Each survived crisis makes the next one less threatening.
            </div>
        </div>

        <!-- Nobody in Charge -->
        <div class="content-section">
            <h2>No Brain, No Central Control</h2>
            <p>
                Perhaps Bitcoin's most remarkable property: it functions perfectly without anyone in charge.
            </p>

            <h3>Distributed Intelligence</h3>
            <p>
                Bitcoin exhibits intelligent behavior without a central brain:
            </p>
            <ul>
                <li><strong>Problem:</strong> Too many transactions, blocks too small</li>
                <li><strong>Response:</strong> Fees rise automatically, users adopt batching, Lightning Network develops</li>
                <li><strong>Result:</strong> System adapts without central planning</li>
            </ul>

            <p>
                This is how ant colonies, bee hives, and immune systems work. Simple agents following
                simple rules create complex, adaptive behavior.
            </p>

            <h3>Why This Is Revolutionary</h3>
            <p>
                Every other monetary system in history required trusted authorities:
            </p>
            <ul>
                <li>Gold: Requires assayers to verify purity</li>
                <li>Fiat currency: Requires central banks and governments</li>
                <li>Bank accounts: Require banks and regulators</li>
                <li>Cryptocurrency exchanges: Require trusted custodians</li>
            </ul>

            <p>
                Bitcoin is the first system that coordinates millions of participants worldwide
                without anyone in charge. This is genuinely new in human history.
            </p>
        </div>

        <!-- Interactive Reflection -->
        <div class="reflection-section">
            <h2>ü§î Test Your Understanding</h2>
            <p style="text-align: center; color: var(--text-dim); margin-bottom: 2rem;">
                Answer at your own depth. Quick thoughts or deep analysis. Get instant feedback.
            </p>

            <!-- Q1: Emergence vs Design -->
            <div class="question-box">
                <h3>Question 1: Emergence vs. Design</h3>
                <p style="color: var(--text-dim); margin-bottom: 1rem;">
                    Why is emergence more robust than top-down design?
                </p>

                <div class="checklist-reflection">
                    <p style="color: var(--text-dim); font-size: 0.95rem; margin-bottom: 1rem;">Which examples show emergence from simple rules?</p>
                    <label class="checkbox-label">
                        <input type="checkbox" id="emerge-ant" onchange="updateEmergenceFeedback()">
                        Ant colonies (no queen directing, yet complex behavior emerges)
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="emerge-market" onchange="updateEmergenceFeedback()">
                        Free markets (price discovery from individual transactions)
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="emerge-planned" onchange="updateEmergenceFeedback()">
                        Planned economies (central committee designs outcomes)
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="emerge-language" onchange="updateEmergenceFeedback()">
                        Language evolution (no authority, yet rules emerge over time)
                    </label>
                </div>
                <div id="feedback1" class="feedback-box" style="display: none; margin-top: 1rem;"></div>

                <div style="margin-top: 2rem; padding-top: 2rem; border-top: 2px solid rgba(139, 111, 71, 0.2);">
                    <h4 style="color: var(--accent-bronze); margin-bottom: 1rem;"><span data-icon="target"></span> Deep Analysis (Optional)</h4>
                    <textarea id="question1-deep" placeholder="Why is emergence more robust? Think: single point of failure vs. distributed adaptation. How does Bitcoin's emergence compare to designed systems?" style="min-height: 120px;"></textarea>
                </div>
                <div class="save-indicator">‚úì Auto-saved locally</div>
            </div>

            <!-- Q2: Living vs Mechanical -->
            <div class="question-box">
                <h3>Question 2: Living vs. Mechanical</h3>
                <p style="color: var(--text-dim); margin-bottom: 1rem;">
                    Does Bitcoin challenge our definition of "life"?
                </p>

                <div class="reflection-tabs">
                    <button class="reflection-tab active" onclick="switchReflectionTab(2, 'quick', event)" role="tab" aria-selected="true"><span data-icon="lightning"></span> Quick</button>
                    <button class="reflection-tab" onclick="switchReflectionTab(2, 'deep', event)" role="tab" aria-selected="false"><span data-icon="target"></span> Deep</button>
                </div>

                <div id="q2-quick" class="reflection-panel active" aria-hidden="false">
                    <label style="display: block; margin-bottom: 0.5rem; color: var(--text-dim);">
                        Is Bitcoin "alive"?
                    </label>
                    <select id="question2-choice" class="choice-select" onchange="saveReflection('q2-choice', this.value)">
                        <option value="">Select...</option>
                        <option value="no-code">No. It's just code, not biological</option>
                        <option value="yes-traits">Yes. It exhibits life-like traits (homeostasis, adaptation, evolution)</option>
                        <option value="metaphor">It's a useful metaphor, but not literally alive</option>
                        <option value="new-category">It's a new category. Digital organism</option>
                    </select>
                    <button class="feedback-btn" onclick="checkReflection(2, 'quick')">Check Answer</button>
                    <div id="feedback2-quick" class="feedback-box" style="display: none;"></div>
                </div>

                <div id="q2-deep" class="reflection-panel" aria-hidden="true">
                    <textarea id="question2-deep" placeholder="Explore: What defines 'life'? Homeostasis, metabolism, adaptation, evolution, response to environment. Does Bitcoin exhibit these? What's the boundary between mechanical and alive?" style="min-height: 150px;"></textarea>
                    <button class="feedback-btn" onclick="checkReflection(2, 'deep')">Get Feedback</button>
                    <div id="feedback2-deep" class="feedback-box" style="display: none;"></div>
                </div>
                <div class="save-indicator">‚úì Auto-saved locally</div>
            </div>

            <!-- Q3: Centralized vs Distributed Intelligence -->
            <div class="question-box">
                <h3>Question 3: Centralized vs. Distributed Intelligence</h3>
                <p style="color: var(--text-dim); margin-bottom: 1rem;">
                    When is decentralization superior to centralized control?
                </p>

                <div class="reflection-tabs">
                    <button class="reflection-tab active" onclick="switchReflectionTab(3, 'quick', event)" role="tab" aria-selected="true"><span data-icon="lightning"></span> Quick</button>
                    <button class="reflection-tab" onclick="switchReflectionTab(3, 'deep', event)" role="tab" aria-selected="false"><span data-icon="target"></span> Deep</button>
                </div>

                <div id="q3-quick" class="reflection-panel active" aria-hidden="false">
                    <label style="display: block; margin-bottom: 0.5rem; color: var(--text-dim);">
                        When is decentralization best?
                    </label>
                    <select id="question3-choice" class="choice-select" onchange="saveReflection('q3-choice', this.value)">
                        <option value="">Select...</option>
                        <option value="always">Always. Decentralization is always superior</option>
                        <option value="never">Never. Centralization is more efficient</option>
                        <option value="censorship">When censorship resistance is critical (money, speech, data)</option>
                        <option value="coordination">When coordination speed matters more than resilience</option>
                    </select>
                    <button class="feedback-btn" onclick="checkReflection(3, 'quick')">Check Answer</button>
                    <div id="feedback3-quick" class="feedback-box" style="display: none;"></div>
                </div>

                <div id="q3-deep" class="reflection-panel" aria-hidden="true">
                    <textarea id="question3-deep" placeholder="Compare: Companies (centralized) vs. Bitcoin (decentralized). What are trade-offs? When does distributed intelligence outperform central planning? Consider: adaptation, single points of failure, censorship." style="min-height: 150px;"></textarea>
                    <button class="feedback-btn" onclick="checkReflection(3, 'deep')">Get Feedback</button>
                    <div id="feedback3-deep" class="feedback-box" style="display: none;"></div>
                </div>
                <div class="save-indicator">‚úì Auto-saved locally</div>
            </div>
        </div>

        <!-- Next Steps -->
        <div class="next-module">
            <h2 style="color: var(--accent-bronze); margin-bottom: 1rem;">Stage 4 Complete!</h2>
            <p style="color: var(--text-dim); margin-bottom: 2rem;">
                You've learned how Bitcoin emerges as a living system from physics, game theory, and incentives.
                Next, explore Bitcoin's impact beyond money‚Äîon energy, verification, and human coordination.
            </p>
            <a href="/paths/principled/stage-5/">
                Continue to Stage 5: Beyond Money ‚Üí
            </a>
        </div>
    </div>

    <script>
        // ===== Homeostasis Simulator =====
        let hashrate = 100; // EH/s
        let difficulty = 1.0;
        let blockTime = 10.0; // minutes

        function adjustHashrate(multiplier) {
            hashrate *= multiplier;
            blockTime = 10 / multiplier;

            document.getElementById('hashrateBar').style.width = Math.min(hashrate, 200) + '%';
            document.getElementById('hashrateBar').textContent = Math.round(hashrate) + ' EH/s';
            document.getElementById('blockTime').textContent = blockTime.toFixed(1) + ' min';

            if (multiplier > 1) {
                logHomeostasis(`‚ö° Hashrate doubled! New miners joined. Block time dropped to ${blockTime.toFixed(1)} minutes.`);
                logHomeostasis(`‚ö†Ô∏è Network is producing blocks too quickly. Adjustment needed in ~2 weeks.`);
            } else {
                logHomeostasis(`üìâ Hashrate halved! Miners left network. Block time increased to ${blockTime.toFixed(1)} minutes.`);
                logHomeostasis(`‚ö†Ô∏è Network is producing blocks too slowly. Adjustment needed in ~2 weeks.`);
            }
        }

        function runDifficultyAdjustment() {
            const targetTime = 10.0;
            const adjustmentFactor = blockTime / targetTime;

            difficulty *= adjustmentFactor;
            blockTime = targetTime;

            document.getElementById('difficulty').textContent = difficulty.toFixed(2) + 'x';
            document.getElementById('blockTime').textContent = blockTime.toFixed(1) + ' min';

            logHomeostasis(`üîß Difficulty adjustment executed!`);
            logHomeostasis(`üìä New difficulty: ${difficulty.toFixed(2)}x (${adjustmentFactor > 1 ? 'decreased' : 'increased'})`);
            logHomeostasis(`‚úÖ Block time restored to 10.0 minutes. Homeostasis achieved!`);
            logHomeostasis(`üå± Network self-regulated without any central authority.`);
        }

        function resetHomeostasis() {
            hashrate = 100;
            difficulty = 1.0;
            blockTime = 10.0;

            document.getElementById('hashrateBar').style.width = '50%';
            document.getElementById('hashrateBar').textContent = '100 EH/s';
            document.getElementById('blockTime').textContent = '10.0 min';
            document.getElementById('difficulty').textContent = '1.00x';
            document.getElementById('homeostasisLog').innerHTML = '';

            logHomeostasis('üîÑ System reset to baseline state');
        }

        function logHomeostasis(message) {
            const log = document.getElementById('homeostasisLog');
            const timestamp = new Date().toLocaleTimeString();
            // SECURITY: Escape message to prevent XSS (even for internal messages)
            const escapeHTML = window.BSASecurity?.escapeHTML || ((text) => {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            });
            const safeMessage = escapeHTML(String(message || ''));
            log.innerHTML = `<div>${timestamp}: ${safeMessage}</div>` + log.innerHTML;
        }

        // ===== Immune Response Simulator =====
        let networkHealth = 100;
        let honestNodePercent = 95;

        function introduceAttack(type) {
            const attacks = {
                spam: {
                    name: 'Spam Attack',
                    healthDrop: 15,
                    description: 'Flooding mempool with low-fee transactions'
                },
                invalid: {
                    name: 'Invalid Block Attack',
                    healthDrop: 20,
                    description: 'Broadcasting blocks with invalid transactions'
                },
                sybil: {
                    name: 'Sybil Attack',
                    healthDrop: 10,
                    description: 'Creating thousands of fake nodes'
                }
            };

            const attack = attacks[type];
            networkHealth = Math.max(networkHealth - attack.healthDrop, 0);
            honestNodePercent = Math.max(honestNodePercent - 5, 60);

            updateImmuneDisplay();

            logImmune(`‚ö†Ô∏è ${attack.name} detected: ${attack.description}`);
            logImmune(`üìâ Network health dropped to ${networkHealth}%`);
            logImmune(`üõ°Ô∏è Immune response activating...`);

            setTimeout(() => {
                if (type === 'spam') {
                    logImmune(`‚úì Fee market activated: High-fee transactions prioritized, spam filtered out`);
                } else if (type === 'invalid') {
                    logImmune(`‚úì Nodes rejected invalid blocks: Consensus rules enforced automatically`);
                } else if (type === 'sybil') {
                    logImmune(`‚úì Real nodes identified fake nodes: Connection limits protect network`);
                }
                logImmune(`üí™ Attack neutralized. Network demonstrated resilience.`);
            }, 2000);
        }

        function healNetwork() {
            logImmune(`‚öïÔ∏è Initiating self-healing process...`);

            const healInterval = setInterval(() => {
                if (networkHealth >= 100 && honestNodePercent >= 95) {
                    clearInterval(healInterval);
                    logImmune(`‚úÖ Network fully recovered to 100% health`);
                    logImmune(`üå± Bitcoin demonstrated antifragility: stronger after stress`);
                    return;
                }

                networkHealth = Math.min(networkHealth + 5, 100);
                honestNodePercent = Math.min(honestNodePercent + 2, 95);
                updateImmuneDisplay();
            }, 500);
        }

        function updateImmuneDisplay() {
            document.getElementById('networkHealth').textContent = networkHealth + '%';
            document.getElementById('networkHealth').style.color = networkHealth > 70 ? '#2ecc71' : '#e74c3c';
            document.getElementById('honestNodes').textContent = honestNodePercent + '%';
            document.getElementById('integrityBar').style.width = networkHealth + '%';
            document.getElementById('integrityBar').textContent = networkHealth + '%';
        }

        function logImmune(message) {
            const log = document.getElementById('immuneLog');
            const timestamp = new Date().toLocaleTimeString();
            // SECURITY: Escape message to prevent XSS
            const escapeHTML = window.BSASecurity?.escapeHTML || ((text) => {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            });
            const safeMessage = escapeHTML(String(message || ''));
            log.innerHTML = `<div>${timestamp}: ${safeMessage}</div>` + log.innerHTML;
        }

        // ===== Tab Switching =====
        function switchTab(tab) {
            document.querySelectorAll('.demo-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.demo-panel').forEach(p => p.classList.remove('active'));

            event.target.classList.add('active');
            document.getElementById(`${tab}-panel`).classList.add('active');
        }

        // ===== Interactive Reflection System =====
        const STORAGE_KEY = 'principled-stage4-module3-reflections';

        function saveReflection(key, value) {
            const reflections = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}');
            reflections[key] = value;
            localStorage.setItem(STORAGE_KEY, JSON.stringify(reflections));
        }

        function loadReflections() {
            const reflections = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}');

            // Load Q1 checkboxes and deep
            if (reflections['emerge-ant']) document.getElementById('emerge-ant').checked = true;
            if (reflections['emerge-market']) document.getElementById('emerge-market').checked = true;
            if (reflections['emerge-planned']) document.getElementById('emerge-planned').checked = true;
            if (reflections['emerge-language']) document.getElementById('emerge-language').checked = true;
            const q1Deep = document.getElementById('question1-deep');
            if (q1Deep && reflections['q1-deep']) q1Deep.value = reflections['q1-deep'];

            // Load Q2
            const q2Choice = document.getElementById('question2-choice');
            const q2Deep = document.getElementById('question2-deep');
            if (q2Choice && reflections['q2-choice']) q2Choice.value = reflections['q2-choice'];
            if (q2Deep && reflections['q2-deep']) q2Deep.value = reflections['q2-deep'];

            // Load Q3
            const q3Choice = document.getElementById('question3-choice');
            const q3Deep = document.getElementById('question3-deep');
            if (q3Choice && reflections['q3-choice']) q3Choice.value = reflections['q3-choice'];
            if (q3Deep && reflections['q3-deep']) q3Deep.value = reflections['q3-deep'];

            // Trigger feedback
            updateEmergenceFeedback();
        }

        function switchReflectionTab(questionNum, level, event) {
            document.querySelectorAll(`#q${questionNum}-quick, #q${questionNum}-deep`).forEach(panel => {
                panel.classList.remove('active');
                panel.setAttribute('aria-hidden', 'true');
            });
            event.target.parentElement.querySelectorAll('.reflection-tab').forEach(tab => {
                tab.classList.remove('active');
                tab.setAttribute('aria-selected', 'false');
            });
            const panel = document.getElementById(`q${questionNum}-${level}`);
            panel.classList.add('active');
            panel.setAttribute('aria-hidden', 'false');
            event.target.classList.add('active');
            event.target.setAttribute('aria-selected', 'true');
        }

        // Q1: Emergence
        function updateEmergenceFeedback() {
            const ant = document.getElementById('emerge-ant').checked;
            const market = document.getElementById('emerge-market').checked;
            const planned = document.getElementById('emerge-planned').checked;
            const language = document.getElementById('emerge-language').checked;

            const feedbackDiv = document.getElementById('feedback1');
            let feedback = '';

            // Save
            saveReflection('emerge-ant', ant);
            saveReflection('emerge-market', market);
            saveReflection('emerge-planned', planned);
            saveReflection('emerge-language', language);

            const correctCount = [ant, market, language].filter(Boolean).length;

            if (ant && market && language && !planned) {
                feedback = `<h5>‚úì Perfect Understanding!</h5><p>Correct! Emergent systems:<br><strong>1. Ant colonies</strong>: No central control, yet collective intelligence<br><strong>2. Free markets</strong>: Prices emerge from millions of individual decisions<br><strong>3. Language</strong>: Grammar and vocabulary evolve organically<br><br>Planned economies are <em>designed</em>, not emergent‚Äîa central authority dictates outcomes. This is why they fail: no distributed adaptation.</p>`;
                feedbackDiv.className = 'feedback-box positive';
            } else if (planned && correctCount === 3) {
                feedback = `<h5>‚ö†Ô∏è Reconsider "Planned Economies"</h5><p>You correctly identified the three emergent systems, but planned economies are the opposite‚Äî<strong>top-down design</strong>, not emergence. A central committee tries to control all production and distribution. This lacks distributed feedback and adaptation, which is why planned economies consistently fail.</p>`;
                feedbackDiv.className = 'feedback-box hint';
            } else if (correctCount === 3) {
                feedback = `<h5>‚úì Almost Perfect!</h5><p>You've identified the emergent systems! Emergence is more robust than design because: (1) No single point of failure, (2) Distributed adaptation to change, (3) Bottom-up intelligence vs. top-down control. Bitcoin exhibits all these properties.</p>`;
                feedbackDiv.className = 'feedback-box neutral';
            } else if (correctCount >= 1) {
                feedback = `<h5>Good Start!</h5><p>You've identified ${correctCount} emergent system${correctCount > 1 ? 's' : ''}. Consider: ${!ant ? 'Ant colonies have no queen directing them, yet complex behavior emerges. ' : ''}${!market ? 'Free markets discover prices without central planning. ' : ''}${!language ? 'Language evolves without an authority dictating rules.' : ''}</p>`;
                feedbackDiv.className = 'feedback-box hint';
            } else {
                feedback = `<h5><span data-icon="lightbulb"></span> Hint</h5><p>Think about systems where complex behavior arises from simple rules, without central control. Which systems have a central authority vs. distributed decision-making?</p>`;
                feedbackDiv.className = 'feedback-box hint';
            }

            feedbackDiv.innerHTML = feedback;
            feedbackDiv.style.display = 'block';
        }

        // Q2 & Q3: Living and Decentralization
        function checkReflection(questionNum, level) {
            if (questionNum === 2 && level === 'quick') {
                const choice = document.getElementById('question2-choice').value;
                const feedbackDiv = document.getElementById('feedback2-quick');
                let feedback = '';

                if (!choice) {
                    feedback = `<h5><span data-icon="lightbulb"></span> Hint</h5><p>Please select an answer.</p>`;
                    feedbackDiv.className = 'feedback-box hint';
                } else if (choice === 'yes-traits') {
                    feedback = `<h5>‚úì Thoughtful Answer!</h5><p>Bitcoin exhibits key life-like traits:<br>1. <strong>Homeostasis</strong>: Self-regulates (difficulty adjustment)<br>2. <strong>Adaptation</strong>: Responds to environment (hashrate changes)<br>3. <strong>Evolution</strong>: Soft forks, protocol upgrades<br>4. <strong>Metabolism</strong>: Consumes energy, produces security<br><br>Whether it's "alive" depends on your definition of life. It challenges the biological boundary.</p>`;
                    feedbackDiv.className = 'feedback-box positive';
                } else if (choice === 'metaphor' || choice === 'new-category') {
                    feedback = `<h5>‚úì Valid Perspective!</h5><p>${choice === 'metaphor' ? 'Using "living" as a metaphor' : 'Considering Bitcoin a new category'} is reasonable. It exhibits homeostasis, adaptation, and evolution‚Äîbut lacks biological metabolism. The key insight: <strong>emergent systems can behave as if alive</strong> even without cells or DNA. This challenges our anthropocentric definitions.</p>`;
                    feedbackDiv.className = 'feedback-box neutral';
                } else if (choice === 'no-code') {
                    feedback = `<h5>‚ö†Ô∏è Reconsider</h5><p>"Just code" undersells what's happening. Bitcoin <em>self-regulates</em> (homeostasis), <em>adapts</em> to its environment, and <em>evolves</em> through consensus upgrades. These are hallmarks of life. Even if it's not biological, it exhibits properties we associate with living organisms. Does life require carbon-based biology?</p>`;
                    feedbackDiv.className = 'feedback-box hint';
                }

                feedbackDiv.innerHTML = feedback;
                feedbackDiv.style.display = 'block';
                saveReflection('q2-choice', choice);
            } else if (questionNum === 2 && level === 'deep') {
                const text = document.getElementById('question2-deep').value.trim().toLowerCase();
                const feedbackDiv = document.getElementById('feedback2-deep');
                let feedback = '';

                if (text.length < 50) {
                    feedback = `<h5><span data-icon="lightbulb"></span> Hint</h5><p>Try 3-4 sentences. Consider: What defines life? Does Bitcoin exhibit these traits? Where's the boundary?</p>`;
                    feedbackDiv.className = 'feedback-box hint';
                } else {
                    const hasTraits = text.match(/\b(homeosta|adapt|evolv|metabol|respond|self.?regulat|environment)\b/);
                    const hasBoundary = text.match(/\b(biological|carbon|cell|dna|boundary|definition|mechanical|organic)\b/);
                    const hasChallenge = text.match(/\b(challenge|redefine|new|category|digital|organism|life.?like)\b/);

                    const score = [hasTraits, hasBoundary, hasChallenge].filter(Boolean).length;

                    if (score === 3) {
                        feedback = `<h5>‚úì Excellent Analysis!</h5><p>You've explored the full question: (1) Bitcoin exhibits life-like traits (homeostasis, adaptation, evolution), (2) The boundary between biological and mechanical is fuzzy, (3) Bitcoin challenges our definitions‚Äîit's a digital organism that behaves as if alive. This is genuinely new.</p>`;
                        feedbackDiv.className = 'feedback-box positive';
                    } else if (score === 2) {
                        feedback = `<h5>Good Exploration!</h5><p>You're thinking deeply. To complete: ${!hasTraits ? 'List life-like traits (homeostasis, adaptation, evolution, metabolism).' : ''} ${!hasBoundary ? 'Where is the boundary between biological life and mechanical systems?' : ''} ${!hasChallenge ? 'Does Bitcoin challenge our definition of "life"?' : ''}</p>`;
                        feedbackDiv.className = 'feedback-box neutral';
                    } else {
                        feedback = `<h5><span data-icon="lightbulb"></span> Keep Going</h5><p>Consider: (1) What traits define life? (2) Does biology (cells, DNA) define life, or behavior (adaptation, homeostasis)? (3) Does Bitcoin expand what we consider "alive"?</p>`;
                        feedbackDiv.className = 'feedback-box hint';
                    }
                }

                feedbackDiv.innerHTML = feedback;
                feedbackDiv.style.display = 'block';
                saveReflection('q2-deep', document.getElementById('question2-deep').value);
            } else if (questionNum === 3 && level === 'quick') {
                const choice = document.getElementById('question3-choice').value;
                const feedbackDiv = document.getElementById('feedback3-quick');
                let feedback = '';

                if (!choice) {
                    feedback = `<h5><span data-icon="lightbulb"></span> Hint</h5><p>Please select an answer.</p>`;
                    feedbackDiv.className = 'feedback-box hint';
                } else if (choice === 'censorship') {
                    feedback = `<h5>‚úì Correct!</h5><p>Decentralization excels when <strong>censorship resistance</strong> is critical:<br>‚Ä¢ <strong>Money</strong>: Can't be frozen or confiscated<br>‚Ä¢ <strong>Speech</strong>: Can't be silenced (e.g., decentralized social media)<br>‚Ä¢ <strong>Data</strong>: Can't be deleted or altered<br><br>Trade-off: Decentralization is slower and less efficient than centralized systems. But when resilience and censorship resistance matter more than speed, decentralization wins.</p>`;
                    feedbackDiv.className = 'feedback-box positive';
                } else if (choice === 'always') {
                    feedback = `<h5>‚ö†Ô∏è Too Absolute</h5><p>Decentralization isn't <em>always</em> better. Centralized systems can be faster, more efficient, and easier to coordinate (e.g., companies shipping products). Decentralization excels when <strong>censorship resistance and resilience</strong> are critical‚Äîlike money, speech, and data that must survive adversarial environments.</p>`;
                    feedbackDiv.className = 'feedback-box hint';
                } else if (choice === 'never') {
                    feedback = `<h5>‚ö†Ô∏è Reconsider</h5><p>While centralized systems are often more efficient, they have a critical weakness: <strong>single points of failure and censorship</strong>. For money, speech, and data that must resist control, decentralization is superior. Bitcoin proves this‚Äîno CEO, no central bank, yet it functions globally for 15+ years.</p>`;
                    feedbackDiv.className = 'feedback-box hint';
                } else if (choice === 'coordination') {
                    feedback = `<h5>‚ö†Ô∏è Backwards</h5><p>That describes when <em>centralization</em> is better (speed over resilience). Decentralization is superior when <strong>censorship resistance and resilience</strong> matter more than coordination speed. Example: Bitcoin is slow (10-minute blocks) but unstoppable (no one can shut it down).</p>`;
                    feedbackDiv.className = 'feedback-box hint';
                }

                feedbackDiv.innerHTML = feedback;
                feedbackDiv.style.display = 'block';
                saveReflection('q3-choice', choice);
            } else if (questionNum === 3 && level === 'deep') {
                const text = document.getElementById('question3-deep').value.trim().toLowerCase();
                const feedbackDiv = document.getElementById('feedback3-deep');
                let feedback = '';

                if (text.length < 50) {
                    feedback = `<h5><span data-icon="lightbulb"></span> Hint</h5><p>Try 3-4 sentences. Consider: Trade-offs (speed vs. resilience), single points of failure, censorship resistance.</p>`;
                    feedbackDiv.className = 'feedback-box hint';
                } else {
                    const hasTradeoffs = text.match(/\b(trade.?off|speed|slow|efficient|coordinat|fast|quick)\b/);
                    const hasResilience = text.match(/\b(resilien|robust|fail|single.?point|attack|censorship|unstoppable)\b/);
                    const hasExamples = text.match(/\b(company|ceo|bitcoin|government|market|organization)\b/);

                    const score = [hasTradeoffs, hasResilience, hasExamples].filter(Boolean).length;

                    if (score === 3) {
                        feedback = `<h5>‚úì Excellent Analysis!</h5><p>You've identified the key dynamics: (1) Centralization is faster and more efficient (companies, governments), (2) Decentralization is more resilient and censorship-resistant (Bitcoin, markets), (3) The choice depends on priorities‚Äîspeed vs. resilience. When survival in adversarial environments matters, decentralization wins.</p>`;
                        feedbackDiv.className = 'feedback-box positive';
                    } else if (score === 2) {
                        feedback = `<h5>Good Understanding!</h5><p>You're on track. To complete: ${!hasTradeoffs ? 'Discuss trade-offs (centralization = speed, decentralization = resilience).' : ''} ${!hasResilience ? 'Explain resilience advantages (no single point of failure, censorship resistance).' : ''} ${!hasExamples ? 'Give examples: companies (centralized) vs. Bitcoin (decentralized).' : ''}</p>`;
                        feedbackDiv.className = 'feedback-box neutral';
                    } else {
                        feedback = `<h5><span data-icon="lightbulb"></span> Keep Going</h5><p>Address: (1) Trade-offs between centralized and decentralized systems, (2) When resilience/censorship resistance matter more than speed, (3) Real-world examples (companies vs. Bitcoin).</p>`;
                        feedbackDiv.className = 'feedback-box hint';
                    }
                }

                feedbackDiv.innerHTML = feedback;
                feedbackDiv.style.display = 'block';
                saveReflection('q3-deep', document.getElementById('question3-deep').value);
            }
        }

        // Initialize on load
        window.addEventListener('DOMContentLoaded', () => {
            loadReflections();
            resetHomeostasis();
            updateImmuneDisplay();

            // Auto-save text inputs
            const q1Deep = document.getElementById('question1-deep');
            const q2Deep = document.getElementById('question2-deep');
            const q3Deep = document.getElementById('question3-deep');
            if (q1Deep) q1Deep.addEventListener('input', (e) => saveReflection('q1-deep', e.target.value));
            if (q2Deep) q2Deep.addEventListener('input', (e) => saveReflection('q2-deep', e.target.value));
            if (q3Deep) q3Deep.addEventListener('input', (e) => saveReflection('q3-deep', e.target.value));
        });
    </script>

    <!-- Animated Icon Library -->
    <script src="/js/icon-library.js"></script>
    <script>
        // Inject icons after DOM loads
        document.addEventListener('DOMContentLoaded', function() {
            if (window.IconLibrary) {
                document.querySelectorAll('[data-icon]').forEach(function(element) {
                    var iconName = element.getAttribute('data-icon');
                    if (iconName) {
                        var iconHTML = IconLibrary.get(iconName, 20, true);
                        var span = document.createElement('span');
                        span.innerHTML = iconHTML;
                        span.className = 'icon-inline';
                        span.style.marginRight = '0.5rem';
                        span.style.display = 'inline-block';
                        span.style.verticalAlign = 'middle';
                        element.insertBefore(span, element.firstChild);
                    }
                });
            }
        });
    </script>


</body></html>