<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>How Bitcoin Works | The Curious Path</title>
    <meta name="description" content="Learn about the blockchain, how transactions work, and what mining actually does with interactive demonstrations.">

    <style>
        :root {
            --primary-orange: #f7931a;
            --primary-dark: #1a1a1a;
            --secondary-dark: #2d2d2d;
            --accent-green: #4caf50;
            --text-light: #e0e0e0;
            --text-dim: #999;
            --border-color: rgba(247, 147, 26, 0.2);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--primary-dark);
            color: var(--text-light);
            line-height: 1.6;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        /* Module Header */
        .module-header {
            background: var(--secondary-dark);
            border-bottom: 2px solid var(--primary-orange);
            padding: 1.5rem 0;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .breadcrumb {
            font-size: 0.85rem;
            color: var(--text-dim);
            margin-bottom: 0.5rem;
        }

        .breadcrumb a {
            color: var(--primary-orange);
            text-decoration: none;
        }

        .breadcrumb a:hover {
            text-decoration: underline;
        }

        .module-title-section {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .module-title-section h1 {
            font-size: 1.75rem;
            color: var(--accent-green);
        }

        .module-meta {
            display: flex;
            gap: 1rem;
            font-size: 0.85rem;
            color: var(--text-dim);
        }

        /* Content Sections */
        .content-section {
            padding: 2.5rem 0;
            border-bottom: 1px solid var(--border-color);
        }

        .content-section:last-of-type {
            border-bottom: none;
        }

        .content-section h2 {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            color: var(--primary-orange);
        }

        .content-section h3 {
            font-size: 1.2rem;
            margin: 1.5rem 0 0.75rem;
            color: var(--primary-orange);
        }

        .content-section p {
            margin-bottom: 1rem;
            color: var(--text-light);
        }

        /* Demo Embed */
        .demo-embed {
            background: var(--secondary-dark);
            border: 2px solid var(--primary-orange);
            border-radius: 1rem;
            padding: 2rem;
            margin: 2rem 0;
            text-align: center;
        }

        .demo-embed h3 {
            color: var(--primary-orange);
            margin-bottom: 1rem;
        }

        .demo-embed p {
            color: var(--text-dim);
            margin-bottom: 1.5rem;
        }

        .demo-link {
            display: inline-block;
            padding: 1rem 2rem;
            background: var(--primary-orange);
            color: white;
            text-decoration: none;
            border-radius: 0.5rem;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .demo-link:hover {
            background: #ff8c00;
            transform: translateY(-2px);
        }

        /* Visualization */
        .blockchain-viz {
            background: var(--secondary-dark);
            border: 2px solid var(--border-color);
            border-radius: 1rem;
            padding: 2rem;
            margin: 2rem 0;
        }

        .blocks-container {
            display: flex;
            gap: 1rem;
            overflow-x: auto;
            padding: 1rem 0;
        }

        .block {
            min-width: 200px;
            background: rgba(247, 147, 26, 0.1);
            border: 2px solid var(--primary-orange);
            border-radius: 0.75rem;
            padding: 1rem;
            position: relative;
        }

        .block::after {
            content: "→";
            position: absolute;
            right: -1.5rem;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1.5rem;
            color: var(--primary-orange);
        }

        .block:last-child::after {
            display: none;
        }

        .block-header {
            font-weight: 700;
            color: var(--primary-orange);
            margin-bottom: 0.75rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid var(--border-color);
        }

        .block-data {
            font-size: 0.85rem;
            color: var(--text-dim);
        }

        .block-data div {
            margin-bottom: 0.5rem;
        }

        .hash-value {
            font-family: 'Courier New', monospace;
            font-size: 0.75rem;
            word-break: break-all;
            color: var(--accent-green);
        }

        /* Transaction Flow */
        .transaction-flow {
            background: var(--secondary-dark);
            border: 2px solid var(--border-color);
            border-radius: 1rem;
            padding: 2rem;
            margin: 2rem 0;
        }

        .flow-diagram {
            display: grid;
            grid-template-columns: 1fr auto 1fr auto 1fr;
            align-items: center;
            gap: 1rem;
            margin: 2rem 0;
        }

        .flow-box {
            background: rgba(247, 147, 26, 0.2);
            border: 2px solid var(--primary-orange);
            border-radius: 0.75rem;
            padding: 1.5rem;
            text-align: center;
        }

        .flow-box h4 {
            color: var(--primary-orange);
            margin-bottom: 0.75rem;
        }

        .flow-arrow {
            font-size: 2rem;
            color: var(--primary-orange);
        }

        .utxo-example {
            background: rgba(76, 175, 80, 0.1);
            border-left: 4px solid var(--accent-green);
            border-radius: 0.5rem;
            padding: 1.5rem;
            margin: 1.5rem 0;
        }

        .utxo-example h4 {
            color: var(--accent-green);
            margin-bottom: 1rem;
        }

        .utxo-list {
            display: grid;
            gap: 0.75rem;
        }

        .utxo-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(247, 147, 26, 0.1);
            padding: 0.75rem;
            border-radius: 0.5rem;
        }

        .utxo-amount {
            font-weight: 700;
            color: var(--primary-orange);
        }

        /* Concept Cards */
        .concept-cards {
            display: grid;
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .concept-card {
            background: var(--secondary-dark);
            border: 2px solid var(--border-color);
            border-radius: 0.75rem;
            padding: 1.5rem;
        }

        .concept-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .concept-icon {
            font-size: 2rem;
        }

        .concept-header h3 {
            color: var(--primary-orange);
            margin: 0;
        }

        /* Key Takeaways */
        .takeaways {
            background: rgba(76, 175, 80, 0.1);
            border-left: 4px solid var(--accent-green);
            border-radius: 0.5rem;
            padding: 1.5rem;
            margin: 2rem 0;
        }

        .takeaways h3 {
            color: var(--accent-green);
            margin-bottom: 1rem;
        }

        .takeaways ul {
            list-style: none;
            padding-left: 0;
        }

        .takeaways li {
            padding-left: 1.5rem;
            margin-bottom: 0.5rem;
            position: relative;
        }

        .takeaways li:before {
            content: "✓";
            position: absolute;
            left: 0;
            color: var(--accent-green);
            font-weight: 700;
        }

        /* Quiz */
        .quiz-container {
            background: var(--secondary-dark);
            border: 2px solid var(--primary-orange);
            border-radius: 1rem;
            padding: 2rem;
            margin: 2rem 0;
        }

        .quiz-container h3 {
            color: var(--primary-orange);
            margin-bottom: 1.5rem;
            font-size: 1.25rem;
        }

        .quiz-question {
            margin-bottom: 2rem;
        }

        .quiz-question p {
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--text-light);
        }

        .quiz-options {
            display: grid;
            gap: 0.75rem;
        }

        .quiz-option {
            background: rgba(247, 147, 26, 0.1);
            border: 2px solid var(--border-color);
            border-radius: 0.5rem;
            padding: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .quiz-option:hover {
            border-color: var(--primary-orange);
            background: rgba(247, 147, 26, 0.2);
        }

        .quiz-option.selected {
            border-color: var(--primary-orange);
            background: rgba(247, 147, 26, 0.2);
        }

        .quiz-option.correct {
            border-color: var(--accent-green);
            background: rgba(76, 175, 80, 0.2);
        }

        .quiz-option.incorrect {
            border-color: #f44336;
            background: rgba(244, 67, 54, 0.2);
        }

        .quiz-feedback {
            margin-top: 1rem;
            padding: 1rem;
            border-radius: 0.5rem;
            display: none;
        }

        .quiz-feedback.show {
            display: block;
        }

        .quiz-feedback.correct {
            background: rgba(76, 175, 80, 0.2);
            color: var(--accent-green);
        }

        .quiz-feedback.incorrect {
            background: rgba(244, 67, 54, 0.2);
            color: #ff6b6b;
        }

        .quiz-submit {
            background: var(--primary-orange);
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 0.5rem;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 1.5rem;
        }

        .quiz-submit:hover {
            background: #ff8c00;
        }

        .quiz-submit:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Navigation */
        .module-navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 2rem 0;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .nav-btn {
            padding: 0.75rem 1.5rem;
            background: var(--primary-orange);
            color: white;
            text-decoration: none;
            border-radius: 0.5rem;
            font-weight: 600;
            transition: all 0.3s ease;
            display: inline-block;
        }

        .nav-btn:hover {
            background: #ff8c00;
            transform: translateX(5px);
        }

        .nav-btn.disabled {
            opacity: 0.5;
            pointer-events: none;
        }

        .nav-btn-secondary {
            background: transparent;
            border: 2px solid var(--border-color);
            color: var(--text-light);
        }

        .nav-btn-secondary:hover {
            border-color: var(--primary-orange);
            background: rgba(247, 147, 26, 0.1);
            transform: translateX(-5px);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .module-title-section {
                flex-direction: column;
                align-items: flex-start;
            }

            .flow-diagram {
                grid-template-columns: 1fr;
            }

            .flow-arrow {
                transform: rotate(90deg);
            }

            .module-navigation {
                flex-direction: column;
            }

            .nav-btn {
                width: 100%;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <!-- Module Header -->
    <header class="module-header">
        <div class="container">
            <div class="breadcrumb">
                <a href="/">Home</a> →
                <a href="/paths/curious/">The Curious Path</a> →
                <a href="/paths/curious/stage-2/">Stage 2</a> →
                <span>Module 1</span>
            </div>
            <div class="module-title-section">
                <h1>How Bitcoin Works</h1>
                <div class="module-meta">
                    <span>⏱️ 30 minutes</span>
                    <span>📝 Quiz included</span>
                    <span>🎮 Interactive</span>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main>
        <div class="container">
            <!-- Introduction -->
            <section class="content-section">
                <h2>Understanding the Machine Behind the Magic</h2>
                <p>
                    You already know why Bitcoin matters—now let's uncover how it works. Don't worry, you won't need any coding knowledge. Everything here is visual, practical, and easy to grasp.
                </p>
                <p>
                    Bitcoin is built from three key innovations that work together seamlessly:
                </p>
                <ol style="margin-left: 2rem; margin-bottom: 1rem; color: var(--text-light);">
                    <li><strong>The Blockchain</strong> — a shared public ledger</li>
                    <li><strong>Transactions</strong> — the rules for how value moves</li>
                    <li><strong>Mining</strong> — the system that secures and synchronizes everything</li>
                </ol>
            </section>

            <!-- Part 1: The Blockchain -->
            <section class="content-section">
                <h2>⚙️ Part 1: The Blockchain – Bitcoin's Memory</h2>
                <p>
                    Think of the blockchain as a digital notebook where every page is glued to the next. Each page (block) records new Bitcoin transactions and references the one before it, creating an unbreakable chain.
                </p>

                <h3>Each block includes:</h3>
                <ul style="margin-left: 2rem; margin-bottom: 1rem;">
                    <li><strong>Transactions:</strong> Bitcoin transfers between users</li>
                    <li><strong>Previous Block Hash:</strong> The unique fingerprint linking it to the past</li>
                    <li><strong>Timestamp:</strong> When it was added</li>
                    <li><strong>Nonce:</strong> A random number miners adjust to find a valid hash</li>
                </ul>

                <p>
                    <strong>Why this matters:</strong> If anyone tries to alter an old block, the hash changes and breaks the chain. The network instantly rejects it. This design makes Bitcoin's history tamper-evident and self-defending—no central authority needed.
                </p>

                <!-- Blockchain Visualization -->
                <div class="blockchain-viz">
                    <h3 style="color: var(--primary-orange); margin-bottom: 1.5rem;">📦 How Blocks Link Together</h3>
                    <div class="blocks-container">
                        <div class="block">
                            <div class="block-header">Block #100</div>
                            <div class="block-data">
                                <div><strong>Transactions:</strong> 2,500</div>
                                <div><strong>Previous Hash:</strong></div>
                                <div class="hash-value">00000a8c...</div>
                                <div><strong>This Block Hash:</strong></div>
                                <div class="hash-value">00000b3f...</div>
                            </div>
                        </div>

                        <div class="block">
                            <div class="block-header">Block #101</div>
                            <div class="block-data">
                                <div><strong>Transactions:</strong> 2,700</div>
                                <div><strong>Previous Hash:</strong></div>
                                <div class="hash-value">00000b3f...</div>
                                <div><strong>This Block Hash:</strong></div>
                                <div class="hash-value">00000c7d...</div>
                            </div>
                        </div>

                        <div class="block">
                            <div class="block-header">Block #102</div>
                            <div class="block-data">
                                <div><strong>Transactions:</strong> 3,100</div>
                                <div><strong>Previous Hash:</strong></div>
                                <div class="hash-value">00000c7d...</div>
                                <div><strong>This Block Hash:</strong></div>
                                <div class="hash-value">00000d9e...</div>
                            </div>
                        </div>
                    </div>
                    <p style="text-align: center; color: var(--text-dim); margin-top: 1rem; font-size: 0.9rem;">
                        Notice how each block's hash becomes the "Previous Hash" for the next block. This creates an unbreakable chain.
                    </p>
                </div>

                <!-- Interactive Building the Chain Demo -->
                <div class="demo-embed">
                    <h3>🔗 Interactive: Building the Chain</h3>
                    <p style="margin-bottom: 1.5rem;">
                        Build your own blockchain! Add transactions, mine blocks, and see what happens when you try to tamper with the chain.
                    </p>
                    <iframe
                        src="/interactive-demos/building-the-chain-demo/index.html?level=beginner&path=curious"
                        style="width: 100%; height: 850px; border: 2px solid var(--primary-orange); border-radius: 0.75rem;"
                        title="Building the Chain - Beginner Mode">
                    </iframe>
                    <p style="margin-top: 1rem; text-align: center; color: var(--text-dim); font-size: 0.9rem;">
                        💡 Try adding blocks, then attempt to change an old transaction. Watch the cascade effect!
                    </p>
                </div>

                <!-- Interactive Double-Spending Demo -->
                <div class="demo-embed">
                    <h3>🚫 Interactive: Double-Spending Prevention</h3>
                    <p style="margin-bottom: 1.5rem;">
                        See how Bitcoin prevents the same coin from being spent twice using the blockchain. Try the attack in both scenarios!
                    </p>
                    <iframe
                        src="/interactive-demos/double-spending-demo/index.html?level=beginner&path=curious"
                        style="width: 100%; height: 800px; border: 2px solid var(--primary-orange); border-radius: 0.75rem;"
                        title="Double-Spending Demo - Beginner Mode">
                    </iframe>
                    <p style="margin-top: 1rem; text-align: center; color: var(--text-dim); font-size: 0.9rem;">
                        💡 Watch how traditional digital cash fails while Bitcoin's blockchain succeeds!
                    </p>
                </div>
            </section>

            <!-- Part 2: Transactions -->
            <section class="content-section">
                <h2>💸 Part 2: Transactions – How Bitcoin Actually Moves</h2>
                <p>
                    Bitcoin doesn't track balances like banks. It uses <strong>UTXOs—Unspent Transaction Outputs</strong>.
                </p>
                <p>
                    Think of them like bills in your wallet: you can't tear one in half, but you can combine or split them when spending.
                </p>

                <!-- UTXO Example -->
                <div class="utxo-example">
                    <h4>Example:</h4>
                    <p style="color: var(--text-light); margin-bottom: 1rem;">
                        Alice holds three UTXOs totaling 0.10 BTC.<br>
                        She wants to send 0.07 BTC to Eve.
                    </p>
                    <div class="utxo-list">
                        <div class="utxo-item">
                            <span>UTXO #1</span>
                            <span class="utxo-amount">0.05 BTC</span>
                        </div>
                        <div class="utxo-item">
                            <span>UTXO #2</span>
                            <span class="utxo-amount">0.03 BTC</span>
                        </div>
                        <div class="utxo-item">
                            <span>UTXO #3</span>
                            <span class="utxo-amount">0.02 BTC</span>
                        </div>
                    </div>
                    <p style="margin-top: 1rem; color: var(--text-light);">
                        Her wallet combines two UTXOs (0.05 + 0.03), sends 0.07 BTC to Eve, and returns 0.0099 BTC as change.
                    </p>
                    <p style="margin-top: 0.5rem; color: var(--text-dim); font-size: 0.9rem;">
                        This simple model allows the network to verify ownership and prevent double spending—without needing bank accounts.
                    </p>
                </div>

                <!-- Interactive UTXO Visualizer Demo -->
                <div class="demo-embed">
                    <h3>🪙 Interactive UTXO Visualizer</h3>
                    <p style="margin-bottom: 1.5rem;">
                        See how Bitcoin manages "coins" (UTXOs) in your wallet. Click on coins to select them and build transactions!
                    </p>
                    <iframe
                        src="/interactive-demos/utxo-visualizer-enhanced/index.html?level=beginner&path=curious"
                        style="width: 100%; height: 900px; border: 2px solid var(--primary-orange); border-radius: 0.75rem;"
                        title="UTXO Visualizer - Beginner Mode">
                    </iframe>
                    <p style="margin-top: 1rem; text-align: center; color: var(--text-dim); font-size: 0.9rem;">
                        💡 Follow the step-by-step instructions to learn about UTXOs, consolidation, and fees!
                    </p>
                </div>

                <p style="text-align: center; margin: 2.5rem 0 1.5rem 0; font-size: 1.1rem; color: var(--primary-orange); font-weight: 600;">
                    🎮 Want More Practice?
                </p>

                <!-- Interactive Transaction Builder Demo -->
                <div class="demo-embed">
                    <h3>🎮 Interactive Transaction Builder</h3>
                    <p style="margin-bottom: 1.5rem;">
                        Build a real Bitcoin transaction step-by-step. Select UTXOs, add recipients, and watch how fees work!
                    </p>
                    <iframe
                        src="/interactive-demos/transaction-builder/index.html?level=beginner&path=curious"
                        style="width: 100%; height: 700px; border: 2px solid var(--primary-orange); border-radius: 0.75rem;"
                        title="Transaction Builder - Guided Mode">
                    </iframe>
                    <p style="margin-top: 1rem; text-align: center; color: var(--text-dim); font-size: 0.9rem;">
                        💡 Try creating transactions with different amounts and see how change works!
                    </p>
                </div>

                <!-- Interactive Digital Signatures Demo -->
                <div class="demo-embed">
                    <h3>🔐 Interactive: Digital Signatures</h3>
                    <p style="margin-bottom: 1.5rem;">
                        Discover how Bitcoin proves ownership without revealing your private key. Sign messages, verify signatures, and understand the cryptography protecting your Bitcoin!
                    </p>
                    <iframe
                        src="/interactive-demos/digital-signatures-demo/index.html?level=beginner&path=curious"
                        style="width: 100%; height: 850px; border: 2px solid var(--primary-orange); border-radius: 0.75rem;"
                        title="Digital Signatures - Beginner">
                    </iframe>
                    <p style="margin-top: 1rem; text-align: center; color: var(--text-dim); font-size: 0.9rem;">
                        💡 Try signing a message with your private key, then verify it with your public key!
                    </p>
                </div>
            </section>

            <!-- Part 3: Mining -->
            <section class="content-section">
                <h2>⛏️ Part 3: Mining – How the Network Stays Honest</h2>
                <p>
                    Mining keeps Bitcoin fair, synchronized, and secure. Miners collect new transactions, group them into blocks, and compete to find a special number—called a <strong>nonce</strong>—that produces a valid hash starting with enough zeros.
                </p>
                <p>
                    This process is called <strong>Proof-of-Work</strong>. It requires real energy and computation to add each new block, making the network expensive to attack.
                </p>

                <!-- Interactive Computational Puzzles Demo -->
                <div class="demo-embed">
                    <h3>🧩 Interactive: Computational Puzzles</h3>
                    <p style="margin-bottom: 1.5rem;">
                        Understand proof-of-work by solving hash puzzles yourself. This is what miners actually do!
                    </p>
                    <iframe
                        src="/interactive-demos/computational-puzzles-demo/index.html?level=beginner&path=curious"
                        style="width: 100%; height: 750px; border: 2px solid var(--primary-orange); border-radius: 0.75rem;"
                        title="Computational Puzzles - Beginner Mode">
                    </iframe>
                    <p style="margin-top: 1rem; text-align: center; color: var(--text-dim); font-size: 0.9rem;">
                        💡 Try auto-solve to see how many attempts it takes to find a valid hash!
                    </p>
                </div>

                <div class="concept-cards">
                    <div class="concept-card">
                        <div class="concept-header">
                            <span class="concept-icon">🔐</span>
                            <h3>Hash Functions (SHA-256)</h3>
                        </div>
                        <p>
                            A hash function turns any input into a fixed-length string of random-looking letters and numbers.
                        </p>
                        <p>
                            Even one small change completely transforms the output—this is called the <strong>avalanche effect</strong>.
                        </p>

                        <!-- Interactive Hash Demo -->
                        <div style="background: var(--secondary-dark); border: 2px solid var(--primary-orange); border-radius: 0.75rem; padding: 1.5rem; margin: 1.5rem 0;">
                            <h4 style="color: var(--primary-orange); margin-bottom: 1rem; text-align: center;">Try it:</h4>
                            <p style="color: var(--text-dim); font-size: 0.9rem; text-align: center; margin-bottom: 1.5rem;">
                                Type any word and see how the hash changes instantly. Now, change one letter. Notice how unpredictable it is? That's why Bitcoin can't be forged or reversed.
                            </p>

                            <div style="margin-bottom: 1rem;">
                                <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-light);">Your Input:</label>
                                <input type="text"
                                       id="hash-input"
                                       value="Hello World"
                                       style="width: 100%; padding: 0.75rem; background: rgba(247, 147, 26, 0.1); border: 2px solid var(--border-color); border-radius: 0.5rem; color: var(--text-light); font-size: 1rem; font-family: 'Courier New', monospace;"
                                       placeholder="Type anything...">
                            </div>

                            <div style="margin-bottom: 1rem;">
                                <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--accent-green);">SHA-256 Hash:</label>
                                <div id="hash-output"
                                     style="padding: 0.75rem; background: rgba(76, 175, 80, 0.1); border: 2px solid var(--accent-green); border-radius: 0.5rem; font-family: 'Courier New', monospace; font-size: 0.85rem; word-break: break-all; color: var(--accent-green); min-height: 50px;">
                                    Calculating...
                                </div>
                            </div>

                            <div style="background: rgba(247, 147, 26, 0.05); padding: 1rem; border-radius: 0.5rem; border-left: 3px solid var(--primary-orange);">
                                <p style="font-size: 0.85rem; color: var(--text-dim); margin: 0;">
                                    💡 <strong>Try this:</strong> Change just one letter and see how dramatically the hash changes.
                                    This "avalanche effect" makes Bitcoin mining unpredictable!
                                </p>
                            </div>
                        </div>

                        <div style="background: rgba(247, 147, 26, 0.1); padding: 1rem; border-radius: 0.5rem; margin-top: 1rem; font-family: 'Courier New', monospace; font-size: 0.85rem;">
                            <div style="margin-bottom: 0.5rem;">Input: "Hello World"</div>
                            <div style="color: var(--accent-green);">Hash: a591a6d40bf420404a011733cfb7b190d62c65bf0bcda32b57b277d9ad9f146e</div>
                            <div style="margin: 1rem 0 0.5rem; color: var(--text-dim);">Input: "Hello world" (lowercase 'w')</div>
                            <div style="color: var(--accent-green);">Hash: 64ec88ca00b268e5ba1a35678a1b5316d212f4f366b2477232534a8aeca37f3c</div>
                        </div>

                        <div style="background: rgba(76, 175, 80, 0.1); padding: 1.5rem; border-radius: 0.5rem; margin-top: 1.5rem; border-left: 3px solid var(--accent-green);">
                            <p style="margin: 0; color: var(--text-light); line-height: 1.6;">
                                <strong style="color: var(--accent-green);">💡 Now imagine a global competition:</strong><br><br>
                                Everyone is racing to find a hash that begins with a 0. You can change a letter, a space, or a number and try again.
                                The first person to create a valid hash that starts with enough zeros wins.
                            </p>
                            <p style="margin: 1rem 0 0 0; color: var(--text-dim); font-size: 0.95rem;">
                                That's exactly what Bitcoin miners do. Their computers make billions of guesses per second, adjusting a number called a <strong>nonce</strong> until they find a hash that meets Bitcoin's difficulty rule. The more zeros required at the start, the harder it is to find a valid result—and the greater the proof of work behind it.
                            </p>
                        </div>
                    </div>

                    <div class="concept-card">
                        <div class="concept-header">
                            <span class="concept-icon">🏰</span>
                            <h3>Why It's Nearly Unbreakable</h3>
                        </div>
                        <p>
                            To rewrite Bitcoin's history, an attacker would have to:
                        </p>
                        <ol style="margin-left: 2rem; margin-top: 1rem; color: var(--text-light);">
                            <li>Re-mine the altered block</li>
                            <li>Re-mine every block after it</li>
                            <li>Outpace the entire network</li>
                        </ol>
                        <p style="margin-top: 1rem;">
                            With today's hashrate (~400 EH/s), this would require more energy than all supercomputers combined—making it practically impossible.
                        </p>
                    </div>
                </div>

                <p style="text-align: center; margin: 2rem 0 1.5rem 0; font-size: 1.1rem; color: var(--primary-orange); font-weight: 600;">
                    🎮 Mining Simulator:
                </p>
                <p style="text-align: center; margin-bottom: 1.5rem; color: var(--text-dim);">
                    Adjust difficulty levels and see how long it takes to find a valid block.
                </p>

                <!-- Interactive Mining Simulator -->
                <div class="demo-embed">
                    <h3>⛏️ Interactive Mining Simulator</h3>
                    <p style="margin-bottom: 1.5rem;">
                        Experience Bitcoin mining firsthand! Adjust difficulty levels and see how mining actually works.
                    </p>
                    <iframe
                        src="/interactive-demos/mining-simulator/index.html?level=beginner&path=curious"
                        style="width: 100%; height: 800px; border: 2px solid var(--primary-orange); border-radius: 0.75rem;"
                        title="Mining Simulator - Guided Mode">
                    </iframe>
                    <p style="margin-top: 1rem; text-align: center; color: var(--text-dim); font-size: 0.9rem;">
                        💡 Start with Easy Mode to learn the concepts, then try Realistic Mode to see actual Bitcoin difficulty!
                    </p>
                </div>
            </section>

            <!-- Key Takeaways -->
            <section class="content-section">
                <div class="takeaways">
                    <h3>🎯 Key Takeaways</h3>
                    <ul>
                        <li>The blockchain is Bitcoin's tamper-proof memory</li>
                        <li>Transactions use UTXOs, not balances, for clear ownership and validation</li>
                        <li>Mining turns electricity into security, making attacks prohibitively expensive</li>
                        <li>Hash functions ensure even tiny changes are instantly detectable</li>
                        <li>New blocks appear every ~10 minutes, keeping global consensus in sync</li>
                    </ul>
                </div>
            </section>

            <!-- Quiz -->
            <section class="content-section">
                <!-- Interactive Retention Activities -->
                <div class="retention-section">
                    <h3 style="text-align: center; margin-bottom: 2rem; color: var(--text-light);">✨ Master Bitcoin's Mechanics</h3>

                    <!-- Activity 1: Drag-to-Order (Transaction Flow) -->
                    <section id="order-tx" class="card" style="padding: 2rem; margin-bottom: 2rem; background: var(--secondary-dark); border: 2px solid var(--primary-orange); border-radius: 1rem;">
                        <h4 style="margin-bottom: 1rem; color: var(--text-light);">🔄 Build a Bitcoin Transaction</h4>
                        <p style="margin-bottom: 1.5rem; color: var(--text-dim);">Arrange the pieces in the correct order:</p>
                        <ol class="droplist" aria-label="Transaction flow" style="list-style: none; padding: 0; min-height: 120px; background: rgba(247, 147, 26, 0.05); border: 2px dashed rgba(247, 147, 26, 0.3); border-radius: 0.5rem; padding: 1rem; margin-bottom: 1rem;"></ol>
                        <div class="drag-bin" aria-label="Transaction pieces" style="display: flex; flex-wrap: wrap; gap: 0.75rem; margin-bottom: 1rem;">
                            <button class="chip draggable" data-id="1" draggable="true" style="cursor: grab; padding: 0.75rem 1.25rem; font-size: 0.95rem; background: rgba(247, 147, 26, 0.15); border: 2px solid var(--border-color); color: var(--text-light); border-radius: 2rem; transition: all 0.2s;">UTXO (Unspent coins)</button>
                            <button class="chip draggable" data-id="2" draggable="true" style="cursor: grab; padding: 0.75rem 1.25rem; font-size: 0.95rem; background: rgba(247, 147, 26, 0.15); border: 2px solid var(--border-color); color: var(--text-light); border-radius: 2rem; transition: all 0.2s;">Inputs (What you spend)</button>
                            <button class="chip draggable" data-id="3" draggable="true" style="cursor: grab; padding: 0.75rem 1.25rem; font-size: 0.95rem; background: rgba(247, 147, 26, 0.15); border: 2px solid var(--border-color); color: var(--text-light); border-radius: 2rem; transition: all 0.2s;">Outputs (Where it goes)</button>
                            <button class="chip draggable" data-id="4" draggable="true" style="cursor: grab; padding: 0.75rem 1.25rem; font-size: 0.95rem; background: rgba(247, 147, 26, 0.15); border: 2px solid var(--border-color); color: var(--text-light); border-radius: 2rem; transition: all 0.2s;">Fee (Miner incentive)</button>
                        </div>
                        <button id="check-tx" class="btn" style="background: var(--primary-orange); color: white; padding: 0.75rem 1.5rem; border: none; border-radius: 0.5rem; font-weight: 600; cursor: pointer; width: 100%;">Check Order</button>
                        <p id="tx-feedback" style="margin-top: 1rem; text-align: center; font-weight: 500; color: var(--text-dim);"></p>
                    </section>

                    <!-- Activity 2: Tap-to-Reveal (Technical Terms) -->
                    <section style="margin-bottom: 2rem;">
                        <h4 style="margin-bottom: 1rem; color: var(--text-light);">💡 Bitcoin Jargon Buster</h4>
                        <p style="margin-bottom: 1rem; color: var(--text-dim);">Think first, then reveal:</p>
                        <div class="grid" style="display: grid; gap: 1rem; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));">
                            <article class="card tapcard" data-answer="A one-way mathematical function that turns any data into a unique fixed-length fingerprint" style="padding: 1.5rem; cursor: pointer; background: var(--secondary-dark); border: 2px solid var(--border-color); border-radius: 0.75rem; transition: all 0.3s; min-height: 100px; display: flex; align-items: center; justify-content: center; text-align: center; font-weight: 500; color: var(--text-light);">What is a <strong>hash</strong>?</article>
                            <article class="card tapcard" data-answer="A random number miners adjust to find a valid hash (like guessing lottery numbers trillions of times)" style="padding: 1.5rem; cursor: pointer; background: var(--secondary-dark); border: 2px solid var(--border-color); border-radius: 0.75rem; transition: all 0.3s; min-height: 100px; display: flex; align-items: center; justify-content: center; text-align: center; font-weight: 500; color: var(--text-light);">What is a <strong>nonce</strong>?</article>
                            <article class="card tapcard" data-answer="Links blocks together. Each block contains the previous block's hash, creating an unbreakable chain" style="padding: 1.5rem; cursor: pointer; background: var(--secondary-dark); border: 2px solid var(--border-color); border-radius: 0.75rem; transition: all 0.3s; min-height: 100px; display: flex; align-items: center; justify-content: center; text-align: center; font-weight: 500; color: var(--text-light);">What makes the <strong>blockchain</strong> immutable?</article>
                            <article class="card tapcard" data-answer="Unspent Transaction Output — leftover Bitcoin from previous transactions (like having bills in your wallet)" style="padding: 1.5rem; cursor: pointer; background: var(--secondary-dark); border: 2px solid var(--border-color); border-radius: 0.75rem; transition: all 0.3s; min-height: 100px; display: flex; align-items: center; justify-content: center; text-align: center; font-weight: 500; color: var(--text-light);">What is a <strong>UTXO</strong>?</article>
                        </div>
                    </section>

                    <!-- Activity 3: Mini Mining Simulator -->
                    <section id="mini-miner" class="card" style="padding: 2rem; background: var(--secondary-dark); border: 2px solid var(--primary-orange); border-radius: 1rem;">
                        <h4 style="margin-bottom: 1rem; color: var(--text-light);">⛏️ Try Mining (Simplified)</h4>
                        <p style="margin-bottom: 1rem; color: var(--text-light);">Find a number that creates a hash starting with "00". Miners do this billions of times per second!</p>
                        <div style="margin-bottom: 1rem;">
                            <label style="display: block; margin-bottom: 0.5rem; color: var(--text-dim); font-size: 0.9rem;">Your guess (0-999):</label>
                            <input id="nonce-guess" type="number" min="0" max="999" value="0" style="width: 100%; padding: 0.75rem; background: rgba(247, 147, 26, 0.1); border: 2px solid var(--border-color); border-radius: 0.5rem; color: var(--text-light); font-size: 1rem;">
                        </div>
                        <button id="try-mine" style="background: var(--primary-orange); color: white; padding: 0.75rem 1.5rem; border: none; border-radius: 0.5rem; font-weight: 600; cursor: pointer; width: 100%; margin-bottom: 1rem;">Check Hash</button>
                        <div id="hash-result" style="padding: 1rem; background: rgba(247, 147, 26, 0.05); border-radius: 0.5rem; font-family: monospace; word-break: break-all; color: var(--text-dim); min-height: 60px;"></div>
                        <p id="mine-feedback" style="margin-top: 1rem; font-weight: 500; text-align: center; color: var(--text-dim);"></p>
                        <p style="margin-top: 1rem; font-size: 0.85rem; color: var(--text-dim); font-style: italic;">Hint: Try numbers between 100-300</p>
                    </section>
                </div>
            </section>

            <!-- Navigation -->
            <nav class="module-navigation">
                <a href="/paths/curious/stage-2/" class="nav-btn nav-btn-secondary">← Back to Stage 2</a>
                <a href="module-2.html" class="nav-btn disabled" id="next-module">Next: Bitcoin's Rules →</a>
            </nav>
        </div>
    </main>

    <script>
        // SHA-256 Hash Function (using SubtleCrypto API)
        async function sha256(message) {
            const msgBuffer = new TextEncoder().encode(message);
            const hashBuffer = await crypto.subtle.digest('SHA-256', msgBuffer);
            const hashArray = Array.from(new Uint8Array(hashBuffer));
            const hashHex = hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
            return hashHex;
        }

        // Interactive Hash Demo
        const hashInput = document.getElementById('hash-input');
        const hashOutput = document.getElementById('hash-output');

        async function updateHash() {
            const input = hashInput.value;
            if (input === '') {
                hashOutput.textContent = 'Type something to see the hash...';
                hashOutput.style.color = 'var(--text-dim)';
                return;
            }

            hashOutput.textContent = 'Calculating...';
            hashOutput.style.color = 'var(--text-dim)';

            try {
                const hash = await sha256(input);
                hashOutput.textContent = hash;
                hashOutput.style.color = 'var(--accent-green)';
            } catch (error) {
                hashOutput.textContent = 'Error calculating hash';
                hashOutput.style.color = '#f44336';
            }
        }

        // Update hash on input
        if (hashInput) {
            hashInput.addEventListener('input', updateHash);
            // Calculate initial hash
            updateHash();
        }

        // ===== INTERACTIVE RETENTION ACTIVITIES =====

        // Activity 1: Drag-to-Order (Transaction Flow)
        (() => {
            const KEY = 'retention.orderTx.v1';
            const target = document.querySelector('#order-tx .droplist');
            const bin = document.querySelector('#order-tx .drag-bin');
            const chips = [...bin.querySelectorAll('.draggable')];

            chips.sort(() => Math.random() - 0.5).forEach(c => bin.appendChild(c));

            function enableDrag(container) {
                container.addEventListener('dragstart', e => {
                    if (!e.target.matches('.draggable')) return;
                    e.dataTransfer.setData('id', e.target.dataset.id);
                    e.target.style.opacity = '0.5';
                });
                container.addEventListener('dragend', e => {
                    if (e.target.matches('.draggable')) e.target.style.opacity = '1';
                });
                container.addEventListener('dragover', e => e.preventDefault());
                container.addEventListener('drop', e => {
                    e.preventDefault();
                    const id = e.dataTransfer.getData('id');
                    const node = document.querySelector(`.draggable[data-id="${id}"]`);
                    if (e.currentTarget.classList.contains('droplist')) {
                        e.currentTarget.appendChild(node);
                    } else {
                        bin.appendChild(node);
                    }
                });
            }
            enableDrag(target);
            enableDrag(bin);

            document.querySelector('#check-tx').addEventListener('click', () => {
                const ids = [...target.querySelectorAll('.draggable')].map(n => n.dataset.id).join(',');
                const ok = ids === '1,2,3,4';
                const fb = document.getElementById('tx-feedback');
                fb.style.color = ok ? 'var(--accent-green)' : '#ff6b6b';
                fb.textContent = ok
                    ? '✓ Perfect! UTXO → Inputs → Outputs → Fee. The fee is what\'s left over (Inputs - Outputs).'
                    : '✗ Not quite. Think: You start with unspent coins (UTXO), use them as inputs, send outputs, and the difference becomes the miner fee.';
                if (ok) {
                    localStorage.setItem(KEY, 'passed');
                    checkAllActivitiesComplete();
                }
            });

            if (localStorage.getItem(KEY) === 'passed') {
                document.getElementById('tx-feedback').textContent = '✓ Completed';
                document.getElementById('tx-feedback').style.color = 'var(--accent-green)';
            }
        })();

        // Activity 2: Tap-to-Reveal Cards
        (() => {
            document.querySelectorAll('.tapcard').forEach((el, i) => {
                const KEY = 'retention.s2m1.tapcard.' + i;
                if (localStorage.getItem(KEY)) {
                    el.innerHTML = localStorage.getItem(KEY);
                    el.style.borderColor = 'var(--primary-orange)';
                    el.style.background = 'rgba(247, 147, 26, 0.1)';
                }
                el.addEventListener('click', () => {
                    const ans = '💡 ' + el.dataset.answer;
                    el.innerHTML = ans;
                    el.style.borderColor = 'var(--primary-orange)';
                    el.style.background = 'rgba(247, 147, 26, 0.1)';
                    localStorage.setItem(KEY, ans);
                    checkAllActivitiesComplete();
                });
            });
        })();

        // Activity 3: Mini Mining Simulator
        (() => {
            const KEY = 'retention.miniMiner.v1';
            const validNonces = [147, 218, 263]; // Pre-computed valid nonces that produce hashes starting with "00"

            document.getElementById('try-mine').addEventListener('click', async () => {
                const nonce = parseInt(document.getElementById('nonce-guess').value);
                const data = "Bitcoin Block " + nonce;
                const hash = await sha256(data);

                document.getElementById('hash-result').innerHTML = `<strong>Hash:</strong> ${hash}`;

                const fb = document.getElementById('mine-feedback');
                if (hash.startsWith('00')) {
                    fb.innerHTML = `✓ <strong>Success!</strong> You found a valid hash! In real Bitcoin, miners do this billions of times per second to find hashes with many more leading zeros.`;
                    fb.style.color = 'var(--accent-green)';
                    localStorage.setItem(KEY, nonce.toString());
                    checkAllActivitiesComplete();
                } else {
                    fb.innerHTML = `✗ Not yet. This hash doesn't start with "00". Keep trying! (Hint: Try ${validNonces[0]}, ${validNonces[1]}, or ${validNonces[2]})`;
                    fb.style.color = '#ff6b6b';
                }
            });

            if (localStorage.getItem(KEY)) {
                document.getElementById('mine-feedback').innerHTML = '✓ Mining challenge completed!';
                document.getElementById('mine-feedback').style.color = 'var(--accent-green)';
            }
        })();

        // Check if all activities completed
        function checkAllActivitiesComplete() {
            const activity1 = localStorage.getItem('retention.orderTx.v1');
            const activity2 = document.querySelectorAll('.tapcard').length === 4 &&
                            localStorage.getItem('retention.s2m1.tapcard.0') &&
                            localStorage.getItem('retention.s2m1.tapcard.1') &&
                            localStorage.getItem('retention.s2m1.tapcard.2') &&
                            localStorage.getItem('retention.s2m1.tapcard.3');
            const activity3 = localStorage.getItem('retention.miniMiner.v1');

            if (activity1 && activity2 && activity3) {
                saveProgress();
                document.getElementById('next-module').classList.remove('disabled');

                if (!localStorage.getItem('retention.s2m1.completed')) {
                    const msg = document.createElement('div');
                    msg.style.cssText = 'background: rgba(76, 175, 80, 0.15); border: 2px solid var(--accent-green); border-radius: 1rem; padding: 1.5rem; margin: 2rem 0; text-align: center;';
                    msg.innerHTML = '<h4 style="color: var(--accent-green); margin-bottom: 0.5rem;">🎉 All Activities Complete!</h4><p style="color: var(--text-light);">You now understand how Bitcoin works under the hood. Ready for Module 2?</p>';
                    document.querySelector('.retention-section').appendChild(msg);
                    localStorage.setItem('retention.s2m1.completed', 'true');
                }
            }
        }

        checkAllActivitiesComplete();

        function saveProgress() {
            const progress = JSON.parse(localStorage.getItem('learningProgress') || '{}');

            if (!progress.completedModules) {
                progress.completedModules = [];
            }

            if (!progress.completedModules.includes('curious-2-1')) {
                progress.completedModules.push('curious-2-1');
            }

            progress.lastActivity = new Date().toISOString();
            progress.path = 'curious';
            progress.currentStage = 2;
            progress.currentModule = 2;

            localStorage.setItem('learningProgress', JSON.stringify(progress));
        }

        function checkProgress() {
            const progress = JSON.parse(localStorage.getItem('learningProgress') || '{}');
            const completedModules = progress.completedModules || [];

            if (completedModules.includes('curious-2-1')) {
                document.getElementById('next-module').classList.remove('disabled');

                const notice = document.createElement('div');
                notice.style.background = 'rgba(76, 175, 80, 0.2)';
                notice.style.padding = '1rem';
                notice.style.borderRadius = '0.5rem';
                notice.style.color = 'var(--accent-green)';
                notice.style.textAlign = 'center';
                notice.style.marginBottom = '2rem';
                notice.textContent = '✓ You\'ve already completed this module. Feel free to review or move on!';

                document.querySelector('.container').insertBefore(notice, document.querySelector('.content-section'));
            }
        }

        checkProgress();
    </script>
    <script src="/js/module-gate.js" defer></script>
</body>
</html>
