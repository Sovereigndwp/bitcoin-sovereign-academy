<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Building Digital Trust | The Curious Path | Bitcoin Sovereign Academy</title>

    <style>
        :root {
            --primary-orange: #f7931a;
            --primary-dark: #1a1a1a;
            --secondary-dark: #2d2d2d;
            --accent-green: #4caf50;
            --accent-blue: #2196f3;
            --accent-purple: #9c27b0;
            --text-light: #e0e0e0;
            --text-dim: #999;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--primary-dark);
            color: var(--text-light);
            line-height: 1.8;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 2rem;
        }

        header {
            background: linear-gradient(135deg, var(--secondary-dark), var(--primary-dark));
            border-bottom: 3px solid var(--primary-orange);
            padding: 2rem 0;
            margin-bottom: 3rem;
        }

        header h1 {
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--primary-orange), #ffb347);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 0.5rem;
        }

        .subtitle {
            color: var(--text-dim);
            font-size: 1.1rem;
        }

        .breadcrumb {
            margin-bottom: 1.5rem;
            color: var(--text-dim);
            font-size: 0.9rem;
        }

        .breadcrumb a {
            color: var(--primary-orange);
            text-decoration: none;
        }

        .story-section {
            background: var(--secondary-dark);
            border-left: 4px solid var(--primary-orange);
            padding: 2rem;
            margin: 2rem 0;
            border-radius: 0 0.5rem 0.5rem 0;
        }

        .story-section h2 {
            color: var(--primary-orange);
            margin-bottom: 1rem;
            font-size: 1.8rem;
        }

        .story-section h3 {
            color: var(--accent-blue);
            margin: 1.5rem 0 1rem 0;
            font-size: 1.3rem;
        }

        .story-section p {
            margin-bottom: 1rem;
            font-size: 1.05rem;
        }

        .analogy-box {
            background: rgba(33, 150, 243, 0.1);
            border: 2px solid var(--accent-blue);
            border-radius: 0.5rem;
            padding: 1.5rem;
            margin: 1.5rem 0;
        }

        .analogy-box h4 {
            color: var(--accent-blue);
            margin-bottom: 0.75rem;
            font-size: 1.1rem;
        }

        .interactive-demo {
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid var(--primary-orange);
            border-radius: 0.5rem;
            padding: 1.5rem;
            margin: 2rem 0;
        }

        .interactive-demo h3 {
            color: var(--primary-orange);
            margin-bottom: 1rem;
        }

        .demo-controls {
            display: flex;
            gap: 1rem;
            margin: 1rem 0;
            flex-wrap: wrap;
        }

        button {
            background: linear-gradient(135deg, var(--primary-orange), #ffb347);
            border: none;
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(247, 147, 26, 0.4);
        }

        button.secondary {
            background: transparent;
            border: 2px solid var(--primary-orange);
            color: var(--primary-orange);
        }

        .demo-output {
            background: rgba(0, 0, 0, 0.5);
            border-radius: 0.5rem;
            padding: 1rem;
            margin-top: 1rem;
            min-height: 100px;
            max-height: 400px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .demo-output:empty::before {
            content: "Output will appear here...";
            color: var(--text-dim);
            font-style: italic;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-in {
            animation: slideIn 0.3s ease;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }

        .pulsing {
            animation: pulse 1.5s ease-in-out infinite;
        }

        .aha-moment {
            background: linear-gradient(135deg, rgba(76, 175, 80, 0.2), rgba(33, 150, 243, 0.2));
            border: 2px solid var(--accent-green);
            border-radius: 0.5rem;
            padding: 1.5rem;
            margin: 2rem 0;
        }

        .aha-moment h4 {
            color: var(--accent-green);
            margin-bottom: 0.75rem;
            font-size: 1.2rem;
        }

        .comparison-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin: 1.5rem 0;
        }

        .comparison-card {
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid var(--accent-blue);
            border-radius: 0.5rem;
            padding: 1rem;
        }

        .comparison-card h5 {
            color: var(--accent-blue);
            margin-bottom: 0.5rem;
        }

        .highlight {
            color: var(--primary-orange);
            font-weight: 600;
        }

        .ledger-entry {
            background: rgba(247, 147, 26, 0.1);
            border-left: 3px solid var(--primary-orange);
            padding: 0.75rem;
            margin: 0.5rem 0;
            font-family: monospace;
            font-size: 0.9rem;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 3rem;
            padding-top: 2rem;
            border-top: 2px solid var(--secondary-dark);
        }

        .nav-button {
            text-decoration: none;
            padding: 1rem 2rem;
            border-radius: 0.5rem;
            font-weight: 600;
        }

        .stamp-demo {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }

        .stamp {
            background: rgba(247, 147, 26, 0.2);
            border: 2px solid var(--primary-orange);
            padding: 1rem;
            border-radius: 0.5rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .stamp:hover {
            background: rgba(247, 147, 26, 0.3);
            transform: scale(1.05);
        }

        .stamp.used {
            opacity: 0.4;
            cursor: not-allowed;
        }

        @media (max-width: 768px) {
            .comparison-grid {
                grid-template-columns: 1fr;
            }

            header h1 {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="breadcrumb">
                <a href="../../../index.html">Home</a> ‚Üí
                <a href="../../curious/index.html">The Curious Path</a> ‚Üí
                <a href="../stage-1/index.html">Stage 1</a> ‚Üí
                Module 4
            </div>
            <h1>üß≠ Building Digital Trust</h1>
            <p class="subtitle">Understanding the Machine Behind the Magic (Without the Technical Jargon)</p>
        </div>
    </header>

    <main class="container">
        <!-- Introduction -->
        <div class="story-section">
            <h2>Building a New Kind of Money System</h2>
            <p>
                Imagine building a bank that never closes, has no bankers, and belongs to everyone at once.
                Sounds impossible? That's exactly what Bitcoin is ‚Äî a self-running system built on trust through math.
            </p>
            <p>
                In this module, we're going to understand <em>how</em> this system works using only things you already understand:
                stamps, ledgers, pages, competitions, and town agreements. No technical jargon. Just simple, powerful ideas.
            </p>
            <p>
                <strong>You're about to rebuild Bitcoin with your imagination ‚Äî one rule at a time.</strong>
            </p>
        </div>

        <!-- Chapter 1: Secret Stamps -->
        <div class="story-section">
            <h2>Chapter 1: The Secret Stamp System</h2>

            <h3>The Problem: How Do You Prove It's Really You?</h3>
            <p>
                In the physical world, you sign documents with your signature. But signatures can be forged.
                What if instead, you had a <span class="highlight">secret stamp</span> that only you possess?
            </p>

            <div class="analogy-box">
                <h4>üîè The Secret Stamp Analogy</h4>
                <p>
                    Imagine you have a one-of-a-kind stamp only you own. You keep this stamp locked in a safe that only you can access.
                    This is your <strong>secret stamp</strong>.
                </p>
                <p>
                    You also have a <strong>public mailbox</strong> where anyone can send you letters. The address on this mailbox
                    is derived from your stamp's pattern‚Äîbut knowing the mailbox address doesn't help anyone recreate your stamp!
                </p>
                <p>
                    When you want to send money, you stamp the transaction with your secret stamp. Everyone can see the stamp mark
                    and verify it came from your mailbox, but nobody can forge your stamp because they don't have access to it.
                </p>
            </div>

            <div class="interactive-demo">
                <h3>üéÆ Try It: Secret Stamp Simulator</h3>
                <p>You have a secret stamp. Use it to authorize sending money to a friend.</p>

                <div class="demo-controls">
                    <input type="text" id="recipient" placeholder="Send to..." value="Alice" style="padding: 0.75rem; flex: 1; background: rgba(0,0,0,0.5); border: 1px solid #444; color: white; border-radius: 0.5rem;">
                    <input type="number" id="amount" placeholder="Amount" value="10" min="1" style="padding: 0.75rem; width: 100px; background: rgba(0,0,0,0.5); border: 1px solid #444; color: white; border-radius: 0.5rem;">
                    <button onclick="stampTransaction()">üîè Use Secret Stamp</button>
                </div>

                <div id="stamp-output" class="demo-output"></div>
            </div>

            <div class="aha-moment">
                <h4>üí° Aha! Moment</h4>
                <p>
                    When you hear <strong>"private key"</strong> or <strong>"public address"</strong>,
                    just think: <em>your secret stamp and your public mailbox</em>.
                </p>
            </div>
        </div>

        <!-- Chapter 2: The Shared Ledger -->
        <div class="story-section">
            <h2>Chapter 2: The Town's Shared Ledger Book</h2>

            <h3>The Problem: Who Keeps Track of Everyone's Money?</h3>
            <p>
                What if we don't want to trust one bank? What if the <em>entire town</em> keeps the same records?
            </p>

            <div class="analogy-box">
                <h4>üìñ The Shared Ledger Analogy</h4>
                <p>
                    Imagine a town where everyone has the same notebook. Whenever someone spends money, everyone updates their copy together.
                </p>
                <p>
                    When Alice sends Bob 10 coins:
                </p>
                <ol style="margin-left: 2rem; margin-top: 1rem;">
                    <li>Alice announces: "I'm sending Bob 10 coins" (and stamps it with her secret stamp)</li>
                    <li>Everyone checks: "Does Alice have 10 coins? Is the stamp real?"</li>
                    <li>If yes, everyone writes it in their ledger: "Alice ‚Üí Bob: 10 coins"</li>
                </ol>
                <p style="margin-top: 1rem;">
                    Now, if Alice tries to spend the same 10 coins again, everyone will see: "Wait, you already sent those coins to Bob!"
                    The shared ledger prevents cheating because <strong>everyone is watching</strong>.
                </p>
            </div>

            <div class="interactive-demo">
                <h3>üéÆ Try It: Shared Ledger Simulator</h3>
                <p>See how the town catches someone trying to spend the same money twice.</p>

                <div class="demo-controls">
                    <button onclick="addValidTransaction()">‚úÖ Send 10 Coins (Valid)</button>
                    <button onclick="tryDoubleSpend()">‚ùå Try to Spend Same Coins Again</button>
                    <button onclick="resetLedger()">üîÑ Reset</button>
                </div>

                <div id="ledger-output" class="demo-output">
                    <div style="color: var(--text-dim);">Ledger will appear here...</div>
                </div>
            </div>

            <div class="aha-moment">
                <h4>üí° Aha! Moment</h4>
                <p>
                    When you hear <strong>"blockchain"</strong>, remember: it's just a fancy name for this shared ledger book!
                    Everyone has a copy, every transaction is recorded, and no one can cheat because everyone is watching.
                </p>
            </div>
        </div>

        <!-- Chapter 3: Linking Pages -->
        <div class="story-section">
            <h2>Chapter 3: The Unbreakable Page Chain</h2>

            <h3>The Problem: How Do We Prevent Rewriting History?</h3>
            <p>
                If someone finds an old ledger page, what stops them from erasing transactions and rewriting history?
                We need a way to <strong>lock pages together</strong> so changing one page breaks the entire book.
            </p>

            <div class="analogy-box">
                <h4>üîó The Page Chain Analogy</h4>
                <p>
                    Imagine each page leaves a <strong>unique mark</strong> based on everything written on it ‚Äî like a digital thumbprint.
                    Page 2 includes Page 1's mark at the top. Page 3 includes Page 2's mark. And so on.
                </p>
                <p>
                    Now, if someone tries to change Page 1, its mark changes. But wait‚ÄîPage 2 has the OLD mark written on it!
                    The chain is broken. It's like if someone changed an old receipt ‚Äî everyone would instantly see the mismatch.
                </p>
                <p>
                    To successfully cheat, you'd have to rewrite Page 1, then recalculate Page 2's mark, then Page 3's,
                    then Page 4's... all the way to the current page. And you'd have to do this faster than the entire town
                    is adding new pages. <strong>Impossible!</strong>
                </p>
            </div>

            <div class="interactive-demo">
                <h3>üéÆ Try It: Page Chain Simulator</h3>
                <p>Try to tamper with an old page and watch the chain break!</p>

                <div class="demo-controls">
                    <button onclick="addPage()">‚ûï Add New Page</button>
                    <button onclick="tamperPage()">üî® Try to Change Page 1</button>
                    <button onclick="resetChain()">üîÑ Reset</button>
                </div>

                <div id="chain-output" class="demo-output"></div>
            </div>

            <div class="aha-moment">
                <h4>üí° Aha! Moment</h4>
                <p>
                    When you hear <strong>"hash"</strong> or <strong>"Merkle tree"</strong>, remember:
                    it's just the unique marking system! These marks link pages together, making the ledger unbreakable.
                </p>
            </div>
        </div>

        <!-- Chapter 4: The Competition -->
        <div class="story-section">
            <h2>Chapter 4: The Town Competition</h2>

            <h3>The Problem: Who Gets to Add the Next Page?</h3>
            <p>
                If everyone can add pages to the ledger, chaos ensues. We need a <strong>fair competition</strong>
                to decide who writes the next page‚Äîone that costs effort but can't be cheated.
            </p>

            <div class="analogy-box">
                <h4>üèÜ The Competition Analogy</h4>
                <p>
                    Every 10 minutes, the town holds a <strong>puzzle-solving competition</strong>. Here's how it works:
                </p>
                <ul style="margin-left: 2rem; margin-top: 1rem;">
                    <li><strong>The Puzzle:</strong> "Find a number that makes this page's unique mark start with five zeros"</li>
                    <li><strong>The Work:</strong> Competitors try random numbers: 1, 2, 3, 4... until someone finds it</li>
                    <li><strong>The Winner:</strong> First person to solve it gets to add the page AND earns a reward. The winner shows the answer ‚Äî everyone can check instantly if it works</li>
                </ul>
                <p style="margin-top: 1rem;">
                    This competition requires real work (trying millions of numbers), but cheating is impossible.
                    You can't fake the solution‚Äîit either creates the right pattern or it doesn't.
                </p>
            </div>

            <div class="interactive-demo">
                <h3>üéÆ Try It: Competition Simulator</h3>
                <p>Watch competitors race to solve the puzzle!</p>

                <div class="demo-controls">
                    <button onclick="startCompetition()">üèÅ Start Competition</button>
                    <button onclick="stopCompetition()">‚èπÔ∏è Stop</button>
                </div>

                <div id="competition-output" class="demo-output"></div>
            </div>

            <div class="aha-moment">
                <h4>üí° Aha! Moment</h4>
                <p>
                    When you hear <strong>"mining"</strong> or <strong>"proof of work"</strong>, remember:
                    it's just the puzzle-solving competition! Miners are the townspeople competing to add the next page.
                    The work proves they put in effort, making attacks expensive.
                </p>
            </div>
        </div>

        <!-- Chapter 5: No Central Authority -->
        <div class="story-section">
            <h2>Chapter 5: The Town Runs Itself</h2>

            <h3>The Beauty: No Mayor Needed</h3>
            <p>
                Here's where it all comes together. This town doesn't need a mayor, a bank, or any central authority.
                Why? Because the <strong>system itself</strong> creates the rules.
            </p>

            <div class="analogy-box">
                <h4>üèõÔ∏è The Self-Governing System</h4>
                <p><strong>Let's review what we've built:</strong></p>
                <div style="margin-top: 1rem;">
                    <div class="ledger-entry">
                        <strong>1. Secret Stamps</strong> prevent impersonation<br>
                        <em>You can't spend someone else's money without their stamp</em>
                    </div>
                    <div class="ledger-entry">
                        <strong>2. Shared Ledger</strong> prevents double-spending<br>
                        <em>Everyone sees if you try to spend the same coins twice</em>
                    </div>
                    <div class="ledger-entry">
                        <strong>3. Page Chains</strong> prevent history rewrites<br>
                        <em>Tampering with old pages breaks the fingerprint chain</em>
                    </div>
                    <div class="ledger-entry">
                        <strong>4. Competition</strong> prevents takeover<br>
                        <em>Adding pages requires real work; cheating costs more than it's worth</em>
                    </div>
                </div>
                <p style="margin-top: 1.5rem;">
                    The result? A system where trust comes from <strong>mathematics and incentives</strong>, not from trusting people.
                    No one can freeze your account. No one can quietly change the rules.
                </p>
            </div>

            <div class="comparison-grid">
                <div class="comparison-card">
                    <h5>Traditional Bank</h5>
                    <ul style="margin-left: 1.5rem; margin-top: 0.5rem; color: var(--text-dim);">
                        <li>Bank keeps the ledger</li>
                        <li>Bank verifies transactions</li>
                        <li>Bank can freeze accounts</li>
                        <li>Bank hours: 9am-5pm</li>
                        <li>You trust the bank</li>
                    </ul>
                </div>
                <div class="comparison-card">
                    <h5>Bitcoin (Our Town System)</h5>
                    <ul style="margin-left: 1.5rem; margin-top: 0.5rem; color: var(--accent-green);">
                        <li>Everyone keeps the ledger</li>
                        <li>Everyone verifies transactions</li>
                        <li>Nobody can freeze accounts</li>
                        <li>Open 24/7/365</li>
                        <li>You trust mathematics</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Final Aha Moment -->
        <div class="story-section">
            <h2>üéØ Bringing It All Together</h2>

            <div style="text-align: center; padding: 2rem; background: linear-gradient(135deg, rgba(247, 147, 26, 0.2), rgba(76, 175, 80, 0.2)); border-radius: 0.5rem; margin-bottom: 2rem;">
                <h3 style="font-size: 1.5rem; color: var(--accent-green); margin-bottom: 0.5rem;">‚ú® You Did It!</h3>
                <p style="font-size: 1.1rem; color: var(--text-light);">
                    You've already rebuilt Bitcoin with your imagination.<br>The rest is just names and code.
                </p>
            </div>

            <p style="font-size: 1.1rem; margin-bottom: 1.5rem;">
                Let's connect our simple town system to Bitcoin's technical terms:
            </p>

            <div class="comparison-grid">
                <div class="comparison-card" style="border-color: var(--primary-orange);">
                    <h5>üèòÔ∏è What We Called It</h5>
                    <ul style="margin-left: 1.5rem; margin-top: 0.5rem;">
                        <li>Secret Stamp</li>
                        <li>Public Mailbox</li>
                        <li>Shared Ledger Book</li>
                        <li>Unique Marks</li>
                        <li>Page Chains</li>
                        <li>Puzzle Competition</li>
                        <li>Townspeople</li>
                        <li>Winner's Reward</li>
                    </ul>
                </div>
                <div class="comparison-card" style="border-color: var(--accent-green);">
                    <h5>‚Çø Bitcoin's Technical Name</h5>
                    <ul style="margin-left: 1.5rem; margin-top: 0.5rem; color: var(--accent-green);">
                        <li>Private Key</li>
                        <li>Public Address</li>
                        <li>Blockchain</li>
                        <li>Cryptographic Hash</li>
                        <li>Hash Pointers</li>
                        <li>Proof of Work / Mining</li>
                        <li>Network Nodes</li>
                        <li>Block Reward</li>
                    </ul>
                </div>
            </div>

            <p style="margin-top: 2rem; font-size: 1.1rem;">
                <strong>Congratulations. You just reinvented Bitcoin.</strong> The technical terms are just fancy names
                for simple ideas you now grasp completely.
            </p>

            <p style="margin-top: 1rem;">
                When you see words like "SHA-256," "ECDSA," or "Merkle root," you'll think:
                <em>"Oh, that's just a more specific way to create those unique marks we talked about!"</em>
            </p>
        </div>

        <!-- Completion Section -->
        <div class="story-section" style="text-align: center; background: linear-gradient(135deg, rgba(76, 175, 80, 0.2), rgba(33, 150, 243, 0.2)); border-color: var(--accent-green);">
            <h2 style="color: var(--accent-green);">üéâ Ready to Move Forward?</h2>
            <p style="font-size: 1.1rem; margin: 1.5rem 0;">
                You now understand HOW Bitcoin works using simple analogies. Ready to dive into the technical details?
            </p>
            <button onclick="completeModule()" id="complete-btn" style="font-size: 1.1rem; padding: 1rem 2rem; margin: 1rem 0;">
                ‚úÖ Mark Complete & Continue to Stage 2
            </button>
            <div id="completion-message" style="margin-top: 1rem; color: var(--accent-green); font-weight: 600;"></div>
        </div>

        <!-- Navigation -->
        <div class="navigation">
            <a href="module-3.html" class="nav-button secondary">‚Üê Previous: Enter Bitcoin</a>
            <a href="../stage-2/module-1.html" class="nav-button" id="next-btn" style="background: var(--primary-orange); color: white;">Next: Stage 2 - How Bitcoin Works ‚Üí</a>
        </div>
    </main>

    <script>
        // Secret Stamp Demo
        let stampUsed = false;
        let stampCount = 0;

        function stampTransaction() {
            const recipient = document.getElementById('recipient').value.trim() || 'Alice';
            const amount = parseInt(document.getElementById('amount').value) || 10;
            const output = document.getElementById('stamp-output');

            if (amount <= 0) {
                output.innerHTML = `<div style="color: #ff4444; font-weight: 600;">‚ùå Amount must be greater than 0!</div>`;
                return;
            }

            stampCount++;
            const stamp = 'üîè STAMP-' + Math.random().toString(36).substring(2, 10).toUpperCase();
            const mailbox = 'MB-' + stamp.substring(7, 13);

            output.className = 'demo-output animate-in';
            output.innerHTML = `
                <div style="color: var(--accent-green); font-weight: 600; font-size: 1.1rem; margin-bottom: 1rem;">
                    ‚úÖ Transaction #${stampCount} Stamped Successfully!
                </div>
                <div style="padding: 1.5rem; background: linear-gradient(135deg, rgba(247, 147, 26, 0.15), rgba(76, 175, 80, 0.15)); border-radius: 0.5rem; border: 2px solid var(--primary-orange);">
                    <div style="display: grid; grid-template-columns: auto 1fr; gap: 0.75rem; margin-bottom: 1rem;">
                        <strong>From:</strong> <span>You (Secret Stamp Owner)</span>
                        <strong>To:</strong> <span>${recipient}</span>
                        <strong>Amount:</strong> <span style="color: var(--primary-orange); font-weight: 700;">${amount} coins</span>
                        <strong>Your Mailbox:</strong> <code style="color: var(--accent-blue);">${mailbox}</code>
                    </div>

                    <div style="background: rgba(0,0,0,0.3); padding: 1rem; border-radius: 0.5rem; margin-top: 1rem;">
                        <strong style="color: var(--primary-orange);">üîè Secret Stamp Signature:</strong><br>
                        <code style="color: var(--accent-green); word-break: break-all;">${stamp}</code>
                    </div>

                    <div style="margin-top: 1rem; padding: 1rem; background: rgba(33, 150, 243, 0.1); border-left: 3px solid var(--accent-blue); border-radius: 0.25rem;">
                        <strong style="color: var(--accent-blue);">‚ú® Verification Status:</strong><br>
                        <span style="color: var(--text-light);">Everyone can verify this stamp came from mailbox <code>${mailbox}</code>, but nobody can forge your secret stamp!</span>
                    </div>
                </div>
            `;

            // Scroll to output
            output.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        // Shared Ledger Demo
        let ledger = [];
        let aliceBalance = 50;
        const bobBalance = 20;
        const carolBalance = 15;

        function addValidTransaction() {
            const output = document.getElementById('ledger-output');

            if (aliceBalance < 10) {
                output.className = 'demo-output animate-in';
                output.innerHTML = `
                    <div style="color: #ff4444; font-weight: 600; font-size: 1.1rem; padding: 1rem; background: rgba(255, 68, 68, 0.15); border-radius: 0.5rem; border: 2px solid #ff4444;">
                        ‚ùå TRANSACTION REJECTED!<br>
                        <span style="font-size: 0.9rem; margin-top: 0.5rem; display: block;">Alice only has ${aliceBalance} coins but tried to send 10 coins.</span>
                    </div>
                `;
                return;
            }

            ledger.push({
                from: 'Alice',
                to: 'Bob',
                amount: 10,
                valid: true,
                timestamp: new Date().toLocaleTimeString()
            });
            aliceBalance -= 10;

            updateLedger(`‚úÖ TRANSACTION ACCEPTED! Alice sent 10 coins to Bob.`, 'green');
        }

        function tryDoubleSpend() {
            const output = document.getElementById('ledger-output');

            if (aliceBalance < 10) {
                ledger.push({
                    from: 'Alice',
                    to: 'Carol',
                    amount: 10,
                    valid: false,
                    reason: 'Insufficient funds - tried to double-spend!',
                    timestamp: new Date().toLocaleTimeString()
                });
                updateLedger(`‚ùå DOUBLE-SPEND DETECTED! The town caught Alice trying to cheat!`, 'red');
                return;
            }

            ledger.push({
                from: 'Alice',
                to: 'Carol',
                amount: 10,
                valid: false,
                reason: 'Attempted to spend same coins twice!',
                timestamp: new Date().toLocaleTimeString()
            });
            updateLedger(`‚ùå DOUBLE-SPEND DETECTED! Everyone sees Alice already sent these coins!`, 'red');
        }

        function updateLedger(message, color) {
            const output = document.getElementById('ledger-output');
            const colorVar = color === 'green' ? 'var(--accent-green)' : '#ff4444';

            output.className = 'demo-output animate-in';

            let html = `
                <div style="color: ${colorVar}; font-weight: 600; font-size: 1.1rem; padding: 1rem; background: ${color === 'green' ? 'rgba(76, 175, 80, 0.15)' : 'rgba(255, 68, 68, 0.15)'}; border-radius: 0.5rem; border: 2px solid ${colorVar}; margin-bottom: 1rem;">
                    ${message}
                </div>

                <div style="background: rgba(0,0,0,0.3); padding: 1.5rem; border-radius: 0.5rem; margin-bottom: 1rem;">
                    <strong style="color: var(--accent-blue); font-size: 1.05rem;">üí∞ Current Balances:</strong>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 0.75rem; margin-top: 0.75rem;">
                        <div style="background: rgba(247, 147, 26, 0.1); padding: 0.75rem; border-radius: 0.25rem; text-align: center;">
                            <strong style="color: var(--primary-orange);">Alice</strong><br>
                            <span style="font-size: 1.2rem; color: var(--accent-green);">${aliceBalance}</span> coins
                        </div>
                        <div style="background: rgba(33, 150, 243, 0.1); padding: 0.75rem; border-radius: 0.25rem; text-align: center;">
                            <strong style="color: var(--accent-blue);">Bob</strong><br>
                            <span style="font-size: 1.2rem;">${bobBalance + (ledger.filter(tx => tx.to === 'Bob' && tx.valid).length * 10)}</span> coins
                        </div>
                        <div style="background: rgba(156, 39, 176, 0.1); padding: 0.75rem; border-radius: 0.25rem; text-align: center;">
                            <strong style="color: var(--accent-purple);">Carol</strong><br>
                            <span style="font-size: 1.2rem;">${carolBalance}</span> coins
                        </div>
                    </div>
                </div>

                <div style="background: rgba(0,0,0,0.3); padding: 1.5rem; border-radius: 0.5rem;">
                    <strong style="color: var(--primary-orange); font-size: 1.05rem;">üìñ Town Ledger (${ledger.length} entries):</strong>
                    <div style="margin-top: 1rem;">
            `;

            if (ledger.length === 0) {
                html += `<div style="color: var(--text-dim); font-style: italic; text-align: center; padding: 1rem;">No transactions yet...</div>`;
            } else {
                ledger.forEach((tx, i) => {
                    const status = tx.valid ? '‚úÖ' : '‚ùå';
                    const bgColor = tx.valid ? 'rgba(76, 175, 80, 0.1)' : 'rgba(255, 68, 68, 0.1)';
                    const borderColor = tx.valid ? 'var(--accent-green)' : '#ff4444';
                    const reason = tx.reason ? `<div style="color: #ff4444; margin-top: 0.5rem; font-size: 0.85rem;">‚ö†Ô∏è ${tx.reason}</div>` : '';

                    html += `
                        <div style="margin: 0.75rem 0; padding: 1rem; background: ${bgColor}; border-left: 4px solid ${borderColor}; border-radius: 0.25rem;">
                            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 0.5rem;">
                                <strong style="color: var(--text-light);">${status} Transaction #${i + 1}</strong>
                                <code style="color: var(--text-dim); font-size: 0.75rem;">${tx.timestamp}</code>
                            </div>
                            <div style="color: var(--text-light);">
                                ${tx.from} ‚Üí ${tx.to}: <strong style="color: ${tx.valid ? 'var(--accent-green)' : '#ff4444'};">${tx.amount} coins</strong>
                            </div>
                            ${reason}
                        </div>
                    `;
                });
            }

            html += `</div></div>`;
            output.innerHTML = html;

            // Scroll to output
            output.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        function resetLedger() {
            ledger = [];
            aliceBalance = 50;
            const output = document.getElementById('ledger-output');
            output.className = 'demo-output';
            output.innerHTML = `
                <div style="text-align: center; padding: 2rem; color: var(--text-dim);">
                    <div style="font-size: 2rem; margin-bottom: 1rem;">üìñ</div>
                    <strong style="color: var(--primary-orange);">Ledger Reset</strong><br>
                    <span style="font-size: 0.9rem;">Alice starts with 50 coins. Ready to try again!</span>
                </div>
            `;
        }

        // Initialize ledger output on load
        document.addEventListener('DOMContentLoaded', () => {
            resetLedger();
        });

        // Page Chain Demo
        let pages = [];

        function addPage() {
            const pageNum = pages.length + 1;
            const prevMark = pages.length > 0 ? pages[pages.length - 1].mark : 'GENESIS-0000';
            const mark = 'MARK-' + Math.random().toString(36).substring(2, 10).toUpperCase();

            pages.push({
                num: pageNum,
                prevMark,
                mark,
                tampered: false,
                timestamp: new Date().toLocaleTimeString()
            });

            renderChain();
        }

        function tamperPage() {
            if (pages.length === 0) {
                const output = document.getElementById('chain-output');
                output.className = 'demo-output animate-in';
                output.innerHTML = `
                    <div style="text-align: center; padding: 2rem; color: #ff4444;">
                        <div style="font-size: 2rem; margin-bottom: 1rem;">‚ö†Ô∏è</div>
                        <strong>No pages to tamper with!</strong><br>
                        <span style="font-size: 0.9rem;">Add some pages first, then try to tamper.</span>
                    </div>
                `;
                return;
            }

            pages[0].tampered = true;
            pages[0].mark = 'TAMPERED-' + Math.random().toString(36).substring(2, 8).toUpperCase();
            renderChain();
        }

        function renderChain() {
            const output = document.getElementById('chain-output');
            output.className = 'demo-output animate-in';

            if (pages.length === 0) {
                output.innerHTML = `
                    <div style="text-align: center; padding: 2rem; color: var(--text-dim);">
                        <div style="font-size: 2rem; margin-bottom: 1rem;">üîó</div>
                        <strong style="color: var(--primary-orange);">Chain Empty</strong><br>
                        <span style="font-size: 0.9rem;">Add pages to see how they link together!</span>
                    </div>
                `;
                return;
            }

            let html = `<div style="font-weight: 600; font-size: 1.05rem; margin-bottom: 1.5rem; color: var(--accent-blue);">üìÑ Page Chain (${pages.length} pages)</div>`;

            pages.forEach((page, i) => {
                const isValid = i === 0 || pages[i - 1].mark === page.prevMark;
                const statusColor = isValid ? 'var(--accent-green)' : '#ff4444';
                const statusText = isValid ? '‚úÖ Valid Link' : '‚ùå BROKEN CHAIN!';
                const bgColor = isValid ? 'rgba(76, 175, 80, 0.1)' : 'rgba(255, 68, 68, 0.15)';

                // Show connection arrow from previous page
                if (i > 0) {
                    const connectionValid = pages[i - 1].mark === page.prevMark;
                    html += `
                        <div style="text-align: center; margin: 0.5rem 0; color: ${connectionValid ? 'var(--accent-green)' : '#ff4444'};">
                            ${connectionValid ? '‚¨áÔ∏è Valid Link' : 'üíî Broken Link!'}<br>
                            <span style="font-size: 0.75rem; font-family: monospace;">${page.prevMark}</span>
                        </div>
                    `;
                }

                html += `
                    <div style="margin: 0.5rem 0; padding: 1.5rem; background: ${bgColor}; border: 3px solid ${statusColor}; border-radius: 0.5rem; position: relative;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                            <strong style="font-size: 1.1rem; color: var(--primary-orange);">üìÑ Page ${page.num}</strong>
                            <span style="color: ${statusColor}; font-weight: 600;">${statusText}</span>
                        </div>

                        ${page.tampered ? `
                            <div style="background: rgba(255, 68, 68, 0.2); border: 2px solid #ff4444; border-radius: 0.5rem; padding: 0.75rem; margin-bottom: 1rem;">
                                <strong style="color: #ff4444;">‚ö†Ô∏è TAMPERED!</strong><br>
                                <span style="font-size: 0.85rem;">Someone changed this page's content!</span>
                            </div>
                        ` : ''}

                        <div style="background: rgba(0,0,0,0.3); padding: 1rem; border-radius: 0.5rem; font-family: monospace; font-size: 0.85rem;">
                            <div style="margin-bottom: 0.75rem;">
                                <strong style="color: var(--accent-blue);">Prev. Page Mark:</strong><br>
                                <code style="color: ${i === 0 ? 'var(--accent-blue)' : 'var(--text-dim)'};">${page.prevMark}</code>
                            </div>
                            <div>
                                <strong style="color: ${page.tampered ? '#ff4444' : 'var(--accent-green)'};">This Page's Mark:</strong><br>
                                <code style="color: ${page.tampered ? '#ff4444' : 'var(--accent-green)'};">${page.mark}</code>
                            </div>
                        </div>

                        <div style="margin-top: 0.75rem; text-align: right; color: var(--text-dim); font-size: 0.75rem;">
                            Added: ${page.timestamp}
                        </div>
                    </div>
                `;
            });

            output.innerHTML = html;

            // Scroll to latest page
            output.scrollTop = output.scrollHeight;
        }

        function resetChain() {
            pages = [];
            const output = document.getElementById('chain-output');
            output.className = 'demo-output';
            output.innerHTML = `
                <div style="text-align: center; padding: 2rem; color: var(--text-dim);">
                    <div style="font-size: 2rem; margin-bottom: 1rem;">üîó</div>
                    <strong style="color: var(--primary-orange);">Chain Reset</strong><br>
                    <span style="font-size: 0.9rem;">Ready to build a new chain!</span>
                </div>
            `;
        }

        // Competition Demo
        let competitionRunning = false;
        let attempts = 0;
        let competitionInterval = null;

        async function startCompetition() {
            if (competitionRunning) return;

            competitionRunning = true;
            attempts = 0;
            const output = document.getElementById('competition-output');
            output.className = 'demo-output animate-in';

            const target = Math.floor(Math.random() * 800) + 400; // Random between 400-1200 attempts
            const competitors = ['Alice', 'Bob', 'Carol', 'Dave', 'Eve'];
            const winner = competitors[Math.floor(Math.random() * competitors.length)];

            output.innerHTML = `
                <div style="background: linear-gradient(135deg, rgba(33, 150, 243, 0.15), rgba(247, 147, 26, 0.15)); border: 2px solid var(--accent-blue); border-radius: 0.5rem; padding: 1.5rem; margin-bottom: 1rem;">
                    <div style="font-size: 1.1rem; font-weight: 600; color: var(--accent-blue); margin-bottom: 1rem;">
                        üèÅ Puzzle Competition Started!
                    </div>
                    <div style="color: var(--text-light); font-size: 0.9rem;">
                        <strong>${competitors.length} competitors</strong> are racing to find a number that creates a unique mark starting with <strong>000</strong>
                    </div>
                </div>

                <div style="background: rgba(0,0,0,0.3); border-radius: 0.5rem; padding: 1.5rem; margin-bottom: 1rem;">
                    <div style="margin-bottom: 0.5rem; color: var(--accent-blue); font-weight: 600;">Progress:</div>
                    <div style="background: rgba(0,0,0,0.5); height: 30px; border-radius: 15px; overflow: hidden; border: 2px solid var(--accent-blue);">
                        <div id="progress-bar" style="height: 100%; background: linear-gradient(90deg, var(--accent-blue), var(--primary-orange)); width: 0%; transition: width 0.1s linear; display: flex; align-items: center; justify-content: center; color: white; font-weight: 600; font-size: 0.85rem;"></div>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-top: 0.5rem; color: var(--text-dim); font-size: 0.85rem;">
                        <span id="attempt-count">Attempt: 0</span>
                        <span>Target: ~${target}</span>
                    </div>
                </div>

                <div id="competition-log" style="background: rgba(0,0,0,0.3); border-radius: 0.5rem; padding: 1rem; max-height: 200px; overflow-y: auto; font-size: 0.85rem;">
                    <div class="pulsing" style="color: var(--accent-blue);">‚öôÔ∏è Competitors trying numbers...</div>
                </div>
            `;

            const progressBar = document.getElementById('progress-bar');
            const attemptCount = document.getElementById('attempt-count');
            const log = document.getElementById('competition-log');

            competitionInterval = setInterval(() => {
                if (!competitionRunning) {
                    clearInterval(competitionInterval);
                    return;
                }

                attempts++;
                const progress = (attempts / target) * 100;

                progressBar.style.width = Math.min(progress, 100) + '%';
                progressBar.textContent = attempts < target ? Math.floor(progress) + '%' : '100%';
                attemptCount.textContent = `Attempt: ${attempts}`;

                if (attempts % 50 === 0 && attempts < target) {
                    const randomCompetitor = competitors[Math.floor(Math.random() * competitors.length)];
                    log.innerHTML += `<div style="color: var(--text-dim); margin: 0.25rem 0;">‚ùå ${randomCompetitor} tried ${attempts}... no match</div>`;
                    log.scrollTop = log.scrollHeight;
                }

                if (attempts >= target) {
                    clearInterval(competitionInterval);
                    competitionRunning = false;

                    progressBar.style.width = '100%';
                    progressBar.textContent = '‚úì';
                    progressBar.style.background = 'var(--accent-green)';

                    log.innerHTML += `
                        <div style="margin: 1rem 0; padding: 1.5rem; background: linear-gradient(135deg, rgba(76, 175, 80, 0.2), rgba(247, 147, 26, 0.2)); border: 3px solid var(--accent-green); border-radius: 0.5rem; text-align: center;">
                            <div style="font-size: 2rem; margin-bottom: 0.5rem;">üèÜ</div>
                            <div style="color: var(--accent-green); font-weight: 700; font-size: 1.2rem; margin-bottom: 0.5rem;">
                                WINNER FOUND!
                            </div>
                            <div style="color: var(--text-light); margin-bottom: 1rem;">
                                <strong>${winner}</strong> solved the puzzle after <strong style="color: var(--primary-orange);">${attempts}</strong> attempts!
                            </div>
                            <div style="background: rgba(0,0,0,0.3); padding: 1rem; border-radius: 0.5rem; font-family: monospace; font-size: 0.85rem;">
                                <strong style="color: var(--accent-blue);">Solution:</strong> <code style="color: var(--accent-green);">${attempts}</code><br>
                                <strong style="color: var(--accent-blue);">Unique Mark:</strong> <code style="color: var(--accent-green);">000${Math.random().toString(36).substring(2, 10)}</code>
                            </div>
                            <div style="margin-top: 1rem; padding: 1rem; background: rgba(33, 150, 243, 0.1); border-radius: 0.5rem; color: var(--text-light); font-size: 0.9rem;">
                                ‚ú® ${winner} gets to add the next page to the ledger and earns the reward!<br>
                                The work ${winner} put in proves no cheating occurred.
                            </div>
                        </div>
                    `;
                    log.scrollTop = log.scrollHeight;
                }
            }, 30);
        }

        function stopCompetition() {
            competitionRunning = false;
            if (competitionInterval) {
                clearInterval(competitionInterval);
                competitionInterval = null;
            }

            const output = document.getElementById('competition-output');
            const log = document.getElementById('competition-log');

            if (log) {
                log.innerHTML += `
                    <div style="color: #ff4444; font-weight: 600; margin-top: 1rem; padding: 1rem; background: rgba(255, 68, 68, 0.1); border-radius: 0.5rem; text-align: center;">
                        ‚èπÔ∏è Competition Stopped<br>
                        <span style="font-size: 0.85rem; font-weight: normal;">Total attempts: ${attempts}</span>
                    </div>
                `;
                log.scrollTop = log.scrollHeight;
            }
        }

        // Module Completion
        function completeModule() {
            const progress = JSON.parse(localStorage.getItem('learningProgress') || '{}');

            if (!progress.completedModules) {
                progress.completedModules = [];
            }

            if (!progress.completedModules.includes('curious-1-4')) {
                progress.completedModules.push('curious-1-4');
            }

            // Mark Stage 1 as complete
            if (!progress.completedStages) {
                progress.completedStages = [];
            }
            if (!progress.completedStages.includes('curious-1')) {
                progress.completedStages.push('curious-1');
            }

            // Award badge
            if (!progress.badges) {
                progress.badges = [];
            }
            if (!progress.badges.includes('understanding-money')) {
                progress.badges.push('understanding-money');
            }

            progress.lastActivity = new Date().toISOString();
            progress.path = 'curious';
            progress.currentStage = 2;
            progress.currentModule = 1;

            localStorage.setItem('learningProgress', JSON.stringify(progress));

            document.getElementById('completion-message').innerHTML = '‚úÖ Module Complete! Stage 1 finished. Stage 2 unlocked!';
            document.getElementById('complete-btn').disabled = true;
            document.getElementById('complete-btn').style.opacity = '0.5';

            // Scroll to show message
            document.getElementById('completion-message').scrollIntoView({ behavior: 'smooth', block: 'center' });
        }

        // Check if already completed
        function checkCompletion() {
            const progress = JSON.parse(localStorage.getItem('learningProgress') || '{}');
            const completedModules = progress.completedModules || [];

            if (completedModules.includes('curious-1-4')) {
                document.getElementById('completion-message').innerHTML = '‚úì You already completed this module!';
                document.getElementById('complete-btn').textContent = '‚úì Already Complete';
                document.getElementById('complete-btn').disabled = true;
                document.getElementById('complete-btn').style.opacity = '0.5';
            }
        }

        // Run on load
        checkCompletion();
    </script>
</body>
</html>
